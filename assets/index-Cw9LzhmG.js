const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/xl-formula-wrapper-nHyDW7a7.js","assets/vendor-CCnpLwun.js","assets/formula-DkIGol2c.js"])))=>i.map(i=>d[i]);
import{l as $,C as ne,s as j,_ as ae,E as M,d as A,y as _,k as H,$ as oe,D as ie,G as se}from"./vendor-CCnpLwun.js";import{P as J}from"./formula-DkIGol2c.js";(function(){const d=document.createElement("link").relList;if(d&&d.supports&&d.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))b(l);new MutationObserver(l=>{for(const f of l)if(f.type==="childList")for(const o of f.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&b(o)}).observe(document,{childList:!0,subtree:!0});function n(l){const f={};return l.integrity&&(f.integrity=l.integrity),l.referrerPolicy&&(f.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?f.credentials="include":l.crossOrigin==="anonymous"?f.credentials="omit":f.credentials="same-origin",f}function b(l){if(l.ep)return;l.ep=!0;const f=n(l);fetch(l.href,f)}})();var le=0;function e(t,d,n,b,l,f){d||(d={});var o,s,h=d;if("ref"in h)for(s in h={},d)s=="ref"?o=d[s]:h[s]=d[s];var m={type:t,props:h,key:n,ref:o,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--le,__i:-1,__u:0,__source:l,__self:f};if(typeof t=="function"&&(o=t.defaultProps))for(s in o)h[s]===void 0&&(h[s]=o[s]);return $.vnode&&$.vnode(m),m}var ce=["className","activeClass","activeClassName","path"];function V(t){var d=t.className,n=t.activeClass,b=t.activeClassName,l=t.path,f=function(p,v){if(p==null)return{};var a,c,E={},y=Object.keys(p);for(c=0;c<y.length;c++)v.indexOf(a=y[c])>=0||(E[a]=p[a]);return E}(t,ce),o=ne()[0],s=l&&o.path&&j(o.path,l,{})||j(o.url,f.href,{}),h=f.class||d||"",m=s&&(n||b)||"";return f.class=h+(h&&m&&" ")+m,ae(M,f)}function me(){const t="/xl-formula/";return e("header",{style:{borderBottom:"1px solid var(--color-border)",background:"var(--color-bg)",position:"sticky",top:0,zIndex:50},children:e("div",{className:"container",children:e("nav",{className:"flex items-center justify-between",style:{height:"4rem"},children:[e("div",{className:"flex items-center",children:[e(V,{href:t,className:"text-xl font-bold",style:{textDecoration:"none",color:"var(--color-primary)"},children:"XL Formula"}),e("div",{className:"flex items-center",children:[e(V,{href:`${t}playground`,className:"text-sm font-medium nav-link",style:{textDecoration:"none",color:"var(--color-text-secondary)",padding:"8px 16px",borderRadius:"6px",transition:"all 0.2s ease"},activeClassName:"text-primary",onMouseOver:d=>d.target.style.backgroundColor="var(--color-bg-secondary)",onMouseOut:d=>d.target.style.backgroundColor="transparent",children:"Playground"}),e(V,{href:`${t}docs`,className:"text-sm font-medium nav-link",style:{textDecoration:"none",color:"var(--color-text-secondary)",padding:"8px 16px",borderRadius:"6px",transition:"all 0.2s ease"},activeClassName:"text-primary",onMouseOver:d=>d.target.style.backgroundColor="var(--color-bg-secondary)",onMouseOut:d=>d.target.style.backgroundColor="transparent",children:"Documentation"})]})]}),e("div",{className:"flex items-center gap-4",children:[e("a",{href:"https://github.com/rpenfold/xl-formula",target:"_blank",rel:"noopener noreferrer",className:"btn btn-sm",children:"GitHub"}),e("a",{href:"https://www.npmjs.com/package/xl-formula-web",target:"_blank",rel:"noopener noreferrer",className:"btn btn-sm btn-primary",children:"npm install"})]})]})})})}const G="/xl-formula/";function Y(){return e("div",{children:[e("section",{style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",padding:"6rem 0"},children:e("div",{className:"container",style:{textAlign:"center"},children:[e("h1",{className:"text-3xl font-bold mb-4",style:{fontSize:"3rem",marginBottom:"1.5rem"},children:"XL Formula"}),e("p",{className:"text-xl mb-8",style:{fontSize:"1.25rem",marginBottom:"2rem",opacity:.9},children:"High-performance Excel-like formula parser and evaluator for web applications"}),e("div",{className:"flex gap-4",style:{justifyContent:"center"},children:[e(M,{href:`${G}playground`,className:"btn btn-primary",style:{background:"white",color:"#4f46e5",padding:"1rem 2rem",fontSize:"1rem",textDecoration:"none"},children:"Try Playground"}),e(M,{href:`${G}docs`,className:"btn",style:{background:"rgba(255,255,255,0.1)",border:"1px solid rgba(255,255,255,0.3)",color:"white",padding:"1rem 2rem",fontSize:"1rem",textDecoration:"none"},children:"Documentation"})]})]})}),e("section",{style:{padding:"4rem 0"},children:e("div",{className:"container",children:[e("h2",{className:"text-2xl font-bold mb-8",style:{textAlign:"center"},children:"Why XL Formula?"}),e("div",{className:"grid grid-cols-3 gap-8",children:[e("div",{className:"card",style:{textAlign:"center"},children:[e("div",{style:{width:"3rem",height:"3rem",background:"var(--color-primary-light)",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 1rem"},children:"‚ö°"}),e("h3",{className:"font-semibold mb-2",children:"Lightning Fast"}),e("p",{className:"text-muted",children:"Compiled to WebAssembly for near-native performance in the browser"})]}),e("div",{className:"card",style:{textAlign:"center"},children:[e("div",{style:{width:"3rem",height:"3rem",background:"var(--color-primary-light)",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 1rem"},children:"üìä"}),e("h3",{className:"font-semibold mb-2",children:"Excel Compatible"}),e("p",{className:"text-muted",children:"Supports 100+ Excel functions with familiar syntax and behavior"})]}),e("div",{className:"card",style:{textAlign:"center"},children:[e("div",{style:{width:"3rem",height:"3rem",background:"var(--color-primary-light)",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 1rem"},children:"üîß"}),e("h3",{className:"font-semibold mb-2",children:"Easy Integration"}),e("p",{className:"text-muted",children:"Simple JavaScript API with TypeScript support and zero dependencies"})]})]})]})}),e("section",{style:{padding:"4rem 0",background:"var(--color-bg-secondary)"},children:e("div",{className:"container",children:[e("h2",{className:"text-2xl font-bold mb-8",style:{textAlign:"center"},children:"Quick Start"}),e("div",{className:"grid grid-cols-2 gap-8",children:[e("div",{children:[e("h3",{className:"font-semibold mb-4",children:"Installation"}),e("pre",{className:"p-4 rounded",style:{background:"var(--color-bg)",border:"1px solid var(--color-border)",fontFamily:"var(--font-mono)",fontSize:"0.875rem"},children:e("code",{children:"npm install xl-formula-web"})})]}),e("div",{children:[e("h3",{className:"font-semibold mb-4",children:"Basic Usage"}),e("pre",{className:"p-4 rounded",style:{background:"var(--color-bg)",border:"1px solid var(--color-border)",fontFamily:"var(--font-mono)",fontSize:"0.875rem"},children:e("code",{children:`import XLFormula from 'xl-formula-web'

await XLFormula.init()
const result = XLFormula.evaluate('SUM(1,2,3)')
if (result.isSuccess()) {
  console.log(result.getValue().asNumber()) // 6
}`})})]})]})]})})]})}const B={all:{name:"All Functions",description:"All available functions across all categories",functions:{}},math:{name:"Math",description:"Mathematical and statistical functions",functions:{SUM:{name:"SUM",description:"Adds all the numbers in a range of cells",syntax:"SUM(number1, [number2], ...)",parameters:[{name:"number1",description:"The first number to add",required:!0},{name:"number2",description:"Additional numbers to add",required:!1}],examples:[{formula:"SUM(1, 2, 3)",result:"6",description:"Simple addition"},{formula:"SUM(A1, B1, C1)",result:"15",description:"Sum of cells (A1=5, B1=4, C1=6)"}]},MAX:{name:"MAX",description:"Returns the largest value among the arguments",syntax:"MAX(number1, [number2], ...)",parameters:[{name:"number1",description:"The first number to compare",required:!0},{name:"number2",description:"Additional numbers to compare",required:!1}],examples:[{formula:"MAX(10, 20, 5)",result:"20",description:"Maximum of three numbers"},{formula:"MAX(A1:A5)",result:"25",description:"Maximum in range A1:A5"}]},MIN:{name:"MIN",description:"Returns the smallest value among the arguments",syntax:"MIN(number1, [number2], ...)",parameters:[{name:"number1",description:"The first number to compare",required:!0},{name:"number2",description:"Additional numbers to compare",required:!1}],examples:[{formula:"MIN(10, 20, 5)",result:"5",description:"Minimum of three numbers"},{formula:"MIN(A1:A5)",result:"2",description:"Minimum in range A1:A5"}]},AVERAGE:{name:"AVERAGE",description:"Returns the average (arithmetic mean) of the arguments",syntax:"AVERAGE(number1, [number2], ...)",parameters:[{name:"number1",description:"The first number to average",required:!0},{name:"number2",description:"Additional numbers to average",required:!1}],examples:[{formula:"AVERAGE(1, 2, 3, 4, 5)",result:"3",description:"Average of five numbers"},{formula:"AVERAGE(A1:A10)",result:"7.5",description:"Average of range A1:A10"}]},ROUND:{name:"ROUND",description:"Rounds a number to a specified number of digits",syntax:"ROUND(number, num_digits)",parameters:[{name:"number",description:"The number to round",required:!0},{name:"num_digits",description:"The number of digits to round to",required:!0}],examples:[{formula:"ROUND(3.14159, 2)",result:"3.14",description:"Round to 2 decimal places"},{formula:"ROUND(1234.5, -2)",result:"1200",description:"Round to nearest hundred"}]},ABS:{name:"ABS",description:"Returns the absolute value of a number",syntax:"ABS(number)",parameters:[{name:"number",description:"The number to get absolute value of",required:!0}],examples:[{formula:"ABS(-5)",result:"5",description:"Absolute value of negative number"},{formula:"ABS(3.14)",result:"3.14",description:"Absolute value of positive number"}]},SQRT:{name:"SQRT",description:"Returns the square root of a number",syntax:"SQRT(number)",parameters:[{name:"number",description:"The number to get square root of",required:!0}],examples:[{formula:"SQRT(16)",result:"4",description:"Square root of 16"},{formula:"SQRT(2)",result:"1.414",description:"Square root of 2"}]},POWER:{name:"POWER",description:"Returns a number raised to a power",syntax:"POWER(number, power)",parameters:[{name:"number",description:"The base number",required:!0},{name:"power",description:"The exponent",required:!0}],examples:[{formula:"POWER(2, 3)",result:"8",description:"2 to the power of 3"},{formula:"POWER(9, 0.5)",result:"3",description:"Square root using power"}]},PI:{name:"PI",description:"Returns the value of pi (œÄ)",syntax:"PI()",parameters:[],examples:[{formula:"PI()",result:"3.14159",description:"Value of pi"},{formula:"PI() * 2",result:"6.28318",description:"Two times pi"}]},SIN:{name:"SIN",description:"Returns the sine of an angle (in radians)",syntax:"SIN(angle)",parameters:[{name:"angle",description:"The angle in radians",required:!0}],examples:[{formula:"SIN(PI()/2)",result:"1",description:"Sine of 90 degrees (œÄ/2 radians)"},{formula:"SIN(0)",result:"0",description:"Sine of 0 radians"}]},COS:{name:"COS",description:"Returns the cosine of an angle (in radians)",syntax:"COS(angle)",parameters:[{name:"angle",description:"The angle in radians",required:!0}],examples:[{formula:"COS(0)",result:"1",description:"Cosine of 0 radians"},{formula:"COS(PI())",result:"-1",description:"Cosine of œÄ radians"}]},TAN:{name:"TAN",description:"Returns the tangent of an angle (in radians)",syntax:"TAN(angle)",parameters:[{name:"angle",description:"The angle in radians",required:!0}],examples:[{formula:"TAN(PI()/4)",result:"1",description:"Tangent of 45 degrees (œÄ/4 radians)"},{formula:"TAN(0)",result:"0",description:"Tangent of 0 radians"}]},LN:{name:"LN",description:"Returns the natural logarithm of a number",syntax:"LN(number)",parameters:[{name:"number",description:"The number to get natural log of",required:!0}],examples:[{formula:"LN(EXP(1))",result:"1",description:"Natural log of e"},{formula:"LN(10)",result:"2.303",description:"Natural log of 10"}]},LOG:{name:"LOG",description:"Returns the logarithm of a number to a specified base",syntax:"LOG(number, [base])",parameters:[{name:"number",description:"The number to get logarithm of",required:!0},{name:"base",description:"The base (default: 10)",required:!1}],examples:[{formula:"LOG(100)",result:"2",description:"Base 10 log of 100"},{formula:"LOG(8, 2)",result:"3",description:"Base 2 log of 8"}]},EXP:{name:"EXP",description:"Returns e raised to the power of a number",syntax:"EXP(number)",parameters:[{name:"number",description:"The exponent",required:!0}],examples:[{formula:"EXP(1)",result:"2.718",description:"e to the power of 1"},{formula:"EXP(0)",result:"1",description:"e to the power of 0"}]},FACT:{name:"FACT",description:"Returns the factorial of a number",syntax:"FACT(number)",parameters:[{name:"number",description:"The number to get factorial of",required:!0}],examples:[{formula:"FACT(5)",result:"120",description:"Factorial of 5 (5! = 5√ó4√ó3√ó2√ó1)"},{formula:"FACT(0)",result:"1",description:"Factorial of 0"}]},CEILING:{name:"CEILING",description:"Rounds a number up to the nearest multiple of significance",syntax:"CEILING(number, [significance])",parameters:[{name:"number",description:"The number to round up",required:!0},{name:"significance",description:"The multiple to round up to",required:!1}],examples:[{formula:"CEILING(4.3)",result:"5",description:"Round up to nearest integer"},{formula:"CEILING(4.3, 0.5)",result:"4.5",description:"Round up to nearest 0.5"}]},FLOOR:{name:"FLOOR",description:"Rounds a number down to the nearest multiple of significance",syntax:"FLOOR(number, [significance])",parameters:[{name:"number",description:"The number to round down",required:!0},{name:"significance",description:"The multiple to round down to",required:!1}],examples:[{formula:"FLOOR(4.7)",result:"4",description:"Round down to nearest integer"},{formula:"FLOOR(4.7, 0.5)",result:"4.5",description:"Round down to nearest 0.5"}]},MOD:{name:"MOD",description:"Returns the remainder after division",syntax:"MOD(number, divisor)",parameters:[{name:"number",description:"The number to divide",required:!0},{name:"divisor",description:"The divisor",required:!0}],examples:[{formula:"MOD(10, 3)",result:"1",description:"Remainder of 10 divided by 3"},{formula:"MOD(15, 4)",result:"3",description:"Remainder of 15 divided by 4"}]},GCD:{name:"GCD",description:"Returns the greatest common divisor of two or more numbers",syntax:"GCD(number1, [number2], ...)",parameters:[{name:"number1",description:"First number",required:!0},{name:"number2",description:"Additional numbers",required:!1}],examples:[{formula:"GCD(12, 18)",result:"6",description:"GCD of 12 and 18"},{formula:"GCD(24, 36, 48)",result:"12",description:"GCD of multiple numbers"}]},LCM:{name:"LCM",description:"Returns the least common multiple of two or more numbers",syntax:"LCM(number1, [number2], ...)",parameters:[{name:"number1",description:"First number",required:!0},{name:"number2",description:"Additional numbers",required:!1}],examples:[{formula:"LCM(4, 6)",result:"12",description:"LCM of 4 and 6"},{formula:"LCM(3, 4, 5)",result:"60",description:"LCM of multiple numbers"}]},COUNT:{name:"COUNT",description:"Counts the number of numeric values in a range",syntax:"COUNT(value1, [value2], ...)",parameters:[{name:"value1",description:"First value or range to count",required:!0},{name:"value2",description:"Additional values to count",required:!1}],examples:[{formula:'COUNT(1, 2, 3, "text")',result:"3",description:"Count numeric values only"},{formula:"COUNT(A1:A10)",result:"8",description:"Count numbers in range"}]},MEDIAN:{name:"MEDIAN",description:"Returns the median (middle value) of a set of numbers",syntax:"MEDIAN(number1, [number2], ...)",parameters:[{name:"number1",description:"First number or range",required:!0},{name:"number2",description:"Additional numbers",required:!1}],examples:[{formula:"MEDIAN(1, 2, 3, 4, 5)",result:"3",description:"Median of odd count"},{formula:"MEDIAN(1, 2, 3, 4)",result:"2.5",description:"Median of even count"}]},MODE:{name:"MODE",description:"Returns the most frequently occurring value in a set",syntax:"MODE(number1, [number2], ...)",parameters:[{name:"number1",description:"First number or range",required:!0},{name:"number2",description:"Additional numbers",required:!1}],examples:[{formula:"MODE(1, 2, 2, 3, 4)",result:"2",description:"Most frequent value"},{formula:"MODE(A1:A10)",result:"5",description:"Mode of range"}]},STDEV:{name:"STDEV",description:"Returns the standard deviation of a sample",syntax:"STDEV(number1, [number2], ...)",parameters:[{name:"number1",description:"First number or range",required:!0},{name:"number2",description:"Additional numbers",required:!1}],examples:[{formula:"STDEV(1, 2, 3, 4, 5)",result:"1.58",description:"Standard deviation of sample"},{formula:"STDEV(A1:A10)",result:"2.87",description:"Standard deviation of range"}]},VAR:{name:"VAR",description:"Returns the variance of a sample",syntax:"VAR(number1, [number2], ...)",parameters:[{name:"number1",description:"First number or range",required:!0},{name:"number2",description:"Additional numbers",required:!1}],examples:[{formula:"VAR(1, 2, 3, 4, 5)",result:"2.5",description:"Variance of sample"},{formula:"VAR(A1:A10)",result:"8.22",description:"Variance of range"}]},RAND:{name:"RAND",description:"Returns a random number between 0 and 1",syntax:"RAND()",parameters:[],examples:[{formula:"RAND()",result:"0.7234",description:"Random decimal between 0 and 1"},{formula:"RAND() * 100",result:"72.34",description:"Random number between 0 and 100"}]},RANDBETWEEN:{name:"RANDBETWEEN",description:"Returns a random integer between two specified numbers",syntax:"RANDBETWEEN(bottom, top)",parameters:[{name:"bottom",description:"The lowest integer to return",required:!0},{name:"top",description:"The highest integer to return",required:!0}],examples:[{formula:"RANDBETWEEN(1, 10)",result:"7",description:"Random integer between 1 and 10"},{formula:"RANDBETWEEN(-5, 5)",result:"-2",description:"Random integer between -5 and 5"}]}}},text:{name:"Text",description:"Text manipulation and formatting functions",functions:{CONCATENATE:{name:"CONCATENATE",description:"Joins two or more text strings into one string",syntax:"CONCATENATE(text1, [text2], ...)",parameters:[{name:"text1",description:"The first text string",required:!0},{name:"text2",description:"Additional text strings",required:!1}],examples:[{formula:'CONCATENATE("Hello", " ", "World")',result:'"Hello World"',description:"Join three strings"},{formula:'CONCATENATE(A1, " - ", B1)',result:'"Name - Value"',description:"Join cell values with separator"}]},LEN:{name:"LEN",description:"Returns the number of characters in a text string",syntax:"LEN(text)",parameters:[{name:"text",description:"The text string to measure",required:!0}],examples:[{formula:'LEN("Hello")',result:"5",description:"Length of text string"},{formula:"LEN(A1)",result:"12",description:"Length of text in cell A1"}]},UPPER:{name:"UPPER",description:"Converts text to uppercase",syntax:"UPPER(text)",parameters:[{name:"text",description:"The text to convert to uppercase",required:!0}],examples:[{formula:'UPPER("hello world")',result:'"HELLO WORLD"',description:"Convert to uppercase"},{formula:"UPPER(A1)",result:'"EXCEL FORMULA"',description:"Convert cell value to uppercase"}]},LOWER:{name:"LOWER",description:"Converts text to lowercase",syntax:"LOWER(text)",parameters:[{name:"text",description:"The text to convert to lowercase",required:!0}],examples:[{formula:'LOWER("HELLO WORLD")',result:'"hello world"',description:"Convert to lowercase"},{formula:"LOWER(A1)",result:'"excel formula"',description:"Convert cell value to lowercase"}]}}},logical:{name:"Logical",description:"Logical and conditional functions",functions:{IF:{name:"IF",description:"Returns one value if condition is TRUE, another if FALSE",syntax:"IF(logical_test, value_if_true, value_if_false)",parameters:[{name:"logical_test",description:"The condition to test",required:!0},{name:"value_if_true",description:"Value to return if condition is TRUE",required:!0},{name:"value_if_false",description:"Value to return if condition is FALSE",required:!0}],examples:[{formula:'IF(5 > 3, "Yes", "No")',result:'"Yes"',description:"Simple condition test"},{formula:'IF(A1 > 100, "High", "Low")',result:'"High"',description:"Compare cell value"}]},AND:{name:"AND",description:"Returns TRUE if all arguments are TRUE",syntax:"AND(logical1, [logical2], ...)",parameters:[{name:"logical1",description:"The first logical value",required:!0},{name:"logical2",description:"Additional logical values",required:!1}],examples:[{formula:"AND(5 > 3, 10 < 20)",result:"TRUE",description:"Both conditions are true"},{formula:"AND(A1 > 0, B1 < 100)",result:"FALSE",description:"At least one condition is false"}]},OR:{name:"OR",description:"Returns TRUE if any argument is TRUE",syntax:"OR(logical1, [logical2], ...)",parameters:[{name:"logical1",description:"The first logical value",required:!0},{name:"logical2",description:"Additional logical values",required:!1}],examples:[{formula:"OR(5 > 10, 3 < 5)",result:"TRUE",description:"One condition is true"},{formula:"OR(A1 < 0, B1 > 100)",result:"FALSE",description:"Both conditions are false"}]},SWITCH:{name:"SWITCH",description:"Compares an expression against multiple values and returns corresponding result",syntax:"SWITCH(expression, value1, result1, [value2, result2, ...], [default])",parameters:[{name:"expression",description:"The value to compare against",required:!0},{name:"value1",description:"First value to compare with expression",required:!0},{name:"result1",description:"Result to return if value1 matches",required:!0},{name:"value2",description:"Additional values to compare (optional)",required:!1},{name:"result2",description:"Additional results (optional)",required:!1},{name:"default",description:"Default value if no match found (optional)",required:!1}],examples:[{formula:'SWITCH(2, 1, "One", 2, "Two", 3, "Three")',result:'"Two"',description:"Match found for value 2"},{formula:'SWITCH(4, 1, "One", 2, "Two", "Default")',result:'"Default"',description:"No match, return default"}]},IFS:{name:"IFS",description:"Checks multiple conditions and returns result for first TRUE condition",syntax:"IFS(condition1, result1, [condition2, result2, ...])",parameters:[{name:"condition1",description:"First logical condition to test",required:!0},{name:"result1",description:"Result to return if condition1 is TRUE",required:!0},{name:"condition2",description:"Additional conditions to test (optional)",required:!1},{name:"result2",description:"Additional results (optional)",required:!1}],examples:[{formula:'IFS(FALSE, "First", TRUE, "Second")',result:'"Second"',description:"First TRUE condition wins"},{formula:'IFS(0, "Zero", 1, "One")',result:'"One"',description:"Number conditions: 0=FALSE, 1=TRUE"}]}}},text:{name:"Text",description:"Text manipulation and formatting functions",functions:{CONCATENATE:{name:"CONCATENATE",description:"Joins several text strings into one text string",syntax:"CONCATENATE(text1, [text2], ...)",parameters:[{name:"text1",description:"The first text string to join",required:!0},{name:"text2",description:"Additional text strings to join",required:!1}],examples:[{formula:'CONCATENATE("Hello", " ", "World")',result:'"Hello World"',description:"Join text strings"},{formula:'CONCATENATE(A1, " - ", B1)',result:'"John - Doe"',description:"Join cells with separator"}]},LEFT:{name:"LEFT",description:"Returns the leftmost characters from a text string",syntax:"LEFT(text, [num_chars])",parameters:[{name:"text",description:"The text string from which to extract characters",required:!0},{name:"num_chars",description:"Number of characters to extract (default: 1)",required:!1}],examples:[{formula:'LEFT("Hello", 2)',result:'"He"',description:"Get first 2 characters"},{formula:"LEFT(A1)",result:'"H"',description:"Get first character"}]},RIGHT:{name:"RIGHT",description:"Returns the rightmost characters from a text string",syntax:"RIGHT(text, [num_chars])",parameters:[{name:"text",description:"The text string from which to extract characters",required:!0},{name:"num_chars",description:"Number of characters to extract (default: 1)",required:!1}],examples:[{formula:'RIGHT("Hello", 2)',result:'"lo"',description:"Get last 2 characters"},{formula:"RIGHT(A1)",result:'"o"',description:"Get last character"}]},MID:{name:"MID",description:"Returns characters from the middle of a text string",syntax:"MID(text, start_num, num_chars)",parameters:[{name:"text",description:"The text string from which to extract characters",required:!0},{name:"start_num",description:"Position of the first character to extract",required:!0},{name:"num_chars",description:"Number of characters to extract",required:!0}],examples:[{formula:'MID("Hello World", 7, 5)',result:'"World"',description:"Extract characters from position 7"},{formula:"MID(A1, 2, 3)",result:'"ell"',description:"Extract 3 chars starting at position 2"}]},LEN:{name:"LEN",description:"Returns the number of characters in a text string",syntax:"LEN(text)",parameters:[{name:"text",description:"The text string to measure",required:!0}],examples:[{formula:'LEN("Hello")',result:"5",description:"Length of text string"},{formula:"LEN(A1)",result:"10",description:"Length of cell content"}]},UPPER:{name:"UPPER",description:"Converts text to uppercase",syntax:"UPPER(text)",parameters:[{name:"text",description:"The text to convert to uppercase",required:!0}],examples:[{formula:'UPPER("hello")',result:'"HELLO"',description:"Convert to uppercase"},{formula:"UPPER(A1)",result:'"WORLD"',description:"Convert cell content to uppercase"}]},LOWER:{name:"LOWER",description:"Converts text to lowercase",syntax:"LOWER(text)",parameters:[{name:"text",description:"The text to convert to lowercase",required:!0}],examples:[{formula:'LOWER("HELLO")',result:'"hello"',description:"Convert to lowercase"},{formula:"LOWER(A1)",result:'"world"',description:"Convert cell content to lowercase"}]},RPT:{name:"RPT",description:"Repeats text a specified number of times",syntax:"RPT(text, repeat_count)",parameters:[{name:"text",description:"The text string to repeat",required:!0},{name:"repeat_count",description:"The number of times to repeat the text",required:!0}],examples:[{formula:'RPT("abc", 3)',result:'"abcabcabc"',description:"Repeat text three times"},{formula:'RPT("x", 5)',result:'"xxxxx"',description:"Repeat single character five times"}]},PROPER:{name:"PROPER",description:"Capitalizes the first letter of each word in text",syntax:"PROPER(text)",parameters:[{name:"text",description:"The text to convert to proper case",required:!0}],examples:[{formula:'PROPER("hello world")',result:'"Hello World"',description:"Convert to proper case"},{formula:"PROPER(A1)",result:'"John Doe"',description:"Convert cell content to proper case"}]},TRIM:{name:"TRIM",description:"Removes extra spaces from text",syntax:"TRIM(text)",parameters:[{name:"text",description:"The text from which to remove spaces",required:!0}],examples:[{formula:'TRIM("  Hello  World  ")',result:'"Hello World"',description:"Remove extra spaces"},{formula:"TRIM(A1)",result:'"Clean Text"',description:"Clean up cell content"}]},FIND:{name:"FIND",description:"Finds one text string within another (case-sensitive)",syntax:"FIND(find_text, within_text, [start_num])",parameters:[{name:"find_text",description:"The text to find",required:!0},{name:"within_text",description:"The text in which to search",required:!0},{name:"start_num",description:"Position to start searching from",required:!1}],examples:[{formula:'FIND("lo", "Hello")',result:"4",description:'Find position of "lo" in "Hello"'},{formula:'FIND("o", "Hello", 5)',result:"5",description:'Find "o" starting from position 5'}]},SEARCH:{name:"SEARCH",description:"Finds one text string within another (case-insensitive)",syntax:"SEARCH(find_text, within_text, [start_num])",parameters:[{name:"find_text",description:"The text to find",required:!0},{name:"within_text",description:"The text in which to search",required:!0},{name:"start_num",description:"Position to start searching from",required:!1}],examples:[{formula:'SEARCH("LO", "Hello")',result:"4",description:'Case-insensitive search for "LO"'},{formula:'SEARCH("world", "Hello World")',result:"7",description:"Find position case-insensitively"}]},REPLACE:{name:"REPLACE",description:"Replaces characters within text based on position",syntax:"REPLACE(old_text, start_num, num_chars, new_text)",parameters:[{name:"old_text",description:"The original text",required:!0},{name:"start_num",description:"Position to start replacing",required:!0},{name:"num_chars",description:"Number of characters to replace",required:!0},{name:"new_text",description:"The replacement text",required:!0}],examples:[{formula:'REPLACE("Hello", 2, 2, "i")',result:'"Hilo"',description:'Replace "el" with "i"'},{formula:'REPLACE(A1, 1, 3, "New")',result:'"NewValue"',description:"Replace first 3 characters"}]},SUBSTITUTE:{name:"SUBSTITUTE",description:"Substitutes new text for old text in a string",syntax:"SUBSTITUTE(text, old_text, new_text, [instance_num])",parameters:[{name:"text",description:"The original text",required:!0},{name:"old_text",description:"The text to replace",required:!0},{name:"new_text",description:"The replacement text",required:!0},{name:"instance_num",description:"Which instance to replace (optional)",required:!1}],examples:[{formula:'SUBSTITUTE("Hello Hello", "Hello", "Hi")',result:'"Hi Hi"',description:"Replace all instances"},{formula:'SUBSTITUTE("a,b,c", ",", ";")',result:'"a;b;c"',description:"Replace commas with semicolons"}]},TEXT:{name:"TEXT",description:"Formats a number as text according to a specified format",syntax:"TEXT(value, format_text)",parameters:[{name:"value",description:"The number to format",required:!0},{name:"format_text",description:"The format to apply",required:!0}],examples:[{formula:'TEXT(123.45, "0.00")',result:'"123.45"',description:"Format with 2 decimal places"},{formula:'TEXT(0.75, "0%")',result:'"75%"',description:"Format as percentage"}]},CHAR:{name:"CHAR",description:"Returns the character specified by a code number (1-255)",syntax:"CHAR(number)",parameters:[{name:"number",description:"Code number between 1 and 255",required:!0}],examples:[{formula:"CHAR(65)",result:'"A"',description:"Character for code 65"},{formula:"CHAR(10)",result:`"
"`,description:"Line feed character"}]},CODE:{name:"CODE",description:"Returns a numeric code for the first character in a text string",syntax:"CODE(text)",parameters:[{name:"text",description:"The text to examine",required:!0}],examples:[{formula:'CODE("A")',result:"65",description:"Code for letter A"},{formula:'CODE("!Hello")',result:"33",description:"Code for first character !"}]},CLEAN:{name:"CLEAN",description:"Removes all nonprintable characters from text (ASCII codes < 32)",syntax:"CLEAN(text)",parameters:[{name:"text",description:"The text from which to remove nonprintable characters",required:!0}],examples:[{formula:`CLEAN("Hello
World")`,result:'"HelloWorld"',description:"Removes line feed"},{formula:'CLEAN(CHAR(9) & "Tab")',result:'"Tab"',description:"Removes tab"}]},EXACT:{name:"EXACT",description:"Checks whether two text strings are exactly the same (case-sensitive)",syntax:"EXACT(text1, text2)",parameters:[{name:"text1",description:"First text string",required:!0},{name:"text2",description:"Second text string",required:!0}],examples:[{formula:'EXACT("Hello", "Hello")',result:"TRUE",description:"Strings match exactly"},{formula:'EXACT("Hello", "hello")',result:"FALSE",description:"Case-sensitive comparison"}]},VALUE:{name:"VALUE",description:"Converts text that represents a number to a number",syntax:"VALUE(text)",parameters:[{name:"text",description:"The text to convert to a number",required:!0}],examples:[{formula:'VALUE("123")',result:"123",description:"Convert text to number"},{formula:'VALUE("$1,000.00")',result:"1000",description:"Convert formatted text to number"}]},CONCAT:{name:"CONCAT",description:"Joins text strings (alias for CONCATENATE)",syntax:"CONCAT(text1, [text2], ...)",parameters:[{name:"text1",description:"The first text string",required:!0},{name:"text2",description:"Additional text strings",required:!1}],examples:[{formula:'CONCAT("Hello", " ", "World")',result:'"Hello World"',description:"Join three strings"},{formula:"CONCAT(A1, B1)",result:'"JohnDoe"',description:"Join cell values directly"}]},T:{name:"T",description:"Returns text if the argument is text, otherwise returns empty string",syntax:"T(value)",parameters:[{name:"value",description:"The value to test",required:!0}],examples:[{formula:'T("Hello")',result:'"Hello"',description:"Text input returns text"},{formula:"T(123)",result:'""',description:"Number input returns empty string"}]},TEXTJOIN:{name:"TEXTJOIN",description:"Joins text values with a delimiter",syntax:"TEXTJOIN(delimiter, ignore_empty, text1, [text2], ...)",parameters:[{name:"delimiter",description:"Text to use as separator",required:!0},{name:"ignore_empty",description:"TRUE to ignore empty values, FALSE to include them",required:!0},{name:"text1",description:"First text value to join",required:!0},{name:"text2",description:"Additional text values to join",required:!1}],examples:[{formula:'TEXTJOIN(",", TRUE, "A", "", "B", "C")',result:'"A,B,C"',description:"Join with comma, ignore empty"},{formula:'TEXTJOIN(" ", FALSE, "Hello", "", "World")',result:'"Hello  World"',description:"Join with space, include empty"}]},UNICHAR:{name:"UNICHAR",description:"Returns the Unicode character for a given code point",syntax:"UNICHAR(number)",parameters:[{name:"number",description:"Unicode code point (1 to 1114111)",required:!0}],examples:[{formula:"UNICHAR(65)",result:'"A"',description:'ASCII code 65 is "A"'},{formula:"UNICHAR(128512)",result:'"üòÄ"',description:"Unicode emoji character"}]},UNICODE:{name:"UNICODE",description:"Returns the Unicode code point of the first character in text",syntax:"UNICODE(text)",parameters:[{name:"text",description:"The text containing the character",required:!0}],examples:[{formula:'UNICODE("A")',result:"65",description:'Unicode code for "A"'},{formula:'UNICODE("üòÄ")',result:"128512",description:"Unicode code for emoji"}]}}},financial:{name:"Financial",description:"Financial calculation functions",functions:{FV:{name:"FV",description:"Returns the future value of an investment",syntax:"FV(rate, nper, pmt, [pv], [type])",parameters:[{name:"rate",description:"Interest rate per period",required:!0},{name:"nper",description:"Number of payment periods",required:!0},{name:"pmt",description:"Payment made each period",required:!0},{name:"pv",description:"Present value (default: 0)",required:!1},{name:"type",description:"Payment timing (0=end, 1=beginning)",required:!1}],examples:[{formula:"FV(0.05, 10, -100, 0, 0)",result:"1257.79",description:"Future value of annuity"},{formula:"FV(0.06/12, 24, -200)",result:"5141.85",description:"Monthly payments future value"}]},PV:{name:"PV",description:"Returns the present value of an investment",syntax:"PV(rate, nper, pmt, [fv], [type])",parameters:[{name:"rate",description:"Interest rate per period",required:!0},{name:"nper",description:"Number of payment periods",required:!0},{name:"pmt",description:"Payment made each period",required:!0},{name:"fv",description:"Future value (default: 0)",required:!1},{name:"type",description:"Payment timing (0=end, 1=beginning)",required:!1}],examples:[{formula:"PV(0.08, 10, -100, 0, 0)",result:"671.01",description:"Present value of annuity"},{formula:"PV(0.05/12, 60, -300)",result:"15761.86",description:"Present value of loan"}]},PMT:{name:"PMT",description:"Returns the periodic payment for an annuity",syntax:"PMT(rate, nper, pv, [fv], [type])",parameters:[{name:"rate",description:"Interest rate per period",required:!0},{name:"nper",description:"Number of payment periods",required:!0},{name:"pv",description:"Present value",required:!0},{name:"fv",description:"Future value (default: 0)",required:!1},{name:"type",description:"Payment timing (0=end, 1=beginning)",required:!1}],examples:[{formula:"PMT(0.05, 10, 1000)",result:"-129.50",description:"Payment for loan"},{formula:"PMT(0.06/12, 360, 200000)",result:"-1199.10",description:"Monthly mortgage payment"}]},NPV:{name:"NPV",description:"Returns the net present value of an investment",syntax:"NPV(rate, value1, [value2], ...)",parameters:[{name:"rate",description:"Discount rate per period",required:!0},{name:"value1",description:"First cash flow value",required:!0},{name:"value2",description:"Additional cash flow values",required:!1}],examples:[{formula:"NPV(0.1, -1000, 300, 400, 500)",result:"18.78",description:"NPV of cash flows"},{formula:"NPV(0.08, -5000, 1200, 1500, 2000, 2500)",result:"447.33",description:"Investment NPV"}]},IRR:{name:"IRR",description:"Returns the internal rate of return for cash flows",syntax:"IRR(values, [guess])",parameters:[{name:"values",description:"Array of cash flow values",required:!0},{name:"guess",description:"Initial guess for IRR (default: 0.1)",required:!1}],examples:[{formula:"IRR([-1000, 300, 400, 500])",result:"0.1296",description:"IRR of cash flows"},{formula:"IRR([-5000, 1200, 1500, 2000, 2500])",result:"0.0899",description:"Investment IRR"}]},MIRR:{name:"MIRR",description:"Returns the modified internal rate of return",syntax:"MIRR(values, finance_rate, reinvest_rate)",parameters:[{name:"values",description:"Array of cash flow values",required:!0},{name:"finance_rate",description:"Interest rate for financing costs",required:!0},{name:"reinvest_rate",description:"Interest rate for reinvestment",required:!0}],examples:[{formula:"MIRR([-1000, 300, 400, 500], 0.1, 0.12)",result:"0.1342",description:"MIRR with different rates"},{formula:"MIRR([-5000, 1200, 1500, 2000], 0.08, 0.10)",result:"0.0918",description:"Modified IRR"}]},NPER:{name:"NPER",description:"Returns the number of periods for an investment",syntax:"NPER(rate, pmt, pv, [fv], [type])",parameters:[{name:"rate",description:"Interest rate per period",required:!0},{name:"pmt",description:"Payment made each period",required:!0},{name:"pv",description:"Present value",required:!0},{name:"fv",description:"Future value (default: 0)",required:!1},{name:"type",description:"Payment timing (0=end, 1=beginning)",required:!1}],examples:[{formula:"NPER(0.05, -100, 1000)",result:"14.21",description:"Periods to pay off loan"},{formula:"NPER(0.06/12, -500, 25000)",result:"58.21",description:"Months to pay off loan"}]},RATE:{name:"RATE",description:"Returns the interest rate per period of an annuity",syntax:"RATE(nper, pmt, pv, [fv], [type], [guess])",parameters:[{name:"nper",description:"Number of payment periods",required:!0},{name:"pmt",description:"Payment made each period",required:!0},{name:"pv",description:"Present value",required:!0},{name:"fv",description:"Future value (default: 0)",required:!1},{name:"type",description:"Payment timing (0=end, 1=beginning)",required:!1},{name:"guess",description:"Initial guess for rate",required:!1}],examples:[{formula:"RATE(10, -100, 1000)",result:"0.0507",description:"Interest rate for loan"},{formula:"RATE(360, -1200, 200000)",result:"0.005",description:"Monthly mortgage rate"}]}}},engineering:{name:"Engineering",description:"Engineering and conversion functions",functions:{BIN2DEC:{name:"BIN2DEC",description:"Converts a binary number to decimal",syntax:"BIN2DEC(number)",parameters:[{name:"number",description:"The binary number to convert",required:!0}],examples:[{formula:'BIN2DEC("1010")',result:"10",description:"Convert binary to decimal"},{formula:'BIN2DEC("11111111")',result:"255",description:"Convert 8-bit binary"}]},DEC2BIN:{name:"DEC2BIN",description:"Converts a decimal number to binary",syntax:"DEC2BIN(number, [places])",parameters:[{name:"number",description:"The decimal number to convert",required:!0},{name:"places",description:"Number of characters to use",required:!1}],examples:[{formula:"DEC2BIN(10)",result:'"1010"',description:"Convert decimal to binary"},{formula:"DEC2BIN(10, 8)",result:'"00001010"',description:"Convert with padding"}]},DEC2HEX:{name:"DEC2HEX",description:"Converts a decimal number to hexadecimal",syntax:"DEC2HEX(number, [places])",parameters:[{name:"number",description:"The decimal number to convert",required:!0},{name:"places",description:"Number of characters to use",required:!1}],examples:[{formula:"DEC2HEX(255)",result:'"FF"',description:"Convert decimal to hex"},{formula:"DEC2HEX(10, 4)",result:'"000A"',description:"Convert with padding"}]},HEX2DEC:{name:"HEX2DEC",description:"Converts a hexadecimal number to decimal",syntax:"HEX2DEC(number)",parameters:[{name:"number",description:"The hexadecimal number to convert",required:!0}],examples:[{formula:'HEX2DEC("FF")',result:"255",description:"Convert hex to decimal"},{formula:'HEX2DEC("A0")',result:"160",description:"Convert hex with letters"}]},BITAND:{name:"BITAND",description:"Returns a bitwise AND of two numbers",syntax:"BITAND(number1, number2)",parameters:[{name:"number1",description:"First number for AND operation",required:!0},{name:"number2",description:"Second number for AND operation",required:!0}],examples:[{formula:"BITAND(5, 3)",result:"1",description:"Bitwise AND of 5 and 3"},{formula:"BITAND(255, 15)",result:"15",description:"Mask lower 4 bits"}]},BITOR:{name:"BITOR",description:"Returns a bitwise OR of two numbers",syntax:"BITOR(number1, number2)",parameters:[{name:"number1",description:"First number for OR operation",required:!0},{name:"number2",description:"Second number for OR operation",required:!0}],examples:[{formula:"BITOR(5, 3)",result:"7",description:"Bitwise OR of 5 and 3"},{formula:"BITOR(1, 2)",result:"3",description:"Combine bit flags"}]},BITXOR:{name:"BITXOR",description:"Returns a bitwise XOR of two numbers",syntax:"BITXOR(number1, number2)",parameters:[{name:"number1",description:"First number for XOR operation",required:!0},{name:"number2",description:"Second number for XOR operation",required:!0}],examples:[{formula:"BITXOR(5, 3)",result:"6",description:"Bitwise XOR of 5 and 3"},{formula:"BITXOR(15, 15)",result:"0",description:"XOR same numbers"}]},CONVERT:{name:"CONVERT",description:"Converts a number from one measurement system to another",syntax:"CONVERT(number, from_unit, to_unit)",parameters:[{name:"number",description:"The value to convert",required:!0},{name:"from_unit",description:"The unit to convert from",required:!0},{name:"to_unit",description:"The unit to convert to",required:!0}],examples:[{formula:'CONVERT(32, "F", "C")',result:"0",description:"Fahrenheit to Celsius"},{formula:'CONVERT(1, "m", "ft")',result:"3.28084",description:"Meters to feet"}]}}},datetime:{name:"Date & Time",description:"Date and time manipulation functions",functions:{NOW:{name:"NOW",description:"Returns the current date and time",syntax:"NOW()",parameters:[],examples:[{formula:"NOW()",result:"2024-01-15 14:30:00",description:"Current date and time"}]},TODAY:{name:"TODAY",description:"Returns the current date",syntax:"TODAY()",parameters:[],examples:[{formula:"TODAY()",result:"2024-01-15",description:"Current date"}]},YEAR:{name:"YEAR",description:"Returns the year of a date",syntax:"YEAR(date)",parameters:[{name:"date",description:"The date to extract year from",required:!0}],examples:[{formula:"YEAR(DATE(2024, 1, 15))",result:"2024",description:"Extract year from date"},{formula:"YEAR(TODAY())",result:"2024",description:"Current year"}]},MONTH:{name:"MONTH",description:"Returns the month of a date",syntax:"MONTH(date)",parameters:[{name:"date",description:"The date to extract month from",required:!0}],examples:[{formula:"MONTH(DATE(2024, 3, 15))",result:"3",description:"Extract month from date"},{formula:"MONTH(TODAY())",result:"1",description:"Current month"}]},DAY:{name:"DAY",description:"Returns the day of a date",syntax:"DAY(date)",parameters:[{name:"date",description:"The date to extract day from",required:!0}],examples:[{formula:"DAY(DATE(2024, 1, 15))",result:"15",description:"Extract day from date"},{formula:"DAY(TODAY())",result:"15",description:"Current day"}]},WEEKDAY:{name:"WEEKDAY",description:"Returns the day of the week for a date",syntax:"WEEKDAY(date, [return_type])",parameters:[{name:"date",description:"The date to get weekday for",required:!0},{name:"return_type",description:"Format for weekday (1=Sun-Sat 1-7, 2=Mon-Sun 1-7)",required:!1}],examples:[{formula:"WEEKDAY(DATE(2024, 1, 15))",result:"2",description:"Monday = 2 (Sunday=1 system)"},{formula:"WEEKDAY(TODAY(), 2)",result:"1",description:"Monday = 1 (Monday=1 system)"}]},HOUR:{name:"HOUR",description:"Returns the hour of a time value",syntax:"HOUR(time)",parameters:[{name:"time",description:"The time to extract hour from",required:!0}],examples:[{formula:"HOUR(TIME(14, 30, 0))",result:"14",description:"Extract hour from time"},{formula:"HOUR(NOW())",result:"14",description:"Current hour"}]},MINUTE:{name:"MINUTE",description:"Returns the minute of a time value",syntax:"MINUTE(time)",parameters:[{name:"time",description:"The time to extract minute from",required:!0}],examples:[{formula:"MINUTE(TIME(14, 30, 45))",result:"30",description:"Extract minute from time"},{formula:"MINUTE(NOW())",result:"30",description:"Current minute"}]},SECOND:{name:"SECOND",description:"Returns the second of a time value",syntax:"SECOND(time)",parameters:[{name:"time",description:"The time to extract second from",required:!0}],examples:[{formula:"SECOND(TIME(14, 30, 45))",result:"45",description:"Extract second from time"},{formula:"SECOND(NOW())",result:"23",description:"Current second"}]},TIME:{name:"TIME",description:"Creates a time value from hour, minute, and second",syntax:"TIME(hour, minute, second)",parameters:[{name:"hour",description:"Hour value (0-23)",required:!0},{name:"minute",description:"Minute value (0-59)",required:!0},{name:"second",description:"Second value (0-59)",required:!0}],examples:[{formula:"TIME(14, 30, 0)",result:"0.604167",description:"Create time 2:30 PM"},{formula:"TIME(12, 0, 0)",result:"0.5",description:"Create noon time"}]},DATE:{name:"DATE",description:"Creates a date value from year, month, and day",syntax:"DATE(year, month, day)",parameters:[{name:"year",description:"Year value",required:!0},{name:"month",description:"Month value (1-12)",required:!0},{name:"day",description:"Day value (1-31)",required:!0}],examples:[{formula:"DATE(2024, 1, 15)",result:"45306",description:"Create date January 15, 2024"},{formula:"DATE(2025, 12, 25)",result:"46065",description:"Create Christmas 2025"}]},DATEDIF:{name:"DATEDIF",description:"Calculates the difference between two dates",syntax:"DATEDIF(start_date, end_date, unit)",parameters:[{name:"start_date",description:"The starting date",required:!0},{name:"end_date",description:"The ending date",required:!0},{name:"unit",description:'Unit of time ("Y", "M", "D", "YM", "YD", "MD")',required:!0}],examples:[{formula:'DATEDIF(DATE(2020,1,1), DATE(2024,1,1), "Y")',result:"4",description:"Years between dates"},{formula:'DATEDIF(DATE(2024,1,1), DATE(2024,3,15), "D")',result:"74",description:"Days between dates"}]}}}},de=()=>{const t=[];return Object.entries(B).forEach(([d,n])=>{d!=="all"&&Object.entries(n.functions).forEach(([b,l])=>{t.push({...l,category:d,categoryName:n.name})})}),t},ue=()=>{const t=de(),d={};return t.forEach(n=>{d[n.name]=n}),B.all.functions=d,B};ue();const pe="modulepreload",fe=function(t){return"/xl-formula/"+t},z={},X=function(d,n,b){let l=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),s=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));l=Promise.allSettled(n.map(h=>{if(h=fe(h),h in z)return;z[h]=!0;const m=h.endsWith(".css"),p=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${p}`))return;const v=document.createElement("link");if(v.rel=m?"stylesheet":pe,m||(v.as="script"),v.crossOrigin="",v.href=h,s&&v.setAttribute("nonce",s),document.head.appendChild(v),m)return new Promise((a,c)=>{v.addEventListener("load",a),v.addEventListener("error",()=>c(new Error(`Unable to preload CSS for ${h}`)))})}))}function f(o){const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=o,window.dispatchEvent(s),!s.defaultPrevented)throw o}return l.then(o=>{for(const s of o||[])s.status==="rejected"&&f(s.reason);return d().catch(f)})};function he({func:t,category:d,categoryName:n}){var F;const[b,l]=A(((F=t.examples[0])==null?void 0:F.formula)||""),[f,o]=A(""),[s,h]=A(null),[m,p]=A(null),[v,a]=A(!1);_(()=>{c()},[]),_(()=>{s&&b&&E()},[b,s]);const c=async()=>{try{const i=await X(()=>import("./xl-formula-wrapper-nHyDW7a7.js"),__vite__mapDeps([0,1,2]));console.log("üîç XL Formula module loaded:",i),await i.default.init(),console.log("üîç XL Formula initialized successfully");const x=new i.default.FormulaEngine;console.log("üîç FormulaEngine created:",x);const C=x.evaluate("SUM(1,2,3)");if(C.isSuccess()){const N=C.getValue();console.log("üîç XL Formula test result:",N.asNumber())}try{const N=x.evaluate("NOW()");if(N.isSuccess()){const L=N.getValue();console.log("üîç NOW() test result:",L.asText())}}catch(N){console.error("üîç NOW() test failed:",N)}h(x)}catch(i){throw console.error("üîç Failed to initialize XL Formula:",i),i}},E=()=>{if(!(!s||!b))try{const i=b.startsWith("=")?b.substring(1):b;console.log("üîç FunctionDetail runTest:",{formula:i,xlFormula:s,hasEvaluate:typeof s.evaluate=="function"});const x=s.evaluate(i);if(x.isSuccess()){const C=x.getValue(),N=y(C);console.log("üîç evaluate result:",N,"Type:",C.getTypeName()),o(String(N))}else{const C=x.getErrorMessage()||"Unknown error";console.error("üîç evaluate error:",C),o(`Error: ${C}`)}}catch(i){console.error("üîç FunctionDetail error:",i),o(`Error: ${i.message}`)}},y=i=>{if(i.isNumber()){const x=i.asNumber();return Number.isInteger(x)?x.toString():x.toFixed(6).replace(/\.?0+$/,"")}else{if(i.isBoolean())return i.asBoolean()?"TRUE":"FALSE";if(i.isError())return i.getErrorText()}return i.asText()},R=async()=>{if(!(!s||!b)){a(!0),p(null);try{const x=b.startsWith("=")?b.substring(1):b;console.log("Running benchmark with XL Formula implementation"),console.log("Formula:",x),s.evaluate(x);const C=performance.now();let N;for(let D=0;D<1e5;D++){const P=s.evaluate(x);P.isSuccess()&&(N=P.getValue())}const L=performance.now()-C;console.log("XL Formula result:",N,"Time:",L,"ms");let S=null,w=null;try{const D=new J,P=D.parse(x);w=P.error?null:P.result,console.log("Hot-formula-parser args:",x),console.log("Hot-formula-parser parse result:",P),D.parse(x);const U=performance.now();for(let q=0;q<1e5;q++)D.parse(x);S=performance.now()-U,console.log("Hot-formula-parser result:",w,"Time:",S,"ms")}catch(D){console.warn("Hot-formula-parser benchmark failed:",D)}let I=!1;w!==null&&(typeof N=="number"&&typeof w=="number"?I=Math.abs(N-w)<.001:I=String(N)===String(w)),!I&&w!==null&&console.warn("Results don't match! XL:",N,"(",typeof N,") Hot-formula-parser:",w,"(",typeof w,")"),p({xlFormula:L,hotFormulaParser:S,iterations:1e5,speedup:S?(S/L).toFixed(2):null,xlResult:N,hotFormulaResult:w,resultsMatch:w!==null?I:null})}catch(i){console.error("Benchmark failed:",i),p({error:i.message,xlFormula:null,hotFormulaParser:null,iterations:0,speedup:null})}finally{a(!1)}}};return e("div",{children:[e("div",{style:{marginBottom:"2rem"},children:[e("div",{style:{marginBottom:"0.25rem"},children:[e("div",{style:{display:"inline-flex",alignItems:"center",gap:"0.4rem",marginBottom:"0"},children:e("span",{className:"text-xs rounded",style:{background:"var(--color-primary-light)",color:"var(--color-primary)",padding:"2px 8px"},children:n})}),e("h1",{className:"text-3xl font-mono font-bold",children:t.name})]}),e("p",{className:"text-lg text-muted",children:t.description})]}),e("div",{className:"grid grid-cols-2 gap-8",children:[e("div",{children:[e("div",{className:"card mb-6",children:[e("h3",{className:"font-semibold mb-4",children:"Syntax & Parameters"}),e("div",{className:"mb-4",children:[e("div",{className:"text-sm font-medium mb-2",children:"Syntax"}),e("div",{className:"font-mono p-3 rounded",style:{background:"var(--color-bg-secondary)"},children:t.syntax})]}),e("div",{children:[e("div",{className:"text-sm font-medium mb-3",children:"Parameters"}),t.parameters.length>0?e("div",{className:"grid gap-3",children:[t.parameters.map((i,x)=>e("div",{className:"flex gap-3",children:[e("div",{className:"font-mono text-sm font-medium",style:{minWidth:"100px"},children:[i.name,i.required&&e("span",{className:"text-error",children:"*"})]}),e("div",{className:"text-sm text-muted",children:i.description})]},x)),e("div",{className:"text-xs text-muted mt-2",children:"* Required parameter"})]}):e("p",{className:"text-muted text-sm",children:"This function takes no parameters."})]})]}),e("div",{className:"card",children:[e("h3",{className:"font-semibold mb-3",children:"Examples"}),e("div",{className:"grid gap-4",children:t.examples.map((i,x)=>e("div",{className:"p-3 rounded",style:{background:"var(--color-bg-secondary)"},children:[e("div",{className:"flex justify-between items-start mb-2",children:[e("code",{className:"font-mono text-sm",children:i.formula}),e("span",{className:"text-sm text-success",children:i.result})]}),e("div",{className:"text-xs text-muted",children:i.description})]},x))})]})]}),e("div",{children:[e("div",{className:"card mb-6",children:[e("h3",{className:"font-semibold mb-3",children:"Try It Out"}),e("label",{className:"label",children:"Formula"}),e("input",{type:"text",value:b,onChange:i=>l(i.target.value),className:"input monospace mb-3",placeholder:"Enter a formula to test"}),e("div",{className:"p-3 rounded",style:{background:"var(--color-success-light)",border:"1px solid var(--color-success)"},children:[e("div",{className:"flex justify-between items-center",children:[e("strong",{children:"Result:"}),e("button",{onClick:E,className:"btn btn-sm",children:"Run Test"})]}),e("div",{className:"font-mono mt-2",children:f||'Click "Run Test" to see result'})]}),e("div",{className:"mt-4",children:[e("h4",{className:"font-medium mb-2",children:"Quick Examples"}),e("div",{className:"grid gap-2",children:t.examples.map((i,x)=>e("button",{onClick:()=>l(i.formula),className:"btn btn-sm text-left",style:{justifyContent:"flex-start"},children:e("code",{className:"font-mono text-xs",children:i.formula})},x))})]})]}),e("div",{className:"card",children:[e("h3",{className:"font-semibold mb-3",children:"Performance Benchmark"}),e("p",{className:"text-sm text-muted mb-4",children:"Compare XL Formula performance against Hot Formula Parser"}),e("button",{onClick:R,disabled:v||!b,className:"btn btn-primary mb-4",children:v?"Running Benchmark...":"Run Benchmark"}),m&&e("div",{className:"grid gap-3",children:m.error?e("div",{className:"p-3 rounded",style:{background:"var(--color-error-light)",color:"var(--color-error)"},children:[e("strong",{children:"Benchmark Error:"})," ",m.error]}):e(H,{children:[e("div",{className:"flex justify-between",children:[e("span",{children:"XL Formula:"}),e("span",{className:"font-mono",children:m.xlFormula?`${m.xlFormula.toFixed(2)}ms`:"N/A"})]}),m.hotFormulaParser&&e(H,{children:[e("div",{className:"flex justify-between",children:[e("span",{children:"Hot Formula Parser:"}),e("span",{className:"font-mono",children:[m.hotFormulaParser.toFixed(2),"ms"]})]}),e("div",{className:"flex justify-between font-semibold",children:[e("span",{children:"Speedup:"}),e("span",{className:m.speedup>1?"text-success":"text-error",children:m.speedup>1?`${m.speedup}x faster`:`${(1/parseFloat(m.speedup)).toFixed(2)}x slower`})]})]}),m.resultsMatch!==null&&e("div",{className:"flex justify-between text-xs",children:[e("span",{children:"Results match:"}),e("span",{className:m.resultsMatch?"text-success":"text-error",children:[m.resultsMatch?"‚úì Yes":"‚úó No",!m.resultsMatch&&` (XL: ${m.xlResult}, HFP: ${m.hotFormulaResult})`]})]}),e("div",{className:"text-xs text-muted",children:["Tested with ",m.iterations.toLocaleString()," iterations"]})]})}),!m&&!v&&e("div",{className:"text-sm text-muted",children:'Enter a formula above and click "Run Benchmark" to compare performance against Hot Formula Parser.'})]})]})]})]})}const k="/xl-formula/";function W({category:t,function:d}){const n=t||"all",b=d||null,[l,f]=A("");_(()=>{!t&&!d&&window.location.pathname===`${k}docs`&&oe(`${k}docs/all`,!0)},[t,d]);const o=B[n],s=b&&(o==null?void 0:o.functions[b.toUpperCase()]),m=(()=>{if(!o)return[];const p=Object.entries(o.functions);let v;if(!l.trim())v=p;else{const a=l.toLowerCase();v=p.filter(([c,E])=>E.name.toLowerCase().includes(a)||E.description.toLowerCase().includes(a)||E.syntax.toLowerCase().includes(a))}return v.sort(([a,c],[E,y])=>c.name.localeCompare(y.name))})();return b&&s?e("div",{className:"container",style:{padding:"2rem 0"},children:[e("div",{className:"mb-6",children:e("nav",{className:"flex items-center gap-2 text-sm text-muted",children:[e(M,{href:`${k}docs`,style:{textDecoration:"none",color:"var(--color-primary)"},children:"Documentation"}),e("span",{children:"‚Üí"}),e(M,{href:`${k}docs/${n}`,style:{textDecoration:"none",color:"var(--color-primary)"},children:o==null?void 0:o.name}),e("span",{children:"‚Üí"}),e("span",{children:s.name})]})}),e(he,{func:s,category:s.category||n,categoryName:s.categoryName||o.name})]}):e("div",{className:"container",style:{padding:"2rem 0"},children:[e("h1",{className:"text-2xl font-bold mb-6",children:"Documentation"}),e("div",{style:{display:"flex",gap:"2rem"},children:[e("div",{style:{width:"25%",minWidth:"250px"},children:e("div",{className:"card",children:[e("h3",{className:"font-semibold mb-4",children:"Categories"}),e("div",{className:"grid gap-2",children:Object.entries(B).map(([p,v])=>{const c={all:"üìö",math:"üî¢",text:"üìù",logical:"üîÄ",datetime:"üìÖ",financial:"üí∞",engineering:"‚öôÔ∏è"}[p]||"üìÑ";return e(M,{href:`${k}docs/${p}`,className:`p-3 rounded text-sm ${n===p?"bg-primary text-white":"hover:bg-secondary"}`,style:{textDecoration:"none",display:"block",background:n===p?"var(--color-primary)":"transparent",color:n===p?"white":"var(--color-text)"},children:e("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e("span",{style:{fontSize:"1.2rem"},children:c}),e("div",{children:[e("div",{className:"font-medium",children:v.name}),e("div",{className:"text-xs opacity-80",children:[Object.keys(v.functions).length," functions"]})]})]})},p)})})]})}),e("div",{style:{flex:1},children:e("div",{className:"card",children:[e("div",{className:"flex justify-between items-center mb-4",children:[e("h3",{className:"font-semibold",children:o==null?void 0:o.name}),e("div",{className:"text-sm text-muted",children:[m.length," function",m.length!==1?"s":"",l&&` matching "${l}"`]})]}),e("div",{className:"mb-4",children:e("input",{type:"text",placeholder:"Search functions...",value:l,onChange:p=>f(p.target.value),onInput:p=>f(p.target.value),onKeyUp:p=>f(p.target.value),style:{width:"100%",padding:"8px 12px",border:"1px solid var(--color-border)",borderRadius:"4px",fontSize:"14px"}})}),e("p",{className:"text-sm text-muted mb-4",children:o==null?void 0:o.description}),e("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:m.length>0?m.map(([p,v])=>e(M,{href:`${k}docs/${n}/${p.toLowerCase()}`,className:"p-3 rounded border hover:border-primary",style:{textDecoration:"none",display:"block",border:"1px solid var(--color-border)"},children:[e("div",{className:"font-mono font-medium text-sm",children:v.name}),e("div",{className:"text-xs text-muted mt-1",children:v.description})]},p)):e("div",{className:"col-span-full text-center py-8 text-muted",children:[e("div",{className:"text-lg mb-2",children:"No functions found"}),e("div",{className:"text-sm",children:l?`No functions match "${l}"`:"No functions in this category"})]})})]})})]})]})}function xe({formula:t="SUM(1,2,3,4,5)",compact:d=!1}){var h,m,p,v;const[n,b]=A({}),[l,f]=A(!0);_(()=>{s()},[t]);const o=()=>{s()},s=async()=>{f(!0);const a={};try{a.importTest="attempting...";try{const c=await X(()=>import("./xl-formula-wrapper-nHyDW7a7.js"),__vite__mapDeps([0,1,2]));a.importTest="success",a.module=Object.keys(c),a.initTest="attempting...",await c.default.init(),a.initTest="success",a.calcTest="attempting...";const E=t.startsWith("=")?t.substring(1):t;try{const y=c.default.evaluate(E);if(y.isSuccess()){const R=y.getValue();a.calcTest=`success: ${R.asText()}`,a.isReal=!0;const F=1e4,i=performance.now();for(let C=0;C<F;C++)c.default.evaluate(E);const x=performance.now()-i;a.xlPerformance=`${x.toFixed(2)}ms for ${F} iterations`}else a.calcTest=`failed: ${y.getErrorMessage()}`,a.xlPerformance="Skipped (invalid formula)",a.isReal=!1}catch(y){a.calcTest=`failed: ${y.message}`,a.xlPerformance="Skipped (invalid formula)",a.isReal=!1}}catch(c){a.importTest=`failed: ${c.message}`,a.error=c.toString(),a.isReal=!1}try{const E=new J,y=t.startsWith("=")?t.substring(1):t,R=E.parse(y);if(R.error)a.hotFormulaParserPerformance=`Skipped (${R.error})`;else{const F=performance.now();for(let x=0;x<1e4;x++)E.parse(y);const i=performance.now()-F;a.hotFormulaParserPerformance=`${i.toFixed(2)}ms for 10000 iterations`}}catch(c){a.hotFormulaParserError=c.toString()}try{const c=await fetch("/packages/web/xl-formula.wasm");a.wasmFileCheck=c.ok?"accessible":`failed: ${c.status}`}catch(c){a.wasmFileCheck=`failed: ${c.message}`}try{const c=await fetch("/packages/web/xl-formula-wrapper.js");a.wrapperFileCheck=c.ok?"accessible":`failed: ${c.status}`}catch(c){a.wrapperFileCheck=`failed: ${c.message}`}}catch(c){a.generalError=c.toString()}b(a),f(!1)};return l?e("div",{children:"Running diagnostic..."}):d?e("div",{className:"text-xs text-muted",children:l?e("span",{children:"Benchmarking..."}):e(H,{children:n.error?e("span",{children:"Benchmark error"}):e(H,{children:[n.xlPerformance&&n.hotFormulaParserPerformance&&!n.xlPerformance.includes("Skipped")&&!n.hotFormulaParserPerformance.includes("Skipped")&&e("div",{children:(()=>{var R,F,i;const a=parseFloat(((R=n.xlPerformance.match(/(\d+\.?\d*)/))==null?void 0:R[1])||"0"),c=parseFloat(((F=n.hotFormulaParserPerformance.match(/(\d+\.?\d*)/))==null?void 0:F[1])||"0"),E=((i=n.xlPerformance.match(/(\d+(?:,\d+)*) iterations/))==null?void 0:i[1])||"10000",y=c/a;return e(H,{children:[e("div",{children:["XL Formula: ",a,"ms ‚Ä¢ Hot Formula Parser: ",c,"ms (",E," iterations)"]}),e("div",{className:y>1?"text-success":"text-error",children:y>1?`${y.toFixed(1)}x faster`:`${(1/y).toFixed(1)}x slower`})]})})()}),(((h=n.calcTest)==null?void 0:h.includes("failed"))||((m=n.hotFormulaParserPerformance)==null?void 0:m.includes("Skipped")))&&e("span",{children:"Benchmark skipped"})]})})}):e("div",{className:"card",children:[e("div",{className:"flex justify-between items-center mb-3",children:[e("h3",{className:"font-semibold",children:"Performance Benchmark"}),e("button",{onClick:o,className:"btn btn-sm",disabled:l,children:l?"Running...":"Refresh"})]}),e("p",{className:"text-sm text-muted mb-3",children:["Formula: ",e("code",{className:"font-mono",children:t})]}),n.error?e("div",{className:"p-3 rounded text-sm",style:{background:"var(--color-error-light)",color:"var(--color-error)"},children:[e("strong",{children:"Error:"})," ",n.error]}):e("div",{className:"grid gap-3",children:[n.xlPerformance&&n.hotFormulaParserPerformance&&e(H,{children:[e("div",{className:"flex justify-between",children:[e("span",{children:"XL Formula:"}),e("span",{className:"font-mono",children:n.xlPerformance})]}),e("div",{className:"flex justify-between",children:[e("span",{children:"Hot Formula Parser:"}),e("span",{className:"font-mono",children:n.hotFormulaParserPerformance})]}),n.xlPerformance&&n.hotFormulaParserPerformance&&!n.xlPerformance.includes("Skipped")&&!n.hotFormulaParserPerformance.includes("Skipped")&&e("div",{className:"flex justify-between font-semibold pt-2 border-t",children:[e("span",{children:"Performance:"}),e("span",{className:"text-success",children:(()=>{var y,R;const a=parseFloat(((y=n.xlPerformance.match(/(\d+\.?\d*)/))==null?void 0:y[1])||"0"),E=parseFloat(((R=n.hotFormulaParserPerformance.match(/(\d+\.?\d*)/))==null?void 0:R[1])||"0")/a;return E>1?`${E.toFixed(1)}x faster`:`${(1/E).toFixed(1)}x slower`})()})]})]}),(((p=n.calcTest)==null?void 0:p.includes("failed"))||((v=n.hotFormulaParserPerformance)==null?void 0:v.includes("Skipped")))&&e("div",{className:"text-sm text-muted",children:"Invalid formula - benchmark skipped"})]})]})}function ge(){const[t,d]=A("=SUM(1, 2, 3, 4, 5)"),[n,b]=A(""),[l,f]=A(""),[o,s]=A(!1),[h,m]=A([{name:"A1",value:"10"},{name:"B1",value:"20"},{name:"C1",value:"30"}]),[p,v]=A(""),[a,c]=A(""),[E,y]=A(null),[R,F]=A(null),[i,x]=A(!0),[C,N]=A([]),[L,S]=A(!1),[w,I]=A("");_(()=>{const r=localStorage.getItem("xl-formula-saved");if(r)try{const u=JSON.parse(r).map(T=>typeof T=="string"?{formula:T,name:null,variables:[],timestamp:new Date().toISOString()}:T);N(u)}catch(g){console.warn("Failed to parse saved formulas from localStorage",g)}else{const g=localStorage.getItem("xl-formula-history");if(g)try{const T=JSON.parse(g).map(O=>typeof O=="string"?{formula:O,name:null,variables:[],timestamp:new Date().toISOString()}:O);N(T),localStorage.setItem("xl-formula-saved",JSON.stringify(T)),localStorage.removeItem("xl-formula-history")}catch(u){console.warn("Failed to migrate formula history",u)}}},[]);const D=(r,g=null)=>{if(console.log("saveFormula called with:",{formula:r,name:g,variables:h}),!r||r.trim()===""){console.log("Formula is empty, not saving");return}const u={formula:r,name:g||null,variables:[...h],timestamp:new Date().toISOString()};console.log("Creating saved item:",u);const T=[u,...C.filter(O=>(typeof O=="string"?O:O.formula)!==r)].slice(0,20);console.log("New saved formulas array:",T),N(T),localStorage.setItem("xl-formula-saved",JSON.stringify(T)),console.log("Saved to localStorage:",localStorage.getItem("xl-formula-saved"))};_(()=>{P()},[]);const P=async()=>{try{const r=await X(()=>import("./xl-formula-wrapper-nHyDW7a7.js"),__vite__mapDeps([0,1,2]));await r.default.init();const g=new r.default.FormulaEngine;h.forEach(({name:u,value:T})=>{g.setVariable(u,U(T))}),y(r.default),F(g),x(!1),q(t,g)}catch(r){throw console.error("Failed to initialize XL Formula:",r),x(!1),r}},U=r=>{const g=parseFloat(r);if(!isNaN(g)&&isFinite(g))return g;const u=r.toLowerCase();return u==="true"||u==="false"?u==="true":r},q=(r,g=R)=>{if(!g||!r.trim()){b(""),f("empty"),s(!1);return}try{const u=g.evaluate(r);if(u.isSuccess()){const T=u.getValue();b(K(T)),f(T.getTypeName()),s(!0)}else b(u.getErrorMessage()||"Unknown error"),f("error"),s(!1)}catch(u){b(`Error: ${u.message}`),f("error"),s(!1)}},K=r=>{if(r.isNumber()){const g=r.asNumber();return Number.isInteger(g)?g.toString():g.toFixed(6).replace(/\.?0+$/,"")}else{if(r.isBoolean())return r.asBoolean()?"TRUE":"FALSE";if(r.isError())return r.getErrorText()}return r.asText()},Q=()=>{if(!p||!a)return;const r={name:p,value:a};m([...h,r]),R&&(R.setVariable(p,U(a)),q(t)),v(""),c("")},Z=r=>{m(h.filter(g=>g.name!==r)),R&&(R.removeVariable(r),q(t))},ee=r=>{console.log("Loading saved formula:",r);const g=typeof r=="string"?r:r.formula,u=typeof r=="object"?r.variables:[];console.log("Extracted formula:",g,"variables:",u),d(g),u&&u.length>0?(console.log("Restoring variables:",u),m(u),R&&(h.forEach(T=>{console.log("Removing variable:",T.name),R.removeVariable(T.name)}),u.forEach(({name:T,value:O})=>{console.log("Setting variable:",T,"=",O),R.setVariable(T,U(O))}))):console.log("No variables to restore"),q(g)},re=r=>{d(r),q(r)};return i?e("div",{className:"container",style:{padding:"4rem 0",textAlign:"center"},children:e("div",{children:"Loading XL Formula engine..."})}):e("div",{className:"container",style:{padding:"2rem 0"},children:[e("h1",{className:"text-2xl font-bold mb-6",children:"Formula Playground"}),e("div",{className:"card mb-6",children:[e("label",{className:"label",children:"Formula"}),e("div",{className:"flex gap-2 mb-4",children:[e("input",{type:"text",value:t,onChange:r=>{d(r.target.value),q(r.target.value)},className:"input monospace flex-1",placeholder:"Enter a formula like =SUM(1, 2, 3) or =A1 + B1"}),e("button",{onClick:()=>{console.log("Save button clicked, formula:",t),console.log("Setting showSaveDialog to true"),S(!0),console.log("showSaveDialog should now be:",!0)},className:"btn btn-sm",disabled:!t.trim(),children:"Save"})]}),e("div",{className:"p-4 rounded",style:{background:o?"var(--color-success-light)":"var(--color-error-light)",border:`1px solid ${o?"var(--color-success)":"var(--color-error)"}`,fontFamily:"var(--font-mono)"},children:[e("div",{className:"flex justify-between items-center",children:[e("strong",{children:"Result:"}),e("span",{className:"text-sm",children:l})]}),e("div",{className:"flex justify-between items-center",style:{marginTop:"0.5rem"},children:[e("div",{style:{fontSize:"1.1rem"},children:n||"Enter a formula to see the result"}),n&&e("div",{style:{marginLeft:"1rem"},children:e(xe,{formula:t,compact:!0})})]})]})]}),C.length>0&&e("div",{className:"card mb-6",children:[e("div",{className:"flex justify-between items-center mb-4",children:[e("h3",{className:"font-semibold",children:["Saved Formulas (",C.length,")"]}),e("button",{onClick:()=>{N([]),localStorage.removeItem("xl-formula-saved")},className:"btn btn-sm",style:{fontSize:"0.75rem"},children:"Clear All"})]}),e("div",{className:"grid gap-2",children:C.map((r,g)=>e("div",{onClick:()=>ee(r),className:"p-3 rounded cursor-pointer flex justify-between items-center",style:{background:"var(--color-bg-secondary)",border:"1px solid var(--color-border)",cursor:"pointer"},onMouseOver:u=>u.currentTarget.style.borderColor="var(--color-primary)",onMouseOut:u=>u.currentTarget.style.borderColor="var(--color-border)",children:[e("div",{className:"flex-1",children:[r.name&&e("div",{className:"text-sm font-medium text-primary mb-1",children:r.name}),e("div",{className:"font-mono text-sm",children:r.formula}),r.variables&&r.variables.length>0&&e("div",{className:"text-xs text-muted mt-1",children:["Variables: ",r.variables.map(u=>`${u.name}=${u.value}`).join(", ")]})]}),e("button",{onClick:u=>{u.stopPropagation();const T=C.filter((O,te)=>te!==g);N(T),localStorage.setItem("xl-formula-saved",JSON.stringify(T))},className:"text-xs text-muted hover:text-error ml-2",style:{padding:"4px 8px"},title:"Delete saved formula",children:"√ó"})]},g))})]}),e("div",{className:"grid grid-cols-2 gap-6",children:[e("div",{className:"card",children:[e("h3",{className:"font-semibold mb-4",children:"Variables"}),e("div",{className:"flex gap-2 mb-4",children:[e("input",{type:"text",value:p,onChange:r=>v(r.target.value),placeholder:"Variable name",className:"input"}),e("input",{type:"text",value:a,onChange:r=>c(r.target.value),placeholder:"Value",className:"input"}),e("button",{onClick:Q,className:"btn btn-primary",children:"Add"})]}),e("div",{className:"grid gap-2",children:h.map(r=>e("div",{className:"flex justify-between items-center p-2 rounded",style:{background:"var(--color-bg-secondary)"},children:[e("span",{className:"font-mono font-medium",children:r.name}),e("span",{className:"font-mono text-muted",children:r.value}),e("button",{onClick:()=>Z(r.name),className:"btn btn-sm",style:{background:"var(--color-error)",color:"white",border:"none"},children:"Remove"})]},r.name))})]}),e("div",{className:"card",children:[e("h3",{className:"font-semibold mb-4",children:"Examples"}),e("div",{className:"grid gap-3",children:[{formula:"=SUM(1, 2, 3, 4, 5)",description:"Basic sum function"},{formula:"=MAX(10, 20, 5, 30)",description:"Find maximum value"},{formula:"=ROUND(3.14159, 2)",description:"Round to 2 decimal places"},{formula:'=IF(5 > 3, "Yes", "No")',description:"Conditional logic"},{formula:'=CONCATENATE("Hello", " ", "World")',description:"Text concatenation"},{formula:"=A1 + B1 * C1",description:"Using variables"}].map((r,g)=>e("div",{onClick:()=>re(r.formula),className:"p-3 rounded cursor-pointer",style:{background:"var(--color-bg-secondary)",border:"1px solid var(--color-border)",cursor:"pointer"},onMouseOver:u=>u.currentTarget.style.borderColor="var(--color-primary)",onMouseOut:u=>u.currentTarget.style.borderColor="var(--color-border)",children:[e("div",{className:"font-mono font-medium text-sm",children:r.formula}),e("div",{className:"text-xs text-muted mt-1",children:r.description})]},g))})]})]}),L&&e("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},onClick:r=>{console.log("Dialog overlay clicked"),r.target===r.currentTarget&&S(!1)},children:e("div",{style:{backgroundColor:"white",borderRadius:"8px",padding:"24px",width:"400px",maxWidth:"90vw",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)"},onClick:r=>r.stopPropagation(),children:[e("h3",{style:{fontSize:"18px",fontWeight:"bold",marginBottom:"16px"},children:"Save Formula"}),e("div",{style:{marginBottom:"16px"},children:[e("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",marginBottom:"8px"},children:"Formula Name (optional)"}),e("input",{type:"text",value:w,onChange:r=>I(r.target.value),style:{width:"100%",padding:"8px 12px",border:"1px solid #ccc",borderRadius:"4px",fontSize:"14px"},placeholder:"e.g. 'Complex calculation', 'Tax formula'",autoFocus:!0})]}),e("div",{style:{marginBottom:"16px"},children:[e("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",marginBottom:"8px"},children:"Formula"}),e("div",{style:{padding:"8px 12px",backgroundColor:"#f5f5f5",borderRadius:"4px",fontFamily:"monospace",fontSize:"14px"},children:t})]}),h.length>0&&e("div",{style:{marginBottom:"16px"},children:[e("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",marginBottom:"8px"},children:"Variables to Save"}),e("div",{style:{fontSize:"14px",color:"#666"},children:h.map(r=>`${r.name}=${r.value}`).join(", ")})]}),e("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end"},children:[e("button",{onClick:()=>{S(!1),I("")},style:{padding:"8px 16px",border:"1px solid #ccc",borderRadius:"4px",backgroundColor:"white",cursor:"pointer"},children:"Cancel"}),e("button",{onClick:()=>{console.log("Dialog Save button clicked"),D(t,w.trim()||null),S(!1),I("")},style:{padding:"8px 16px",border:"none",borderRadius:"4px",backgroundColor:"#007bff",color:"white",cursor:"pointer"},children:"Save"})]})]})})]})}function be(){const t="/xl-formula/";return e("div",{style:{minHeight:"100vh",display:"flex",flexDirection:"column"},children:[e(me,{}),e("main",{style:{flex:1},children:e(ie,{children:[e(Y,{path:t}),e(Y,{path:`${t}`}),e(W,{path:`${t}docs`}),e(W,{path:`${t}docs/:category?`}),e(W,{path:`${t}docs/:category/:function?`}),e(ge,{path:`${t}playground`})]})})]})}se(e(be,{}),document.getElementById("app"));export{X as _};
