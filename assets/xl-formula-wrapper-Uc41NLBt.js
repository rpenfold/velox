import{_ as h}from"./index-D0ZDAHky.js";import"./vendor-CCnpLwun.js";import"./formula-DkIGol2c.js";let i=null;async function m(){if(i)return!0;try{const r=(await h(async()=>{const{default:e}=await import("./xl-formula-BX9Oh3Op.js");return{default:e}},[])).default;return i=await r(),!0}catch(r){return console.error("Failed to initialize XL Formula library:",r),!1}}function n(){return i!==null}class a{constructor(e){this._value=e}static number(e){if(!n())throw new Error("XL Formula not initialized");return new a(i.Value.fromNumber(e))}static text(e){if(!n())throw new Error("XL Formula not initialized");return new a(i.Value.fromText(e))}static boolean(e){if(!n())throw new Error("XL Formula not initialized");return new a(i.Value.fromBoolean(e))}static empty(){if(!n())throw new Error("XL Formula not initialized");return new a(i.Value.empty())}static date(e){if(!n())throw new Error("XL Formula not initialized");return new a(i.Value.fromDate(e))}isNumber(){return this._value.isNumber()}isText(){return this._value.isText()}isBoolean(){return this._value.isBoolean()}isError(){return this._value.isError()}isEmpty(){return this._value.isEmpty()}isDate(){return this._value.isDate()}asNumber(){return this._value.asNumber()}asText(){return this._value.asText()}asBoolean(){return this._value.asBoolean()}asDate(){if(this.isDate()){const e=this._value.asDate();return new Date(e*1e3)}throw new Error("Value is not a date")}getErrorText(){return this._value.getErrorText()}getTypeName(){return this._value.getTypeName()}toString(){return this.asText()}valueOf(){return this.isNumber()?this.asNumber():this.isBoolean()?this.asBoolean():this.asText()}}class o{constructor(e){this._result=e}isSuccess(){return this._result.isSuccess()}hasError(){return this._result.hasError()}getValue(){return new a(this._result.getValue())}getErrorMessage(){return this._result.getErrorMessage()}getErrors(){return this._result.getErrors()}}class f{constructor(){if(!n())throw new Error("XL Formula not initialized");this._engine=new i.FormulaEngine}setVariable(e,t){if(t instanceof a)this._engine.setVariable(e,t._value);else if(typeof t=="number")this._engine.setNumberVariable(e,t);else if(typeof t=="string")this._engine.setTextVariable(e,t);else if(typeof t=="boolean")this._engine.setBooleanVariable(e,t);else throw new Error("Invalid value type");return this}setNumber(e,t){return this._engine.setNumberVariable(e,t),this}setText(e,t){return this._engine.setTextVariable(e,t),this}setBoolean(e,t){return this._engine.setBooleanVariable(e,t),this}getVariable(e){return new a(this._engine.getVariable(e))}hasVariable(e){return this._engine.hasVariable(e)}removeVariable(e){return this._engine.removeVariable(e),this}clearVariables(){return this._engine.clearVariables(),this}evaluate(e){return new o(this._engine.evaluate(s(e)))}evaluateNumber(e){return this._engine.evaluateNumber(s(e))}evaluateText(e){return this._engine.evaluateText(s(e))}evaluateBoolean(e){return this._engine.evaluateBoolean(s(e))}evaluateDate(e){const t=this._engine.evaluate(s(e));if(t.isSuccess()){const u=new a(t.getValue());if(u.isDate())return u.asDate();throw new Error("Formula result is not a date")}throw new Error(t.getErrorMessage())}}function s(r){return r.startsWith("=")?r.substring(1):r}function w(r){if(!n())throw new Error("XL Formula not initialized");return new o(i.evaluate(s(r)))}function _(r){if(!n())throw new Error("XL Formula not initialized");return i.evaluateNumber(s(r))}function c(r){if(!n())throw new Error("XL Formula not initialized");return i.evaluateText(s(r))}function g(r){if(!n())throw new Error("XL Formula not initialized");return i.evaluateBoolean(s(r))}function b(){if(!n())throw new Error("XL Formula not initialized");return i.getVersion()}const l={init:m,isInitialized:n,Value:a,EvaluationResult:o,FormulaEngine:f,evaluate:w,evaluateNumber:_,evaluateText:c,evaluateBoolean:g,getVersion:b};typeof module<"u"&&module.exports&&(module.exports=l);typeof window<"u"&&(window.XLFormula=l);export{l as default};
