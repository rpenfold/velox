const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/xl-formula-wrapper-BEBZ9tPI.js","assets/vendor-CCnpLwun.js","assets/formula-DkIGol2c.js"])))=>i.map(i=>d[i]);
import{l as $,C as ne,s as j,_ as ae,E as L,d as R,k as M,y as B,$ as oe,D as ie,G as se}from"./vendor-CCnpLwun.js";import{P as J}from"./formula-DkIGol2c.js";(function(){const b=document.createElement("link").relList;if(b&&b.supports&&b.supports("modulepreload"))return;for(const m of document.querySelectorAll('link[rel="modulepreload"]'))u(m);new MutationObserver(m=>{for(const f of m)if(f.type==="childList")for(const p of f.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&u(p)}).observe(document,{childList:!0,subtree:!0});function a(m){const f={};return m.integrity&&(f.integrity=m.integrity),m.referrerPolicy&&(f.referrerPolicy=m.referrerPolicy),m.crossOrigin==="use-credentials"?f.credentials="include":m.crossOrigin==="anonymous"?f.credentials="omit":f.credentials="same-origin",f}function u(m){if(m.ep)return;m.ep=!0;const f=a(m);fetch(m.href,f)}})();var le=0;function e(n,b,a,u,m,f){b||(b={});var p,l,i=b;if("ref"in i)for(l in i={},b)l=="ref"?p=b[l]:i[l]=b[l];var c={type:n,props:i,key:a,ref:p,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--le,__i:-1,__u:0,__source:m,__self:f};if(typeof n=="function"&&(p=n.defaultProps))for(l in p)i[l]===void 0&&(i[l]=p[l]);return $.vnode&&$.vnode(c),c}var me=["className","activeClass","activeClassName","path"];function H(n){var b=n.className,a=n.activeClass,u=n.activeClassName,m=n.path,f=function(A,y){if(A==null)return{};var t,o,N={},g=Object.keys(A);for(o=0;o<g.length;o++)y.indexOf(t=g[o])>=0||(N[t]=A[t]);return N}(n,me),p=ne()[0],l=m&&p.path&&j(p.path,m,{})||j(p.url,f.href,{}),i=f.class||b||"",c=l&&(a||u)||"";return f.class=i+(i&&c&&" ")+c,ae(L,f)}function ce(){const n="/xl-formula/",[b,a]=R(!1);return e("header",{style:{borderBottom:"1px solid var(--color-border)",background:"var(--color-bg)",position:"sticky",top:0,zIndex:50},children:[e("div",{className:"container",children:e("nav",{className:"flex items-center justify-between",style:{height:"4rem"},children:[e("div",{className:"flex items-center",style:{flex:1},children:[e(H,{href:n,className:"text-xl font-bold",style:{textDecoration:"none",color:"var(--color-primary)"},children:"XL Formula"}),e("button",{className:"show-mobile",style:{marginLeft:"auto",background:"none",border:"none",color:"var(--color-text)",fontSize:"1.5rem",display:"none",padding:"0.25rem 0.5rem"},"aria-label":"Open menu",onClick:()=>a(!0),children:e("span",{style:{fontSize:"1.75rem",lineHeight:1},children:"☰"})}),e("div",{className:"flex items-center hide-mobile",style:{marginLeft:"1rem"},children:[e(H,{href:`${n}playground`,className:"text-sm font-medium nav-link",style:{textDecoration:"none",color:"var(--color-text-secondary)",padding:"6px 10px",borderRadius:"6px",transition:"all 0.2s ease"},activeClassName:"text-primary",onMouseOver:u=>u.target.style.backgroundColor="var(--color-bg-secondary)",onMouseOut:u=>u.target.style.backgroundColor="transparent",children:"Playground"}),e(H,{href:`${n}docs`,className:"text-sm font-medium nav-link",style:{textDecoration:"none",color:"var(--color-text-secondary)",padding:"6px 10px",borderRadius:"6px",transition:"all 0.2s ease"},activeClassName:"text-primary",onMouseOver:u=>u.target.style.backgroundColor="var(--color-bg-secondary)",onMouseOut:u=>u.target.style.backgroundColor="transparent",children:"Documentation"})]})]}),e("div",{className:"flex items-center gap-4 hide-mobile",children:[e("a",{href:"https://github.com/rpenfold/xl-formula",target:"_blank",rel:"noopener noreferrer",className:"btn btn-sm",children:"GitHub"}),e("a",{href:"https://www.npmjs.com/package/xl-formula-web",target:"_blank",rel:"noopener noreferrer",className:"btn btn-sm btn-primary",children:"npm install"})]})]})}),b&&e(M,{children:[e("div",{className:"sidebar-mobile-backdrop",onClick:()=>a(!1)}),e("div",{className:"sidebar-mobile-drawer open",children:[e("div",{style:{padding:"1rem",borderBottom:"1px solid var(--color-border)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e("span",{className:"text-xl font-bold",style:{color:"var(--color-primary)"},children:"XL Formula"}),e("button",{className:"btn btn-sm",style:{background:"none",border:"none",fontSize:"1.5rem"},"aria-label":"Close menu",onClick:()=>a(!1),children:"×"})]}),e("nav",{style:{display:"flex",flexDirection:"column",padding:"1rem"},children:[e(H,{href:n,className:"btn btn-sm",style:{marginBottom:"0.5rem"},onClick:()=>a(!1),children:"Home"}),e(H,{href:`${n}playground`,className:"btn btn-sm",onClick:()=>a(!1),children:"Playground"}),e(H,{href:`${n}docs`,className:"btn btn-sm",onClick:()=>a(!1),children:"Documentation"}),e("a",{href:"https://github.com/rpenfold/xl-formula",target:"_blank",rel:"noopener noreferrer",className:"btn btn-sm",children:"GitHub"}),e("a",{href:"https://www.npmjs.com/package/xl-formula-web",target:"_blank",rel:"noopener noreferrer",className:"btn btn-sm btn-primary",children:"npm install"})]})]})]})]})}const z="/xl-formula/";function G(){return e("div",{children:[e("section",{style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",padding:"6rem 0"},children:e("div",{className:"container",style:{textAlign:"center"},children:[e("h1",{className:"text-3xl font-bold mb-4",style:{fontSize:"3rem",marginBottom:"1.5rem"},children:"XL Formula"}),e("p",{className:"text-xl mb-8",style:{fontSize:"1.25rem",marginBottom:"2rem",opacity:.9},children:"High-performance Excel-like formula parser and evaluator for web applications"}),e("div",{className:"flex gap-4",style:{justifyContent:"center",flexWrap:"wrap"},children:[e(L,{href:`${z}playground`,className:"btn btn-primary",style:{background:"white",color:"#4f46e5",padding:"0.875rem 1.25rem",fontSize:"0.95rem",textDecoration:"none",marginBottom:"0.5rem",flex:"0 1 200px",minWidth:"140px",maxWidth:"220px"},children:"Try Playground"}),e(L,{href:`${z}docs`,className:"btn",style:{background:"rgba(255,255,255,0.1)",border:"1px solid rgba(255,255,255,0.3)",color:"white",padding:"0.875rem 1.25rem",fontSize:"0.95rem",textDecoration:"none",marginBottom:"0.5rem",flex:"0 1 200px",minWidth:"140px",maxWidth:"220px"},children:"Documentation"})]})]})}),e("section",{style:{padding:"4rem 0"},children:e("div",{className:"container",children:[e("h2",{className:"text-2xl font-bold mb-8",style:{textAlign:"center"},children:"Why XL Formula?"}),e("div",{className:"grid grid-cols-3 gap-8",children:[e("div",{className:"card",style:{textAlign:"center"},children:[e("div",{style:{width:"3rem",height:"3rem",background:"var(--color-primary-light)",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 1rem"},children:"⚡"}),e("h3",{className:"font-semibold mb-2",children:"Lightning Fast"}),e("p",{className:"text-muted",children:"Compiled to WebAssembly for near-native performance in the browser"})]}),e("div",{className:"card",style:{textAlign:"center"},children:[e("div",{style:{width:"3rem",height:"3rem",background:"var(--color-primary-light)",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 1rem"},children:"📊"}),e("h3",{className:"font-semibold mb-2",children:"Excel Compatible"}),e("p",{className:"text-muted",children:"Supports 100+ Excel functions with familiar syntax and behavior"})]}),e("div",{className:"card",style:{textAlign:"center"},children:[e("div",{style:{width:"3rem",height:"3rem",background:"var(--color-primary-light)",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 1rem"},children:"🔧"}),e("h3",{className:"font-semibold mb-2",children:"Easy Integration"}),e("p",{className:"text-muted",children:"Simple JavaScript API with TypeScript support and zero dependencies"})]})]})]})}),e("section",{style:{padding:"4rem 0",background:"var(--color-bg-secondary)"},children:e("div",{className:"container",children:[e("h2",{className:"text-2xl font-bold mb-8",style:{textAlign:"center"},children:"Quick Start"}),e("div",{className:"grid grid-cols-2 gap-8",children:[e("div",{children:[e("h3",{className:"font-semibold mb-4",children:"Installation"}),e("pre",{className:"p-4 rounded",style:{background:"var(--color-bg)",border:"1px solid var(--color-border)",fontFamily:"var(--font-mono)",fontSize:"0.875rem",overflowX:"auto"},children:e("code",{children:"npm install xl-formula-web"})})]}),e("div",{children:[e("h3",{className:"font-semibold mb-4",children:"Basic Usage"}),e("pre",{className:"p-4 rounded",style:{background:"var(--color-bg)",border:"1px solid var(--color-border)",fontFamily:"var(--font-mono)",fontSize:"0.875rem",overflowX:"auto"},children:e("code",{children:`import XLFormula from 'xl-formula-web'

await XLFormula.init()
const result = XLFormula.evaluate('SUM(1,2,3)')
if (result.isSuccess()) {
  console.log(result.getValue().asNumber()) // 6
}`})})]})]})]})})]})}const _={all:{name:"All Functions",description:"All available functions across all categories",functions:{}},math:{name:"Math",description:"Mathematical and statistical functions",functions:{SUM:{name:"SUM",description:"Adds all the numbers in a range of cells",syntax:"SUM(number1, [number2], ...)",parameters:[{name:"number1",description:"The first number to add",required:!0},{name:"number2",description:"Additional numbers to add",required:!1}],examples:[{formula:"SUM(1, 2, 3)",result:"6",description:"Simple addition"},{formula:"SUM(A1, B1, C1)",result:"15",description:"Sum of cells (A1=5, B1=4, C1=6)"}]},MAX:{name:"MAX",description:"Returns the largest value among the arguments",syntax:"MAX(number1, [number2], ...)",parameters:[{name:"number1",description:"The first number to compare",required:!0},{name:"number2",description:"Additional numbers to compare",required:!1}],examples:[{formula:"MAX(10, 20, 5)",result:"20",description:"Maximum of three numbers"},{formula:"MAX(A1:A5)",result:"25",description:"Maximum in range A1:A5"}]},MIN:{name:"MIN",description:"Returns the smallest value among the arguments",syntax:"MIN(number1, [number2], ...)",parameters:[{name:"number1",description:"The first number to compare",required:!0},{name:"number2",description:"Additional numbers to compare",required:!1}],examples:[{formula:"MIN(10, 20, 5)",result:"5",description:"Minimum of three numbers"},{formula:"MIN(A1:A5)",result:"2",description:"Minimum in range A1:A5"}]},AVERAGE:{name:"AVERAGE",description:"Returns the average (arithmetic mean) of the arguments",syntax:"AVERAGE(number1, [number2], ...)",parameters:[{name:"number1",description:"The first number to average",required:!0},{name:"number2",description:"Additional numbers to average",required:!1}],examples:[{formula:"AVERAGE(1, 2, 3, 4, 5)",result:"3",description:"Average of five numbers"},{formula:"AVERAGE(A1:A10)",result:"7.5",description:"Average of range A1:A10"}]},ROUND:{name:"ROUND",description:"Rounds a number to a specified number of digits",syntax:"ROUND(number, num_digits)",parameters:[{name:"number",description:"The number to round",required:!0},{name:"num_digits",description:"The number of digits to round to",required:!0}],examples:[{formula:"ROUND(3.14159, 2)",result:"3.14",description:"Round to 2 decimal places"},{formula:"ROUND(1234.5, -2)",result:"1200",description:"Round to nearest hundred"}]},ABS:{name:"ABS",description:"Returns the absolute value of a number",syntax:"ABS(number)",parameters:[{name:"number",description:"The number to get absolute value of",required:!0}],examples:[{formula:"ABS(-5)",result:"5",description:"Absolute value of negative number"},{formula:"ABS(3.14)",result:"3.14",description:"Absolute value of positive number"}]},SQRT:{name:"SQRT",description:"Returns the square root of a number",syntax:"SQRT(number)",parameters:[{name:"number",description:"The number to get square root of",required:!0}],examples:[{formula:"SQRT(16)",result:"4",description:"Square root of 16"},{formula:"SQRT(2)",result:"1.414",description:"Square root of 2"}]},POWER:{name:"POWER",description:"Returns a number raised to a power",syntax:"POWER(number, power)",parameters:[{name:"number",description:"The base number",required:!0},{name:"power",description:"The exponent",required:!0}],examples:[{formula:"POWER(2, 3)",result:"8",description:"2 to the power of 3"},{formula:"POWER(9, 0.5)",result:"3",description:"Square root using power"}]},PI:{name:"PI",description:"Returns the value of pi (π)",syntax:"PI()",parameters:[],examples:[{formula:"PI()",result:"3.14159",description:"Value of pi"},{formula:"PI() * 2",result:"6.28318",description:"Two times pi"}]},SIN:{name:"SIN",description:"Returns the sine of an angle (in radians)",syntax:"SIN(angle)",parameters:[{name:"angle",description:"The angle in radians",required:!0}],examples:[{formula:"SIN(PI()/2)",result:"1",description:"Sine of 90 degrees (π/2 radians)"},{formula:"SIN(0)",result:"0",description:"Sine of 0 radians"}]},COS:{name:"COS",description:"Returns the cosine of an angle (in radians)",syntax:"COS(angle)",parameters:[{name:"angle",description:"The angle in radians",required:!0}],examples:[{formula:"COS(0)",result:"1",description:"Cosine of 0 radians"},{formula:"COS(PI())",result:"-1",description:"Cosine of π radians"}]},TAN:{name:"TAN",description:"Returns the tangent of an angle (in radians)",syntax:"TAN(angle)",parameters:[{name:"angle",description:"The angle in radians",required:!0}],examples:[{formula:"TAN(PI()/4)",result:"1",description:"Tangent of 45 degrees (π/4 radians)"},{formula:"TAN(0)",result:"0",description:"Tangent of 0 radians"}]},LN:{name:"LN",description:"Returns the natural logarithm of a number",syntax:"LN(number)",parameters:[{name:"number",description:"The number to get natural log of",required:!0}],examples:[{formula:"LN(EXP(1))",result:"1",description:"Natural log of e"},{formula:"LN(10)",result:"2.303",description:"Natural log of 10"}]},LOG:{name:"LOG",description:"Returns the logarithm of a number to a specified base",syntax:"LOG(number, [base])",parameters:[{name:"number",description:"The number to get logarithm of",required:!0},{name:"base",description:"The base (default: 10)",required:!1}],examples:[{formula:"LOG(100)",result:"2",description:"Base 10 log of 100"},{formula:"LOG(8, 2)",result:"3",description:"Base 2 log of 8"}]},EXP:{name:"EXP",description:"Returns e raised to the power of a number",syntax:"EXP(number)",parameters:[{name:"number",description:"The exponent",required:!0}],examples:[{formula:"EXP(1)",result:"2.718",description:"e to the power of 1"},{formula:"EXP(0)",result:"1",description:"e to the power of 0"}]},FACT:{name:"FACT",description:"Returns the factorial of a number",syntax:"FACT(number)",parameters:[{name:"number",description:"The number to get factorial of",required:!0}],examples:[{formula:"FACT(5)",result:"120",description:"Factorial of 5 (5! = 5×4×3×2×1)"},{formula:"FACT(0)",result:"1",description:"Factorial of 0"}]},CEILING:{name:"CEILING",description:"Rounds a number up to the nearest multiple of significance",syntax:"CEILING(number, [significance])",parameters:[{name:"number",description:"The number to round up",required:!0},{name:"significance",description:"The multiple to round up to",required:!1}],examples:[{formula:"CEILING(4.3)",result:"5",description:"Round up to nearest integer"},{formula:"CEILING(4.3, 0.5)",result:"4.5",description:"Round up to nearest 0.5"}]},FLOOR:{name:"FLOOR",description:"Rounds a number down to the nearest multiple of significance",syntax:"FLOOR(number, [significance])",parameters:[{name:"number",description:"The number to round down",required:!0},{name:"significance",description:"The multiple to round down to",required:!1}],examples:[{formula:"FLOOR(4.7)",result:"4",description:"Round down to nearest integer"},{formula:"FLOOR(4.7, 0.5)",result:"4.5",description:"Round down to nearest 0.5"}]},MOD:{name:"MOD",description:"Returns the remainder after division",syntax:"MOD(number, divisor)",parameters:[{name:"number",description:"The number to divide",required:!0},{name:"divisor",description:"The divisor",required:!0}],examples:[{formula:"MOD(10, 3)",result:"1",description:"Remainder of 10 divided by 3"},{formula:"MOD(15, 4)",result:"3",description:"Remainder of 15 divided by 4"}]},GCD:{name:"GCD",description:"Returns the greatest common divisor of two or more numbers",syntax:"GCD(number1, [number2], ...)",parameters:[{name:"number1",description:"First number",required:!0},{name:"number2",description:"Additional numbers",required:!1}],examples:[{formula:"GCD(12, 18)",result:"6",description:"GCD of 12 and 18"},{formula:"GCD(24, 36, 48)",result:"12",description:"GCD of multiple numbers"}]},LCM:{name:"LCM",description:"Returns the least common multiple of two or more numbers",syntax:"LCM(number1, [number2], ...)",parameters:[{name:"number1",description:"First number",required:!0},{name:"number2",description:"Additional numbers",required:!1}],examples:[{formula:"LCM(4, 6)",result:"12",description:"LCM of 4 and 6"},{formula:"LCM(3, 4, 5)",result:"60",description:"LCM of multiple numbers"}]},COUNT:{name:"COUNT",description:"Counts the number of numeric values in a range",syntax:"COUNT(value1, [value2], ...)",parameters:[{name:"value1",description:"First value or range to count",required:!0},{name:"value2",description:"Additional values to count",required:!1}],examples:[{formula:'COUNT(1, 2, 3, "text")',result:"3",description:"Count numeric values only"},{formula:"COUNT(A1:A10)",result:"8",description:"Count numbers in range"}]},MEDIAN:{name:"MEDIAN",description:"Returns the median (middle value) of a set of numbers",syntax:"MEDIAN(number1, [number2], ...)",parameters:[{name:"number1",description:"First number or range",required:!0},{name:"number2",description:"Additional numbers",required:!1}],examples:[{formula:"MEDIAN(1, 2, 3, 4, 5)",result:"3",description:"Median of odd count"},{formula:"MEDIAN(1, 2, 3, 4)",result:"2.5",description:"Median of even count"}]},MODE:{name:"MODE",description:"Returns the most frequently occurring value in a set",syntax:"MODE(number1, [number2], ...)",parameters:[{name:"number1",description:"First number or range",required:!0},{name:"number2",description:"Additional numbers",required:!1}],examples:[{formula:"MODE(1, 2, 2, 3, 4)",result:"2",description:"Most frequent value"},{formula:"MODE(A1:A10)",result:"5",description:"Mode of range"}]},STDEV:{name:"STDEV",description:"Returns the standard deviation of a sample",syntax:"STDEV(number1, [number2], ...)",parameters:[{name:"number1",description:"First number or range",required:!0},{name:"number2",description:"Additional numbers",required:!1}],examples:[{formula:"STDEV(1, 2, 3, 4, 5)",result:"1.58",description:"Standard deviation of sample"},{formula:"STDEV(A1:A10)",result:"2.87",description:"Standard deviation of range"}]},VAR:{name:"VAR",description:"Returns the variance of a sample",syntax:"VAR(number1, [number2], ...)",parameters:[{name:"number1",description:"First number or range",required:!0},{name:"number2",description:"Additional numbers",required:!1}],examples:[{formula:"VAR(1, 2, 3, 4, 5)",result:"2.5",description:"Variance of sample"},{formula:"VAR(A1:A10)",result:"8.22",description:"Variance of range"}]},RAND:{name:"RAND",description:"Returns a random number between 0 and 1",syntax:"RAND()",parameters:[],examples:[{formula:"RAND()",result:"0.7234",description:"Random decimal between 0 and 1"},{formula:"RAND() * 100",result:"72.34",description:"Random number between 0 and 100"}]},RANDBETWEEN:{name:"RANDBETWEEN",description:"Returns a random integer between two specified numbers",syntax:"RANDBETWEEN(bottom, top)",parameters:[{name:"bottom",description:"The lowest integer to return",required:!0},{name:"top",description:"The highest integer to return",required:!0}],examples:[{formula:"RANDBETWEEN(1, 10)",result:"7",description:"Random integer between 1 and 10"},{formula:"RANDBETWEEN(-5, 5)",result:"-2",description:"Random integer between -5 and 5"}]},SUMSQ:{name:"SUMSQ",description:"Returns the sum of the squares of the arguments",syntax:"SUMSQ(number1, [number2], ...)",parameters:[{name:"number1",description:"The first number to square and sum",required:!0},{name:"number2",description:"Additional numbers to square and sum",required:!1}],examples:[{formula:"SUMSQ(2, 3, 4)",result:"29",description:"2² + 3² + 4² = 4 + 9 + 16 = 29"},{formula:"SUMSQ(1, -2, 3)",result:"14",description:"1² + (-2)² + 3² = 1 + 4 + 9 = 14"}]},QUOTIENT:{name:"QUOTIENT",description:"Returns the integer portion of a division",syntax:"QUOTIENT(numerator, denominator)",parameters:[{name:"numerator",description:"The dividend",required:!0},{name:"denominator",description:"The divisor",required:!0}],examples:[{formula:"QUOTIENT(10, 3)",result:"3",description:"10 ÷ 3 = 3.33..., truncated to 3"},{formula:"QUOTIENT(-10, 3)",result:"-3",description:"Truncates toward zero"}]},EVEN:{name:"EVEN",description:"Rounds a number up to the nearest even integer",syntax:"EVEN(number)",parameters:[{name:"number",description:"The value to round to the nearest even integer",required:!0}],examples:[{formula:"EVEN(1.5)",result:"2",description:"Rounds up to next even integer"},{formula:"EVEN(-1)",result:"-2",description:"Rounds away from zero to even"}]},ODD:{name:"ODD",description:"Rounds a number up to the nearest odd integer",syntax:"ODD(number)",parameters:[{name:"number",description:"The value to round to the nearest odd integer",required:!0}],examples:[{formula:"ODD(2)",result:"3",description:"Rounds up to next odd integer"},{formula:"ODD(0)",result:"1",description:"Zero rounds to 1"}]},MROUND:{name:"MROUND",description:"Rounds a number to the nearest multiple",syntax:"MROUND(number, multiple)",parameters:[{name:"number",description:"The value to round",required:!0},{name:"multiple",description:"The multiple to which to round",required:!0}],examples:[{formula:"MROUND(10, 3)",result:"9",description:"Nearest multiple of 3 to 10"},{formula:"MROUND(1.3, 0.2)",result:"1.4",description:"Nearest multiple of 0.2 to 1.3"}]},ROUNDUP:{name:"ROUNDUP",description:"Rounds a number up, away from zero",syntax:"ROUNDUP(number, num_digits)",parameters:[{name:"number",description:"The number to round up",required:!0},{name:"num_digits",description:"The number of digits to which to round",required:!0}],examples:[{formula:"ROUNDUP(3.2, 0)",result:"4",description:"Always rounds away from zero"},{formula:"ROUNDUP(-3.2, 0)",result:"-4",description:"Away from zero means more negative"}]},ROUNDDOWN:{name:"ROUNDDOWN",description:"Rounds a number down, toward zero",syntax:"ROUNDDOWN(number, num_digits)",parameters:[{name:"number",description:"The number to round down",required:!0},{name:"num_digits",description:"The number of digits to which to round",required:!0}],examples:[{formula:"ROUNDDOWN(3.9, 0)",result:"3",description:"Always rounds toward zero"},{formula:"ROUNDDOWN(-3.9, 0)",result:"-3",description:"Toward zero means less negative"}]}}},text:{name:"Text",description:"Text manipulation and formatting functions",functions:{CONCATENATE:{name:"CONCATENATE",description:"Joins two or more text strings into one string",syntax:"CONCATENATE(text1, [text2], ...)",parameters:[{name:"text1",description:"The first text string",required:!0},{name:"text2",description:"Additional text strings",required:!1}],examples:[{formula:'CONCATENATE("Hello", " ", "World")',result:'"Hello World"',description:"Join three strings"},{formula:'CONCATENATE(A1, " - ", B1)',result:'"Name - Value"',description:"Join cell values with separator"}]},LEN:{name:"LEN",description:"Returns the number of characters in a text string",syntax:"LEN(text)",parameters:[{name:"text",description:"The text string to measure",required:!0}],examples:[{formula:'LEN("Hello")',result:"5",description:"Length of text string"},{formula:"LEN(A1)",result:"12",description:"Length of text in cell A1"}]},UPPER:{name:"UPPER",description:"Converts text to uppercase",syntax:"UPPER(text)",parameters:[{name:"text",description:"The text to convert to uppercase",required:!0}],examples:[{formula:'UPPER("hello world")',result:'"HELLO WORLD"',description:"Convert to uppercase"},{formula:"UPPER(A1)",result:'"EXCEL FORMULA"',description:"Convert cell value to uppercase"}]},LOWER:{name:"LOWER",description:"Converts text to lowercase",syntax:"LOWER(text)",parameters:[{name:"text",description:"The text to convert to lowercase",required:!0}],examples:[{formula:'LOWER("HELLO WORLD")',result:'"hello world"',description:"Convert to lowercase"},{formula:"LOWER(A1)",result:'"excel formula"',description:"Convert cell value to lowercase"}]}}},logical:{name:"Logical",description:"Logical and conditional functions",functions:{IF:{name:"IF",description:"Returns one value if condition is TRUE, another if FALSE",syntax:"IF(logical_test, value_if_true, value_if_false)",parameters:[{name:"logical_test",description:"The condition to test",required:!0},{name:"value_if_true",description:"Value to return if condition is TRUE",required:!0},{name:"value_if_false",description:"Value to return if condition is FALSE",required:!0}],examples:[{formula:'IF(5 > 3, "Yes", "No")',result:'"Yes"',description:"Simple condition test"},{formula:'IF(A1 > 100, "High", "Low")',result:'"High"',description:"Compare cell value"}]},AND:{name:"AND",description:"Returns TRUE if all arguments are TRUE",syntax:"AND(logical1, [logical2], ...)",parameters:[{name:"logical1",description:"The first logical value",required:!0},{name:"logical2",description:"Additional logical values",required:!1}],examples:[{formula:"AND(5 > 3, 10 < 20)",result:"TRUE",description:"Both conditions are true"},{formula:"AND(A1 > 0, B1 < 100)",result:"FALSE",description:"At least one condition is false"}]},OR:{name:"OR",description:"Returns TRUE if any argument is TRUE",syntax:"OR(logical1, [logical2], ...)",parameters:[{name:"logical1",description:"The first logical value",required:!0},{name:"logical2",description:"Additional logical values",required:!1}],examples:[{formula:"OR(5 > 10, 3 < 5)",result:"TRUE",description:"One condition is true"},{formula:"OR(A1 < 0, B1 > 100)",result:"FALSE",description:"Both conditions are false"}]},SWITCH:{name:"SWITCH",description:"Compares an expression against multiple values and returns corresponding result",syntax:"SWITCH(expression, value1, result1, [value2, result2, ...], [default])",parameters:[{name:"expression",description:"The value to compare against",required:!0},{name:"value1",description:"First value to compare with expression",required:!0},{name:"result1",description:"Result to return if value1 matches",required:!0},{name:"value2",description:"Additional values to compare (optional)",required:!1},{name:"result2",description:"Additional results (optional)",required:!1},{name:"default",description:"Default value if no match found (optional)",required:!1}],examples:[{formula:'SWITCH(2, 1, "One", 2, "Two", 3, "Three")',result:'"Two"',description:"Match found for value 2"},{formula:'SWITCH(4, 1, "One", 2, "Two", "Default")',result:'"Default"',description:"No match, return default"}]},IFS:{name:"IFS",description:"Checks multiple conditions and returns result for first TRUE condition",syntax:"IFS(condition1, result1, [condition2, result2, ...])",parameters:[{name:"condition1",description:"First logical condition to test",required:!0},{name:"result1",description:"Result to return if condition1 is TRUE",required:!0},{name:"condition2",description:"Additional conditions to test (optional)",required:!1},{name:"result2",description:"Additional results (optional)",required:!1}],examples:[{formula:'IFS(FALSE, "First", TRUE, "Second")',result:'"Second"',description:"First TRUE condition wins"},{formula:'IFS(0, "Zero", 1, "One")',result:'"One"',description:"Number conditions: 0=FALSE, 1=TRUE"}]}}},text:{name:"Text",description:"Text manipulation and formatting functions",functions:{CONCATENATE:{name:"CONCATENATE",description:"Joins several text strings into one text string",syntax:"CONCATENATE(text1, [text2], ...)",parameters:[{name:"text1",description:"The first text string to join",required:!0},{name:"text2",description:"Additional text strings to join",required:!1}],examples:[{formula:'CONCATENATE("Hello", " ", "World")',result:'"Hello World"',description:"Join text strings"},{formula:'CONCATENATE(A1, " - ", B1)',result:'"John - Doe"',description:"Join cells with separator"}]},LEFT:{name:"LEFT",description:"Returns the leftmost characters from a text string",syntax:"LEFT(text, [num_chars])",parameters:[{name:"text",description:"The text string from which to extract characters",required:!0},{name:"num_chars",description:"Number of characters to extract (default: 1)",required:!1}],examples:[{formula:'LEFT("Hello", 2)',result:'"He"',description:"Get first 2 characters"},{formula:"LEFT(A1)",result:'"H"',description:"Get first character"}]},RIGHT:{name:"RIGHT",description:"Returns the rightmost characters from a text string",syntax:"RIGHT(text, [num_chars])",parameters:[{name:"text",description:"The text string from which to extract characters",required:!0},{name:"num_chars",description:"Number of characters to extract (default: 1)",required:!1}],examples:[{formula:'RIGHT("Hello", 2)',result:'"lo"',description:"Get last 2 characters"},{formula:"RIGHT(A1)",result:'"o"',description:"Get last character"}]},MID:{name:"MID",description:"Returns characters from the middle of a text string",syntax:"MID(text, start_num, num_chars)",parameters:[{name:"text",description:"The text string from which to extract characters",required:!0},{name:"start_num",description:"Position of the first character to extract",required:!0},{name:"num_chars",description:"Number of characters to extract",required:!0}],examples:[{formula:'MID("Hello World", 7, 5)',result:'"World"',description:"Extract characters from position 7"},{formula:"MID(A1, 2, 3)",result:'"ell"',description:"Extract 3 chars starting at position 2"}]},LEN:{name:"LEN",description:"Returns the number of characters in a text string",syntax:"LEN(text)",parameters:[{name:"text",description:"The text string to measure",required:!0}],examples:[{formula:'LEN("Hello")',result:"5",description:"Length of text string"},{formula:"LEN(A1)",result:"10",description:"Length of cell content"}]},UPPER:{name:"UPPER",description:"Converts text to uppercase",syntax:"UPPER(text)",parameters:[{name:"text",description:"The text to convert to uppercase",required:!0}],examples:[{formula:'UPPER("hello")',result:'"HELLO"',description:"Convert to uppercase"},{formula:"UPPER(A1)",result:'"WORLD"',description:"Convert cell content to uppercase"}]},LOWER:{name:"LOWER",description:"Converts text to lowercase",syntax:"LOWER(text)",parameters:[{name:"text",description:"The text to convert to lowercase",required:!0}],examples:[{formula:'LOWER("HELLO")',result:'"hello"',description:"Convert to lowercase"},{formula:"LOWER(A1)",result:'"world"',description:"Convert cell content to lowercase"}]},RPT:{name:"RPT",description:"Repeats text a specified number of times",syntax:"RPT(text, repeat_count)",parameters:[{name:"text",description:"The text string to repeat",required:!0},{name:"repeat_count",description:"The number of times to repeat the text",required:!0}],examples:[{formula:'RPT("abc", 3)',result:'"abcabcabc"',description:"Repeat text three times"},{formula:'RPT("x", 5)',result:'"xxxxx"',description:"Repeat single character five times"}]},PROPER:{name:"PROPER",description:"Capitalizes the first letter of each word in text",syntax:"PROPER(text)",parameters:[{name:"text",description:"The text to convert to proper case",required:!0}],examples:[{formula:'PROPER("hello world")',result:'"Hello World"',description:"Convert to proper case"},{formula:"PROPER(A1)",result:'"John Doe"',description:"Convert cell content to proper case"}]},TRIM:{name:"TRIM",description:"Removes extra spaces from text",syntax:"TRIM(text)",parameters:[{name:"text",description:"The text from which to remove spaces",required:!0}],examples:[{formula:'TRIM("  Hello  World  ")',result:'"Hello World"',description:"Remove extra spaces"},{formula:"TRIM(A1)",result:'"Clean Text"',description:"Clean up cell content"}]},FIND:{name:"FIND",description:"Finds one text string within another (case-sensitive)",syntax:"FIND(find_text, within_text, [start_num])",parameters:[{name:"find_text",description:"The text to find",required:!0},{name:"within_text",description:"The text in which to search",required:!0},{name:"start_num",description:"Position to start searching from",required:!1}],examples:[{formula:'FIND("lo", "Hello")',result:"4",description:'Find position of "lo" in "Hello"'},{formula:'FIND("o", "Hello", 5)',result:"5",description:'Find "o" starting from position 5'}]},SEARCH:{name:"SEARCH",description:"Finds one text string within another (case-insensitive)",syntax:"SEARCH(find_text, within_text, [start_num])",parameters:[{name:"find_text",description:"The text to find",required:!0},{name:"within_text",description:"The text in which to search",required:!0},{name:"start_num",description:"Position to start searching from",required:!1}],examples:[{formula:'SEARCH("LO", "Hello")',result:"4",description:'Case-insensitive search for "LO"'},{formula:'SEARCH("world", "Hello World")',result:"7",description:"Find position case-insensitively"}]},REPLACE:{name:"REPLACE",description:"Replaces characters within text based on position",syntax:"REPLACE(old_text, start_num, num_chars, new_text)",parameters:[{name:"old_text",description:"The original text",required:!0},{name:"start_num",description:"Position to start replacing",required:!0},{name:"num_chars",description:"Number of characters to replace",required:!0},{name:"new_text",description:"The replacement text",required:!0}],examples:[{formula:'REPLACE("Hello", 2, 2, "i")',result:'"Hilo"',description:'Replace "el" with "i"'},{formula:'REPLACE(A1, 1, 3, "New")',result:'"NewValue"',description:"Replace first 3 characters"}]},SUBSTITUTE:{name:"SUBSTITUTE",description:"Substitutes new text for old text in a string",syntax:"SUBSTITUTE(text, old_text, new_text, [instance_num])",parameters:[{name:"text",description:"The original text",required:!0},{name:"old_text",description:"The text to replace",required:!0},{name:"new_text",description:"The replacement text",required:!0},{name:"instance_num",description:"Which instance to replace (optional)",required:!1}],examples:[{formula:'SUBSTITUTE("Hello Hello", "Hello", "Hi")',result:'"Hi Hi"',description:"Replace all instances"},{formula:'SUBSTITUTE("a,b,c", ",", ";")',result:'"a;b;c"',description:"Replace commas with semicolons"}]},TEXT:{name:"TEXT",description:"Formats a number as text according to a specified format",syntax:"TEXT(value, format_text)",parameters:[{name:"value",description:"The number to format",required:!0},{name:"format_text",description:"The format to apply",required:!0}],examples:[{formula:'TEXT(123.45, "0.00")',result:'"123.45"',description:"Format with 2 decimal places"},{formula:'TEXT(0.75, "0%")',result:'"75%"',description:"Format as percentage"}]},CHAR:{name:"CHAR",description:"Returns the character specified by a code number (1-255)",syntax:"CHAR(number)",parameters:[{name:"number",description:"Code number between 1 and 255",required:!0}],examples:[{formula:"CHAR(65)",result:'"A"',description:"Character for code 65"},{formula:"CHAR(10)",result:`"
"`,description:"Line feed character"}]},CODE:{name:"CODE",description:"Returns a numeric code for the first character in a text string",syntax:"CODE(text)",parameters:[{name:"text",description:"The text to examine",required:!0}],examples:[{formula:'CODE("A")',result:"65",description:"Code for letter A"},{formula:'CODE("!Hello")',result:"33",description:"Code for first character !"}]},CLEAN:{name:"CLEAN",description:"Removes all nonprintable characters from text (ASCII codes < 32)",syntax:"CLEAN(text)",parameters:[{name:"text",description:"The text from which to remove nonprintable characters",required:!0}],examples:[{formula:`CLEAN("Hello
World")`,result:'"HelloWorld"',description:"Removes line feed"},{formula:'CLEAN(CHAR(9) & "Tab")',result:'"Tab"',description:"Removes tab"}]},EXACT:{name:"EXACT",description:"Checks whether two text strings are exactly the same (case-sensitive)",syntax:"EXACT(text1, text2)",parameters:[{name:"text1",description:"First text string",required:!0},{name:"text2",description:"Second text string",required:!0}],examples:[{formula:'EXACT("Hello", "Hello")',result:"TRUE",description:"Strings match exactly"},{formula:'EXACT("Hello", "hello")',result:"FALSE",description:"Case-sensitive comparison"}]},VALUE:{name:"VALUE",description:"Converts text that represents a number to a number",syntax:"VALUE(text)",parameters:[{name:"text",description:"The text to convert to a number",required:!0}],examples:[{formula:'VALUE("123")',result:"123",description:"Convert text to number"},{formula:'VALUE("$1,000.00")',result:"1000",description:"Convert formatted text to number"}]},CONCAT:{name:"CONCAT",description:"Joins text strings (alias for CONCATENATE)",syntax:"CONCAT(text1, [text2], ...)",parameters:[{name:"text1",description:"The first text string",required:!0},{name:"text2",description:"Additional text strings",required:!1}],examples:[{formula:'CONCAT("Hello", " ", "World")',result:'"Hello World"',description:"Join three strings"},{formula:"CONCAT(A1, B1)",result:'"JohnDoe"',description:"Join cell values directly"}]},T:{name:"T",description:"Returns text if the argument is text, otherwise returns empty string",syntax:"T(value)",parameters:[{name:"value",description:"The value to test",required:!0}],examples:[{formula:'T("Hello")',result:'"Hello"',description:"Text input returns text"},{formula:"T(123)",result:'""',description:"Number input returns empty string"}]},TEXTJOIN:{name:"TEXTJOIN",description:"Joins text values with a delimiter",syntax:"TEXTJOIN(delimiter, ignore_empty, text1, [text2], ...)",parameters:[{name:"delimiter",description:"Text to use as separator",required:!0},{name:"ignore_empty",description:"TRUE to ignore empty values, FALSE to include them",required:!0},{name:"text1",description:"First text value to join",required:!0},{name:"text2",description:"Additional text values to join",required:!1}],examples:[{formula:'TEXTJOIN(",", TRUE, "A", "", "B", "C")',result:'"A,B,C"',description:"Join with comma, ignore empty"},{formula:'TEXTJOIN(" ", FALSE, "Hello", "", "World")',result:'"Hello  World"',description:"Join with space, include empty"}]},UNICHAR:{name:"UNICHAR",description:"Returns the Unicode character for a given code point",syntax:"UNICHAR(number)",parameters:[{name:"number",description:"Unicode code point (1 to 1114111)",required:!0}],examples:[{formula:"UNICHAR(65)",result:'"A"',description:'ASCII code 65 is "A"'},{formula:"UNICHAR(128512)",result:'"😀"',description:"Unicode emoji character"}]},UNICODE:{name:"UNICODE",description:"Returns the Unicode code point of the first character in text",syntax:"UNICODE(text)",parameters:[{name:"text",description:"The text containing the character",required:!0}],examples:[{formula:'UNICODE("A")',result:"65",description:'Unicode code for "A"'},{formula:'UNICODE("😀")',result:"128512",description:"Unicode code for emoji"}]}}},financial:{name:"Financial",description:"Financial calculation functions",functions:{FV:{name:"FV",description:"Returns the future value of an investment",syntax:"FV(rate, nper, pmt, [pv], [type])",parameters:[{name:"rate",description:"Interest rate per period",required:!0},{name:"nper",description:"Number of payment periods",required:!0},{name:"pmt",description:"Payment made each period",required:!0},{name:"pv",description:"Present value (default: 0)",required:!1},{name:"type",description:"Payment timing (0=end, 1=beginning)",required:!1}],examples:[{formula:"FV(0.05, 10, -100, 0, 0)",result:"1257.79",description:"Future value of annuity"},{formula:"FV(0.06/12, 24, -200)",result:"5141.85",description:"Monthly payments future value"}]},PV:{name:"PV",description:"Returns the present value of an investment",syntax:"PV(rate, nper, pmt, [fv], [type])",parameters:[{name:"rate",description:"Interest rate per period",required:!0},{name:"nper",description:"Number of payment periods",required:!0},{name:"pmt",description:"Payment made each period",required:!0},{name:"fv",description:"Future value (default: 0)",required:!1},{name:"type",description:"Payment timing (0=end, 1=beginning)",required:!1}],examples:[{formula:"PV(0.08, 10, -100, 0, 0)",result:"671.01",description:"Present value of annuity"},{formula:"PV(0.05/12, 60, -300)",result:"15761.86",description:"Present value of loan"}]},PMT:{name:"PMT",description:"Returns the periodic payment for an annuity",syntax:"PMT(rate, nper, pv, [fv], [type])",parameters:[{name:"rate",description:"Interest rate per period",required:!0},{name:"nper",description:"Number of payment periods",required:!0},{name:"pv",description:"Present value",required:!0},{name:"fv",description:"Future value (default: 0)",required:!1},{name:"type",description:"Payment timing (0=end, 1=beginning)",required:!1}],examples:[{formula:"PMT(0.05, 10, 1000)",result:"-129.50",description:"Payment for loan"},{formula:"PMT(0.06/12, 360, 200000)",result:"-1199.10",description:"Monthly mortgage payment"}]},NPV:{name:"NPV",description:"Returns the net present value of an investment",syntax:"NPV(rate, value1, [value2], ...)",parameters:[{name:"rate",description:"Discount rate per period",required:!0},{name:"value1",description:"First cash flow value",required:!0},{name:"value2",description:"Additional cash flow values",required:!1}],examples:[{formula:"NPV(0.1, -1000, 300, 400, 500)",result:"18.78",description:"NPV of cash flows"},{formula:"NPV(0.08, -5000, 1200, 1500, 2000, 2500)",result:"447.33",description:"Investment NPV"}]},IRR:{name:"IRR",description:"Returns the internal rate of return for cash flows",syntax:"IRR(values, [guess])",parameters:[{name:"values",description:"Array of cash flow values",required:!0},{name:"guess",description:"Initial guess for IRR (default: 0.1)",required:!1}],examples:[{formula:"IRR([-1000, 300, 400, 500])",result:"0.1296",description:"IRR of cash flows"},{formula:"IRR([-5000, 1200, 1500, 2000, 2500])",result:"0.0899",description:"Investment IRR"}]},MIRR:{name:"MIRR",description:"Returns the modified internal rate of return",syntax:"MIRR(values, finance_rate, reinvest_rate)",parameters:[{name:"values",description:"Array of cash flow values",required:!0},{name:"finance_rate",description:"Interest rate for financing costs",required:!0},{name:"reinvest_rate",description:"Interest rate for reinvestment",required:!0}],examples:[{formula:"MIRR([-1000, 300, 400, 500], 0.1, 0.12)",result:"0.1342",description:"MIRR with different rates"},{formula:"MIRR([-5000, 1200, 1500, 2000], 0.08, 0.10)",result:"0.0918",description:"Modified IRR"}]},NPER:{name:"NPER",description:"Returns the number of periods for an investment",syntax:"NPER(rate, pmt, pv, [fv], [type])",parameters:[{name:"rate",description:"Interest rate per period",required:!0},{name:"pmt",description:"Payment made each period",required:!0},{name:"pv",description:"Present value",required:!0},{name:"fv",description:"Future value (default: 0)",required:!1},{name:"type",description:"Payment timing (0=end, 1=beginning)",required:!1}],examples:[{formula:"NPER(0.05, -100, 1000)",result:"14.21",description:"Periods to pay off loan"},{formula:"NPER(0.06/12, -500, 25000)",result:"58.21",description:"Months to pay off loan"}]},RATE:{name:"RATE",description:"Returns the interest rate per period of an annuity",syntax:"RATE(nper, pmt, pv, [fv], [type], [guess])",parameters:[{name:"nper",description:"Number of payment periods",required:!0},{name:"pmt",description:"Payment made each period",required:!0},{name:"pv",description:"Present value",required:!0},{name:"fv",description:"Future value (default: 0)",required:!1},{name:"type",description:"Payment timing (0=end, 1=beginning)",required:!1},{name:"guess",description:"Initial guess for rate",required:!1}],examples:[{formula:"RATE(10, -100, 1000)",result:"0.0507",description:"Interest rate for loan"},{formula:"RATE(360, -1200, 200000)",result:"0.005",description:"Monthly mortgage rate"}]}}},engineering:{name:"Engineering",description:"Engineering and conversion functions",functions:{BIN2DEC:{name:"BIN2DEC",description:"Converts a binary number to decimal",syntax:"BIN2DEC(number)",parameters:[{name:"number",description:"The binary number to convert",required:!0}],examples:[{formula:'BIN2DEC("1010")',result:"10",description:"Convert binary to decimal"},{formula:'BIN2DEC("11111111")',result:"255",description:"Convert 8-bit binary"}]},DEC2BIN:{name:"DEC2BIN",description:"Converts a decimal number to binary",syntax:"DEC2BIN(number, [places])",parameters:[{name:"number",description:"The decimal number to convert",required:!0},{name:"places",description:"Number of characters to use",required:!1}],examples:[{formula:"DEC2BIN(10)",result:'"1010"',description:"Convert decimal to binary"},{formula:"DEC2BIN(10, 8)",result:'"00001010"',description:"Convert with padding"}]},DEC2HEX:{name:"DEC2HEX",description:"Converts a decimal number to hexadecimal",syntax:"DEC2HEX(number, [places])",parameters:[{name:"number",description:"The decimal number to convert",required:!0},{name:"places",description:"Number of characters to use",required:!1}],examples:[{formula:"DEC2HEX(255)",result:'"FF"',description:"Convert decimal to hex"},{formula:"DEC2HEX(10, 4)",result:'"000A"',description:"Convert with padding"}]},HEX2DEC:{name:"HEX2DEC",description:"Converts a hexadecimal number to decimal",syntax:"HEX2DEC(number)",parameters:[{name:"number",description:"The hexadecimal number to convert",required:!0}],examples:[{formula:'HEX2DEC("FF")',result:"255",description:"Convert hex to decimal"},{formula:'HEX2DEC("A0")',result:"160",description:"Convert hex with letters"}]},BITAND:{name:"BITAND",description:"Returns a bitwise AND of two numbers",syntax:"BITAND(number1, number2)",parameters:[{name:"number1",description:"First number for AND operation",required:!0},{name:"number2",description:"Second number for AND operation",required:!0}],examples:[{formula:"BITAND(5, 3)",result:"1",description:"Bitwise AND of 5 and 3"},{formula:"BITAND(255, 15)",result:"15",description:"Mask lower 4 bits"}]},BITOR:{name:"BITOR",description:"Returns a bitwise OR of two numbers",syntax:"BITOR(number1, number2)",parameters:[{name:"number1",description:"First number for OR operation",required:!0},{name:"number2",description:"Second number for OR operation",required:!0}],examples:[{formula:"BITOR(5, 3)",result:"7",description:"Bitwise OR of 5 and 3"},{formula:"BITOR(1, 2)",result:"3",description:"Combine bit flags"}]},BITXOR:{name:"BITXOR",description:"Returns a bitwise XOR of two numbers",syntax:"BITXOR(number1, number2)",parameters:[{name:"number1",description:"First number for XOR operation",required:!0},{name:"number2",description:"Second number for XOR operation",required:!0}],examples:[{formula:"BITXOR(5, 3)",result:"6",description:"Bitwise XOR of 5 and 3"},{formula:"BITXOR(15, 15)",result:"0",description:"XOR same numbers"}]},CONVERT:{name:"CONVERT",description:"Converts a number from one measurement system to another",syntax:"CONVERT(number, from_unit, to_unit)",parameters:[{name:"number",description:"The value to convert",required:!0},{name:"from_unit",description:"The unit to convert from",required:!0},{name:"to_unit",description:"The unit to convert to",required:!0}],examples:[{formula:'CONVERT(32, "F", "C")',result:"0",description:"Fahrenheit to Celsius"},{formula:'CONVERT(1, "m", "ft")',result:"3.28084",description:"Meters to feet"}]},DEC2OCT:{name:"DEC2OCT",description:"Converts a decimal number to octal",syntax:"DEC2OCT(number, [places])",parameters:[{name:"number",description:"The decimal number to convert",required:!0},{name:"places",description:"Number of characters to use (for padding)",required:!1}],examples:[{formula:"DEC2OCT(8)",result:'"10"',description:"8 decimal = 10 octal"},{formula:"DEC2OCT(64)",result:'"100"',description:"64 decimal = 100 octal"}]},BIN2OCT:{name:"BIN2OCT",description:"Converts a binary number to octal",syntax:"BIN2OCT(number)",parameters:[{name:"number",description:"The binary number to convert",required:!0}],examples:[{formula:'BIN2OCT("1000")',result:'"10"',description:"1000 binary = 10 octal"},{formula:'BIN2OCT("1010")',result:'"12"',description:"1010 binary = 12 octal"}]},OCT2BIN:{name:"OCT2BIN",description:"Converts an octal number to binary",syntax:"OCT2BIN(number)",parameters:[{name:"number",description:"The octal number to convert",required:!0}],examples:[{formula:'OCT2BIN("10")',result:'"1000"',description:"10 octal = 1000 binary"},{formula:'OCT2BIN("12")',result:'"1010"',description:"12 octal = 1010 binary"}]},HEX2OCT:{name:"HEX2OCT",description:"Converts a hexadecimal number to octal",syntax:"HEX2OCT(number)",parameters:[{name:"number",description:"The hexadecimal number to convert",required:!0}],examples:[{formula:'HEX2OCT("A")',result:'"12"',description:"A hex = 12 octal"},{formula:'HEX2OCT("FF")',result:'"377"',description:"FF hex = 377 octal"}]},OCT2HEX:{name:"OCT2HEX",description:"Converts an octal number to hexadecimal",syntax:"OCT2HEX(number)",parameters:[{name:"number",description:"The octal number to convert",required:!0}],examples:[{formula:'OCT2HEX("12")',result:'"A"',description:"12 octal = A hex"},{formula:'OCT2HEX("377")',result:'"FF"',description:"377 octal = FF hex"}]},COMPLEX:{name:"COMPLEX",description:"Creates a complex number from real and imaginary coefficients",syntax:"COMPLEX(real_num, i_num, [suffix])",parameters:[{name:"real_num",description:"The real coefficient of the complex number",required:!0},{name:"i_num",description:"The imaginary coefficient of the complex number",required:!0},{name:"suffix",description:'The suffix for the imaginary component ("i" or "j")',required:!1}],examples:[{formula:"COMPLEX(3, 4)",result:'"3+4i"',description:"Create complex number 3+4i"},{formula:"COMPLEX(0, 1)",result:'"i"',description:"Pure imaginary unit"},{formula:'COMPLEX(5, -2, "j")',result:'"5-2j"',description:"Complex with j suffix"}]},IMREAL:{name:"IMREAL",description:"Returns the real coefficient of a complex number",syntax:"IMREAL(complex_number)",parameters:[{name:"complex_number",description:"The complex number to extract real part from",required:!0}],examples:[{formula:'IMREAL("3+4i")',result:"3",description:"Real part of 3+4i is 3"},{formula:'IMREAL("7")',result:"7",description:"Real number returns itself"},{formula:'IMREAL("3i")',result:"0",description:"Pure imaginary has real part 0"}]},IMAGINARY:{name:"IMAGINARY",description:"Returns the imaginary coefficient of a complex number",syntax:"IMAGINARY(complex_number)",parameters:[{name:"complex_number",description:"The complex number to extract imaginary part from",required:!0}],examples:[{formula:'IMAGINARY("3+4i")',result:"4",description:"Imaginary part of 3+4i is 4"},{formula:'IMAGINARY("7")',result:"0",description:"Real number has imaginary part 0"},{formula:'IMAGINARY("3i")',result:"3",description:"Pure imaginary coefficient is 3"}]}}},datetime:{name:"Date & Time",description:"Date and time manipulation functions",functions:{NOW:{name:"NOW",description:"Returns the current date and time",syntax:"NOW()",parameters:[],examples:[{formula:"NOW()",result:"2024-01-15 14:30:00",description:"Current date and time"}]},TODAY:{name:"TODAY",description:"Returns the current date",syntax:"TODAY()",parameters:[],examples:[{formula:"TODAY()",result:"2024-01-15",description:"Current date"}]},YEAR:{name:"YEAR",description:"Returns the year of a date",syntax:"YEAR(date)",parameters:[{name:"date",description:"The date to extract year from",required:!0}],examples:[{formula:"YEAR(DATE(2024, 1, 15))",result:"2024",description:"Extract year from date"},{formula:"YEAR(TODAY())",result:"2024",description:"Current year"}]},MONTH:{name:"MONTH",description:"Returns the month of a date",syntax:"MONTH(date)",parameters:[{name:"date",description:"The date to extract month from",required:!0}],examples:[{formula:"MONTH(DATE(2024, 3, 15))",result:"3",description:"Extract month from date"},{formula:"MONTH(TODAY())",result:"1",description:"Current month"}]},DAY:{name:"DAY",description:"Returns the day of a date",syntax:"DAY(date)",parameters:[{name:"date",description:"The date to extract day from",required:!0}],examples:[{formula:"DAY(DATE(2024, 1, 15))",result:"15",description:"Extract day from date"},{formula:"DAY(TODAY())",result:"15",description:"Current day"}]},WEEKDAY:{name:"WEEKDAY",description:"Returns the day of the week for a date",syntax:"WEEKDAY(date, [return_type])",parameters:[{name:"date",description:"The date to get weekday for",required:!0},{name:"return_type",description:"Format for weekday (1=Sun-Sat 1-7, 2=Mon-Sun 1-7)",required:!1}],examples:[{formula:"WEEKDAY(DATE(2024, 1, 15))",result:"2",description:"Monday = 2 (Sunday=1 system)"},{formula:"WEEKDAY(TODAY(), 2)",result:"1",description:"Monday = 1 (Monday=1 system)"}]},HOUR:{name:"HOUR",description:"Returns the hour of a time value",syntax:"HOUR(time)",parameters:[{name:"time",description:"The time to extract hour from",required:!0}],examples:[{formula:"HOUR(TIME(14, 30, 0))",result:"14",description:"Extract hour from time"},{formula:"HOUR(NOW())",result:"14",description:"Current hour"}]},MINUTE:{name:"MINUTE",description:"Returns the minute of a time value",syntax:"MINUTE(time)",parameters:[{name:"time",description:"The time to extract minute from",required:!0}],examples:[{formula:"MINUTE(TIME(14, 30, 45))",result:"30",description:"Extract minute from time"},{formula:"MINUTE(NOW())",result:"30",description:"Current minute"}]},SECOND:{name:"SECOND",description:"Returns the second of a time value",syntax:"SECOND(time)",parameters:[{name:"time",description:"The time to extract second from",required:!0}],examples:[{formula:"SECOND(TIME(14, 30, 45))",result:"45",description:"Extract second from time"},{formula:"SECOND(NOW())",result:"23",description:"Current second"}]},TIME:{name:"TIME",description:"Creates a time value from hour, minute, and second",syntax:"TIME(hour, minute, second)",parameters:[{name:"hour",description:"Hour value (0-23)",required:!0},{name:"minute",description:"Minute value (0-59)",required:!0},{name:"second",description:"Second value (0-59)",required:!0}],examples:[{formula:"TIME(14, 30, 0)",result:"0.604167",description:"Create time 2:30 PM"},{formula:"TIME(12, 0, 0)",result:"0.5",description:"Create noon time"}]},DATE:{name:"DATE",description:"Creates a date value from year, month, and day",syntax:"DATE(year, month, day)",parameters:[{name:"year",description:"Year value",required:!0},{name:"month",description:"Month value (1-12)",required:!0},{name:"day",description:"Day value (1-31)",required:!0}],examples:[{formula:"DATE(2024, 1, 15)",result:"45306",description:"Create date January 15, 2024"},{formula:"DATE(2025, 12, 25)",result:"46065",description:"Create Christmas 2025"}]},DATEDIF:{name:"DATEDIF",description:"Calculates the difference between two dates",syntax:"DATEDIF(start_date, end_date, unit)",parameters:[{name:"start_date",description:"The starting date",required:!0},{name:"end_date",description:"The ending date",required:!0},{name:"unit",description:'Unit of time ("Y", "M", "D", "YM", "YD", "MD")',required:!0}],examples:[{formula:'DATEDIF(DATE(2020,1,1), DATE(2024,1,1), "Y")',result:"4",description:"Years between dates"},{formula:'DATEDIF(DATE(2024,1,1), DATE(2024,3,15), "D")',result:"74",description:"Days between dates"}]}}}},ue=()=>{const n=[];return Object.entries(_).forEach(([b,a])=>{b!=="all"&&Object.entries(a.functions).forEach(([u,m])=>{n.push({...m,category:b,categoryName:a.name})})}),n},de=()=>{const n=ue(),b={};return n.forEach(a=>{b[a.name]=a}),_.all.functions=b,_};de();const pe="modulepreload",fe=function(n){return"/xl-formula/"+n},Y={},V=function(b,a,u){let m=Promise.resolve();if(a&&a.length>0){document.getElementsByTagName("link");const p=document.querySelector("meta[property=csp-nonce]"),l=(p==null?void 0:p.nonce)||(p==null?void 0:p.getAttribute("nonce"));m=Promise.allSettled(a.map(i=>{if(i=fe(i),i in Y)return;Y[i]=!0;const c=i.endsWith(".css"),A=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${i}"]${A}`))return;const y=document.createElement("link");if(y.rel=c?"stylesheet":pe,c||(y.as="script"),y.crossOrigin="",y.href=i,l&&y.setAttribute("nonce",l),document.head.appendChild(y),c)return new Promise((t,o)=>{y.addEventListener("load",t),y.addEventListener("error",()=>o(new Error(`Unable to preload CSS for ${i}`)))})}))}function f(p){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=p,window.dispatchEvent(l),!l.defaultPrevented)throw p}return m.then(p=>{for(const l of p||[])l.status==="rejected"&&f(l.reason);return b().catch(f)})};function he({func:n,category:b,categoryName:a}){var w;const[u,m]=R(((w=n.examples[0])==null?void 0:w.formula)||""),[f,p]=R(""),[l,i]=R(null),[c,A]=R(null),[y,t]=R(!1);B(()=>{o()},[]),B(()=>{l&&u&&N()},[u,l]);const o=async()=>{try{const s=await V(()=>import("./xl-formula-wrapper-BEBZ9tPI.js"),__vite__mapDeps([0,1,2]));console.log("🔍 XL Formula module loaded:",s),await s.default.init(),console.log("🔍 XL Formula initialized successfully");const h=new s.default.FormulaEngine;console.log("🔍 FormulaEngine created:",h);const C=h.evaluate("SUM(1,2,3)");if(C.isSuccess()){const T=C.getValue();console.log("🔍 XL Formula test result:",T.asNumber())}try{const T=h.evaluate("NOW()");if(T.isSuccess()){const U=T.getValue();console.log("🔍 NOW() test result:",U.asText())}}catch(T){console.error("🔍 NOW() test failed:",T)}i(h)}catch(s){throw console.error("🔍 Failed to initialize XL Formula:",s),s}},N=()=>{if(!(!l||!u))try{const s=u.startsWith("=")?u.substring(1):u;console.log("🔍 FunctionDetail runTest:",{formula:s,xlFormula:l,hasEvaluate:typeof l.evaluate=="function"});const h=l.evaluate(s);if(h.isSuccess()){const C=h.getValue(),T=g(C);console.log("🔍 evaluate result:",T,"Type:",C.getTypeName()),p(String(T))}else{const C=h.getErrorMessage()||"Unknown error";console.error("🔍 evaluate error:",C),p(`Error: ${C}`)}}catch(s){console.error("🔍 FunctionDetail error:",s),p(`Error: ${s.message}`)}},g=s=>{if(s.isNumber()){const h=s.asNumber();return Number.isInteger(h)?h.toString():h.toFixed(6).replace(/\.?0+$/,"")}else{if(s.isBoolean())return s.asBoolean()?"TRUE":"FALSE";if(s.isError())return s.getErrorText()}return s.asText()},v=async()=>{if(!(!l||!u)){t(!0),A(null);try{const h=u.startsWith("=")?u.substring(1):u;console.log("Running benchmark with XL Formula implementation"),console.log("Formula:",h),l.evaluate(h);const C=performance.now();let T;for(let I=0;I<1e5;I++){const P=l.evaluate(h);P.isSuccess()&&(T=P.getValue())}const U=performance.now()-C;console.log("XL Formula result:",T,"Time:",U,"ms");let D=null,O=null;try{const I=new J,P=I.parse(h);O=P.error?null:P.result,console.log("Hot-formula-parser args:",h),console.log("Hot-formula-parser parse result:",P),I.parse(h);const W=performance.now();for(let q=0;q<1e5;q++)I.parse(h);D=performance.now()-W,console.log("Hot-formula-parser result:",O,"Time:",D,"ms")}catch(I){console.warn("Hot-formula-parser benchmark failed:",I)}let S=!1;O!==null&&(typeof T=="number"&&typeof O=="number"?S=Math.abs(T-O)<.001:S=String(T)===String(O)),!S&&O!==null&&console.warn("Results don't match! XL:",T,"(",typeof T,") Hot-formula-parser:",O,"(",typeof O,")"),A({xlFormula:U,hotFormulaParser:D,iterations:1e5,speedup:D?(D/U).toFixed(2):null,xlResult:T,hotFormulaResult:O,resultsMatch:O!==null?S:null})}catch(s){console.error("Benchmark failed:",s),A({error:s.message,xlFormula:null,hotFormulaParser:null,iterations:0,speedup:null})}finally{t(!1)}}};return e("div",{children:[e("div",{style:{marginBottom:"2rem"},children:[e("div",{style:{marginBottom:"0.25rem"},children:[e("div",{style:{display:"inline-flex",alignItems:"center",gap:"0.4rem",marginBottom:"0"},children:e("span",{className:"text-xs rounded",style:{background:"var(--color-primary-light)",color:"var(--color-primary)",padding:"2px 8px"},children:a})}),e("h1",{className:"text-3xl font-mono font-bold",style:{overflowWrap:"anywhere"},children:n.name})]}),e("p",{className:"text-lg text-muted",children:n.description})]}),e("div",{className:"grid grid-cols-2 gap-8",style:{gap:"1rem"},children:[e("div",{children:[e("div",{className:"card mb-6",children:[e("h3",{className:"font-semibold mb-4",children:"Syntax & Parameters"}),e("div",{className:"mb-4",children:[e("div",{className:"text-sm font-medium mb-2",children:"Syntax"}),e("div",{className:"font-mono p-3 rounded",style:{background:"var(--color-bg-secondary)",overflowX:"auto"},children:n.syntax})]}),e("div",{children:[e("div",{className:"text-sm font-medium mb-3",children:"Parameters"}),n.parameters.length>0?e("div",{className:"grid gap-3",children:[n.parameters.map((s,h)=>e("div",{className:"flex gap-3",style:{flexWrap:"wrap"},children:[e("div",{className:"font-mono text-sm font-medium",style:{minWidth:"100px"},children:[s.name,s.required&&e("span",{className:"text-error",children:"*"})]}),e("div",{className:"text-sm text-muted",children:s.description})]},h)),e("div",{className:"text-xs text-muted mt-2",children:"* Required parameter"})]}):e("p",{className:"text-muted text-sm",children:"This function takes no parameters."})]})]}),e("div",{className:"card",children:[e("h3",{className:"font-semibold mb-3",children:"Examples"}),e("div",{className:"grid gap-4",children:n.examples.map((s,h)=>e("div",{className:"p-3 rounded",style:{background:"var(--color-bg-secondary)",overflowX:"auto"},children:[e("div",{className:"flex justify-between items-start mb-2",style:{flexWrap:"wrap"},children:[e("code",{className:"font-mono text-sm",children:s.formula}),e("span",{className:"text-sm text-success",children:s.result})]}),e("div",{className:"text-xs text-muted",children:s.description})]},h))})]})]}),e("div",{children:[e("div",{className:"card mb-6",children:[e("h3",{className:"font-semibold mb-3",children:"Try It Out"}),e("label",{className:"label",children:"Formula"}),e("input",{type:"text",value:u,onChange:s=>m(s.target.value),className:"input monospace mb-3",placeholder:"Enter a formula to test",style:{minWidth:"180px",width:"100%"}}),e("div",{className:"p-3 rounded",style:{background:"var(--color-success-light)",border:"1px solid var(--color-success)",color:"var(--color-text)",overflowX:"auto"},children:[e("div",{className:"flex justify-between items-center",style:{flexWrap:"wrap"},children:[e("strong",{children:"Result:"}),e("button",{onClick:N,className:"btn btn-sm",children:"Run Test"})]}),e("div",{className:"font-mono mt-2",children:f||'Click "Run Test" to see result'})]}),e("div",{className:"mt-4",children:[e("h4",{className:"font-medium mb-2",children:"Quick Examples"}),e("div",{className:"grid gap-2",children:n.examples.map((s,h)=>e("button",{onClick:()=>m(s.formula),className:"btn btn-sm text-left",style:{justifyContent:"flex-start",width:"100%"},children:e("code",{className:"font-mono text-xs",children:s.formula})},h))})]})]}),e("div",{className:"card",children:[e("h3",{className:"font-semibold mb-3",children:"Performance Benchmark"}),e("p",{className:"text-sm text-muted mb-4",children:"Compare XL Formula performance against Hot Formula Parser"}),e("button",{onClick:v,disabled:y||!u,className:"btn btn-primary mb-4",style:{width:"100%"},children:y?"Running Benchmark...":"Run Benchmark"}),c&&e("div",{className:"grid gap-3",children:c.error?e("div",{className:"p-3 rounded",style:{background:"var(--color-error-light)",color:"var(--color-error)"},children:[e("strong",{children:"Benchmark Error:"})," ",c.error]}):e(M,{children:[e("div",{className:"flex justify-between",children:[e("span",{children:"XL Formula:"}),e("span",{className:"font-mono",children:c.xlFormula?`${c.xlFormula.toFixed(2)}ms`:"N/A"})]}),c.hotFormulaParser&&e(M,{children:[e("div",{className:"flex justify-between",children:[e("span",{children:"Hot Formula Parser:"}),e("span",{className:"font-mono",children:[c.hotFormulaParser.toFixed(2),"ms"]})]}),e("div",{className:"flex justify-between font-semibold",children:[e("span",{children:"Speedup:"}),e("span",{className:c.speedup>1?"text-success":"text-error",children:c.speedup>1?`${c.speedup}x faster`:`${(1/parseFloat(c.speedup)).toFixed(2)}x slower`})]})]}),c.resultsMatch!==null&&e("div",{className:"flex justify-between text-xs",children:[e("span",{children:"Results match:"}),e("span",{className:c.resultsMatch?"text-success":"text-error",children:[c.resultsMatch?"✓ Yes":"✗ No",!c.resultsMatch&&` (XL: ${c.xlResult}, HFP: ${c.hotFormulaResult})`]})]}),e("div",{className:"text-xs text-muted",children:["Tested with ",c.iterations.toLocaleString()," iterations"]})]})}),!c&&!y&&e("div",{className:"text-sm text-muted",children:'Enter a formula above and click "Run Benchmark" to compare performance against Hot Formula Parser.'})]})]})]})]})}const k="/xl-formula/";function X({category:n,function:b}){const a=n||"all",u=b||null,[m,f]=R(""),[p,l]=R(!1);B(()=>{!n&&!b&&window.location.pathname===`${k}docs`&&oe(`${k}docs/all`,!0)},[n,b]);const i=_[a],c=u&&(i==null?void 0:i.functions[u.toUpperCase()]),y=(()=>{if(!i)return[];const t=Object.entries(i.functions);let o;if(!m.trim())o=t;else{const N=m.toLowerCase();o=t.filter(([g,v])=>v.name.toLowerCase().includes(N)||v.description.toLowerCase().includes(N)||v.syntax.toLowerCase().includes(N))}return o.sort(([N,g],[v,w])=>g.name.localeCompare(w.name))})();return u&&c?e("div",{className:"container",style:{padding:"2rem 0"},children:[e("div",{className:"mb-6",children:e("nav",{className:"flex items-center gap-2 text-sm text-muted hide-mobile",children:[e(L,{href:`${k}docs`,style:{textDecoration:"none",color:"var(--color-primary)"},children:"Documentation"}),e("span",{children:"→"}),e(L,{href:`${k}docs/${a}`,style:{textDecoration:"none",color:"var(--color-primary)"},children:i==null?void 0:i.name}),e("span",{children:"→"}),e("span",{children:c.name})]})}),e(he,{func:c,category:c.category||a,categoryName:c.categoryName||i.name})]}):e("div",{className:"container",style:{padding:"2rem 0"},children:[e("h1",{className:"text-2xl font-bold mb-6",children:"Documentation"}),e("button",{className:"btn btn-sm show-mobile",style:{marginBottom:"1rem",width:"100%"},onClick:()=>l(!0),children:"Browse Categories"}),p&&e(M,{children:[e("div",{className:"sidebar-mobile-backdrop",onClick:()=>l(!1)}),e("div",{className:"sidebar-mobile-drawer open",children:[e("div",{style:{padding:"1rem",borderBottom:"1px solid var(--color-border)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e("span",{className:"text-xl font-bold",style:{color:"var(--color-primary)"},children:"Categories"}),e("button",{className:"btn btn-sm",style:{background:"none",border:"none",fontSize:"1.5rem"},"aria-label":"Close menu",onClick:()=>l(!1),children:"×"})]}),e("nav",{style:{display:"flex",flexDirection:"column",padding:"1rem"},children:Object.entries(_).map(([t,o])=>{const g={all:"📚",math:"🔢",text:"📝",logical:"🔀",datetime:"📅",financial:"💰",engineering:"⚙️"}[t]||"📄";return e(L,{href:`${k}docs/${t}`,className:`btn btn-sm${a===t?" btn-primary":""}`,style:{marginBottom:"0.5rem",textAlign:"left"},onClick:()=>l(!1),children:[e("span",{style:{marginRight:"0.75rem"},children:g}),o.name]},t)})})]})]}),e("div",{style:{display:"flex",gap:"2rem"},children:[e("div",{className:"hide-mobile",style:{width:"25%",minWidth:"250px"},children:e("div",{className:"card",children:[e("h3",{className:"font-semibold mb-4",children:"Categories"}),e("div",{className:"grid gap-2",children:Object.entries(_).map(([t,o])=>{const g={all:"📚",math:"🔢",text:"📝",logical:"🔀",datetime:"📅",financial:"💰",engineering:"⚙️"}[t]||"📄";return e(L,{href:`${k}docs/${t}`,className:`p-3 rounded text-sm ${a===t?"bg-primary text-white":"hover:bg-secondary"}`,style:{textDecoration:"none",display:"block",background:a===t?"var(--color-primary)":"transparent",color:a===t?"white":"var(--color-text)"},children:e("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e("span",{style:{fontSize:"1.2rem"},children:g}),e("div",{children:[e("div",{className:"font-medium",children:o.name}),e("div",{className:"text-xs opacity-80",children:[Object.keys(o.functions).length," functions"]})]})]})},t)})})]})}),e("div",{style:{flex:1},children:e("div",{className:"card",children:[e("div",{className:"flex justify-between items-center mb-4",style:{flexWrap:"wrap"},children:[e("h3",{className:"font-semibold",children:i==null?void 0:i.name}),e("div",{className:"text-sm text-muted",children:[y.length," function",y.length!==1?"s":"",m&&` matching "${m}"`]})]}),e("div",{className:"mb-4",children:e("input",{type:"text",placeholder:"Search functions...",value:m,onChange:t=>f(t.target.value),onInput:t=>f(t.target.value),onKeyUp:t=>f(t.target.value),style:{width:"100%",padding:"8px 12px",border:"1px solid var(--color-border)",borderRadius:"4px",fontSize:"14px"}})}),e("p",{className:"text-sm text-muted mb-4",children:i==null?void 0:i.description}),e("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:y.length>0?y.map(([t,o])=>e(L,{href:`${k}docs/${a}/${t.toLowerCase()}`,className:"p-3 rounded border hover:border-primary",style:{textDecoration:"none",display:"block",border:"1px solid var(--color-border)",color:"var(--color-text)"},children:[e("div",{className:"font-mono font-medium text-sm",style:{color:"var(--color-text)"},children:o.name}),e("div",{className:"text-xs text-muted mt-1",children:o.description})]},t)):e("div",{className:"col-span-full text-center py-8 text-muted",children:[e("div",{className:"text-lg mb-2",children:"No functions found"}),e("div",{className:"text-sm",children:m?`No functions match "${m}"`:"No functions in this category"})]})})]})})]})]})}function xe({formula:n="SUM(1,2,3,4,5)",compact:b=!1}){var i,c,A,y;const[a,u]=R({}),[m,f]=R(!0);B(()=>{l()},[n]);const p=()=>{l()},l=async()=>{f(!0);const t={};try{t.importTest="attempting...";try{const o=await V(()=>import("./xl-formula-wrapper-BEBZ9tPI.js"),__vite__mapDeps([0,1,2]));t.importTest="success",t.module=Object.keys(o),t.initTest="attempting...",await o.default.init(),t.initTest="success",t.calcTest="attempting...";const N=n.startsWith("=")?n.substring(1):n;try{const g=o.default.evaluate(N);if(g.isSuccess()){const v=g.getValue();t.calcTest=`success: ${v.asText()}`,t.isReal=!0;const w=1e4,s=performance.now();for(let C=0;C<w;C++)o.default.evaluate(N);const h=performance.now()-s;t.xlPerformance=`${h.toFixed(2)}ms for ${w} iterations`}else t.calcTest=`failed: ${g.getErrorMessage()}`,t.xlPerformance="Skipped (invalid formula)",t.isReal=!1}catch(g){t.calcTest=`failed: ${g.message}`,t.xlPerformance="Skipped (invalid formula)",t.isReal=!1}}catch(o){t.importTest=`failed: ${o.message}`,t.error=o.toString(),t.isReal=!1}try{const N=new J,g=n.startsWith("=")?n.substring(1):n,v=N.parse(g);if(v.error)t.hotFormulaParserPerformance=`Skipped (${v.error})`;else{const w=performance.now();for(let h=0;h<1e4;h++)N.parse(g);const s=performance.now()-w;t.hotFormulaParserPerformance=`${s.toFixed(2)}ms for 10000 iterations`}}catch(o){t.hotFormulaParserError=o.toString()}try{const o=await fetch("/packages/web/xl-formula.wasm");t.wasmFileCheck=o.ok?"accessible":`failed: ${o.status}`}catch(o){t.wasmFileCheck=`failed: ${o.message}`}try{const o=await fetch("/packages/web/xl-formula-wrapper.js");t.wrapperFileCheck=o.ok?"accessible":`failed: ${o.status}`}catch(o){t.wrapperFileCheck=`failed: ${o.message}`}}catch(o){t.generalError=o.toString()}u(t),f(!1)};return m?e("div",{children:"Running diagnostic..."}):b?e("div",{className:"text-xs text-muted",children:m?e("span",{children:"Benchmarking..."}):e(M,{children:a.error?e("span",{children:"Benchmark error"}):e(M,{children:[a.xlPerformance&&a.hotFormulaParserPerformance&&!a.xlPerformance.includes("Skipped")&&!a.hotFormulaParserPerformance.includes("Skipped")&&e("div",{children:(()=>{var v,w,s;const t=parseFloat(((v=a.xlPerformance.match(/(\d+\.?\d*)/))==null?void 0:v[1])||"0"),o=parseFloat(((w=a.hotFormulaParserPerformance.match(/(\d+\.?\d*)/))==null?void 0:w[1])||"0"),N=((s=a.xlPerformance.match(/(\d+(?:,\d+)*) iterations/))==null?void 0:s[1])||"10000",g=o/t;return e(M,{children:[e("div",{children:["XL Formula: ",t,"ms • Hot Formula Parser: ",o,"ms (",N," iterations)"]}),e("div",{className:g>1?"text-success":"text-error",children:g>1?`${g.toFixed(1)}x faster`:`${(1/g).toFixed(1)}x slower`})]})})()}),(((i=a.calcTest)==null?void 0:i.includes("failed"))||((c=a.hotFormulaParserPerformance)==null?void 0:c.includes("Skipped")))&&e("span",{children:"Benchmark skipped"})]})})}):e("div",{className:"card",children:[e("div",{className:"flex justify-between items-center mb-3",children:[e("h3",{className:"font-semibold",children:"Performance Benchmark"}),e("button",{onClick:p,className:"btn btn-sm",disabled:m,children:m?"Running...":"Refresh"})]}),e("p",{className:"text-sm text-muted mb-3",children:["Formula: ",e("code",{className:"font-mono",children:n})]}),a.error?e("div",{className:"p-3 rounded text-sm",style:{background:"var(--color-error-light)",color:"var(--color-error)"},children:[e("strong",{children:"Error:"})," ",a.error]}):e("div",{className:"grid gap-3",children:[a.xlPerformance&&a.hotFormulaParserPerformance&&e(M,{children:[e("div",{className:"flex justify-between",children:[e("span",{children:"XL Formula:"}),e("span",{className:"font-mono",children:a.xlPerformance})]}),e("div",{className:"flex justify-between",children:[e("span",{children:"Hot Formula Parser:"}),e("span",{className:"font-mono",children:a.hotFormulaParserPerformance})]}),a.xlPerformance&&a.hotFormulaParserPerformance&&!a.xlPerformance.includes("Skipped")&&!a.hotFormulaParserPerformance.includes("Skipped")&&e("div",{className:"flex justify-between font-semibold pt-2 border-t",children:[e("span",{children:"Performance:"}),e("span",{className:"text-success",children:(()=>{var g,v;const t=parseFloat(((g=a.xlPerformance.match(/(\d+\.?\d*)/))==null?void 0:g[1])||"0"),N=parseFloat(((v=a.hotFormulaParserPerformance.match(/(\d+\.?\d*)/))==null?void 0:v[1])||"0")/t;return N>1?`${N.toFixed(1)}x faster`:`${(1/N).toFixed(1)}x slower`})()})]})]}),(((A=a.calcTest)==null?void 0:A.includes("failed"))||((y=a.hotFormulaParserPerformance)==null?void 0:y.includes("Skipped")))&&e("div",{className:"text-sm text-muted",children:"Invalid formula - benchmark skipped"})]})]})}function be(){const[n,b]=R("=SUM(1, 2, 3, 4, 5)"),[a,u]=R(""),[m,f]=R(""),[p,l]=R(!1),[i,c]=R([{name:"A1",value:"10"},{name:"B1",value:"20"},{name:"C1",value:"30"}]),[A,y]=R(""),[t,o]=R(""),[N,g]=R(null),[v,w]=R(null),[s,h]=R(!0),[C,T]=R([]),[U,D]=R(!1),[O,S]=R("");B(()=>{const r=localStorage.getItem("xl-formula-saved");if(r)try{const d=JSON.parse(r).map(E=>typeof E=="string"?{formula:E,name:null,variables:[],timestamp:new Date().toISOString()}:E);T(d)}catch(x){console.warn("Failed to parse saved formulas from localStorage",x)}else{const x=localStorage.getItem("xl-formula-history");if(x)try{const E=JSON.parse(x).map(F=>typeof F=="string"?{formula:F,name:null,variables:[],timestamp:new Date().toISOString()}:F);T(E),localStorage.setItem("xl-formula-saved",JSON.stringify(E)),localStorage.removeItem("xl-formula-history")}catch(d){console.warn("Failed to migrate formula history",d)}}},[]);const I=(r,x=null)=>{if(console.log("saveFormula called with:",{formula:r,name:x,variables:i}),!r||r.trim()===""){console.log("Formula is empty, not saving");return}const d={formula:r,name:x||null,variables:[...i],timestamp:new Date().toISOString()};console.log("Creating saved item:",d);const E=[d,...C.filter(F=>(typeof F=="string"?F:F.formula)!==r)].slice(0,20);console.log("New saved formulas array:",E),T(E),localStorage.setItem("xl-formula-saved",JSON.stringify(E)),console.log("Saved to localStorage:",localStorage.getItem("xl-formula-saved"))};B(()=>{P()},[]);const P=async()=>{try{const r=await V(()=>import("./xl-formula-wrapper-BEBZ9tPI.js"),__vite__mapDeps([0,1,2]));await r.default.init();const x=new r.default.FormulaEngine;i.forEach(({name:d,value:E})=>{x.setVariable(d,W(E))}),g(r.default),w(x),h(!1),q(n,x)}catch(r){throw console.error("Failed to initialize XL Formula:",r),h(!1),r}},W=r=>{const x=parseFloat(r);if(!isNaN(x)&&isFinite(x))return x;const d=r.toLowerCase();return d==="true"||d==="false"?d==="true":r},q=(r,x=v)=>{if(!x||!r.trim()){u(""),f("empty"),l(!1);return}try{const d=x.evaluate(r);if(d.isSuccess()){const E=d.getValue();u(Q(E)),f(E.getTypeName()),l(!0)}else u(d.getErrorMessage()||"Unknown error"),f("error"),l(!1)}catch(d){u(`Error: ${d.message}`),f("error"),l(!1)}},Q=r=>{if(r.isNumber()){const x=r.asNumber();return Number.isInteger(x)?x.toString():x.toFixed(6).replace(/\.?0+$/,"")}else{if(r.isBoolean())return r.asBoolean()?"TRUE":"FALSE";if(r.isError())return r.getErrorText()}return r.asText()},K=()=>{if(!A||!t)return;const r={name:A,value:t};c([...i,r]),v&&(v.setVariable(A,W(t)),q(n)),y(""),o("")},Z=r=>{c(i.filter(x=>x.name!==r)),v&&(v.removeVariable(r),q(n))},ee=r=>{console.log("Loading saved formula:",r);const x=typeof r=="string"?r:r.formula,d=typeof r=="object"?r.variables:[];console.log("Extracted formula:",x,"variables:",d),b(x),d&&d.length>0?(console.log("Restoring variables:",d),c(d),v&&(i.forEach(E=>{console.log("Removing variable:",E.name),v.removeVariable(E.name)}),d.forEach(({name:E,value:F})=>{console.log("Setting variable:",E,"=",F),v.setVariable(E,W(F))}))):console.log("No variables to restore"),q(x)},re=r=>{b(r),q(r)};return s?e("div",{className:"container",style:{padding:"4rem 0",textAlign:"center"},children:e("div",{children:"Loading XL Formula engine..."})}):e("div",{className:"container",style:{padding:"2rem 0"},children:[e("h1",{className:"text-2xl font-bold mb-6",children:"Formula Playground"}),e("div",{className:"card mb-6",children:[e("label",{className:"label",children:"Formula"}),e("div",{className:"flex gap-2 mb-4",style:{flexWrap:"wrap"},children:[e("input",{type:"text",value:n,onChange:r=>{b(r.target.value),q(r.target.value)},className:"input monospace flex-1",placeholder:"Enter a formula like =SUM(1, 2, 3) or =A1 + B1",style:{minWidth:"180px",flex:1}}),e("button",{onClick:()=>{D(!0)},className:"btn btn-sm",disabled:!n.trim(),style:{minWidth:"100px"},children:"Save"})]}),e("div",{className:"p-4 rounded",style:{background:p?"var(--color-success-light)":"var(--color-error-light)",border:`1px solid ${p?"var(--color-success)":"var(--color-error)"}`,color:"var(--color-text)",fontFamily:"var(--font-mono)"},children:[e("div",{className:"flex justify-between items-center",style:{flexWrap:"wrap"},children:[e("strong",{children:"Result:"}),e("span",{className:"text-sm",children:m})]}),e("div",{className:"flex justify-between items-center",style:{marginTop:"0.5rem",flexWrap:"wrap"},children:[e("div",{style:{fontSize:"1.1rem"},children:a||"Enter a formula to see the result"}),a&&e("div",{style:{marginLeft:"1rem",minWidth:"120px"},children:e(xe,{formula:n,compact:!0})})]})]})]}),C.length>0&&e("div",{className:"card mb-6",children:[e("div",{className:"flex justify-between items-center mb-4",style:{flexWrap:"wrap"},children:[e("h3",{className:"font-semibold",children:["Saved Formulas (",C.length,")"]}),e("button",{onClick:()=>{T([]),localStorage.removeItem("xl-formula-saved")},className:"btn btn-sm",style:{fontSize:"0.75rem",minWidth:"100px"},children:"Clear All"})]}),e("div",{className:"grid gap-2",children:C.map((r,x)=>e("div",{onClick:()=>ee(r),className:"p-3 rounded cursor-pointer flex justify-between items-center",style:{background:"var(--color-bg-secondary)",border:"1px solid var(--color-border)",cursor:"pointer",flexWrap:"wrap"},onMouseOver:d=>d.currentTarget.style.borderColor="var(--color-primary)",onMouseOut:d=>d.currentTarget.style.borderColor="var(--color-border)",children:[e("div",{className:"flex-1",children:[r.name&&e("div",{className:"text-sm font-medium text-primary mb-1",children:r.name}),e("div",{className:"font-mono text-sm",children:r.formula}),r.variables&&r.variables.length>0&&e("div",{className:"text-xs text-muted mt-1",children:["Variables: ",r.variables.map(d=>`${d.name}=${d.value}`).join(", ")]})]}),e("button",{onClick:d=>{d.stopPropagation();const E=C.filter((F,te)=>te!==x);T(E),localStorage.setItem("xl-formula-saved",JSON.stringify(E))},className:"text-xs text-muted hover:text-error ml-2",style:{padding:"4px 8px",minWidth:"32px"},title:"Delete saved formula",children:"×"})]},x))})]}),e("div",{className:"grid grid-cols-2 gap-6",style:{gap:"1rem"},children:[e("div",{className:"card",children:[e("h3",{className:"font-semibold mb-4",children:"Variables"}),e("div",{className:"flex gap-2 mb-4",style:{flexWrap:"wrap"},children:[e("input",{type:"text",value:A,onChange:r=>y(r.target.value),placeholder:"Variable name",className:"input",style:{minWidth:"100px",flex:1}}),e("input",{type:"text",value:t,onChange:r=>o(r.target.value),placeholder:"Value",className:"input",style:{minWidth:"100px",flex:1}}),e("button",{onClick:K,className:"btn btn-primary",style:{minWidth:"80px"},children:"Add"})]}),e("div",{className:"grid gap-2",children:i.map(r=>e("div",{className:"flex justify-between items-center p-2 rounded",style:{background:"var(--color-bg-secondary)",flexWrap:"wrap"},children:[e("span",{className:"font-mono font-medium",children:r.name}),e("span",{className:"font-mono text-muted",children:r.value}),e("button",{onClick:()=>Z(r.name),className:"btn btn-sm",style:{background:"var(--color-error)",color:"white",border:"none",minWidth:"60px"},children:"Remove"})]},r.name))})]}),e("div",{className:"card",children:[e("h3",{className:"font-semibold mb-4",children:"Examples"}),e("div",{className:"grid gap-3",children:[{formula:"=SUM(1, 2, 3, 4, 5)",description:"Basic sum function"},{formula:"=MAX(10, 20, 5, 30)",description:"Find maximum value"},{formula:"=ROUND(3.14159, 2)",description:"Round to 2 decimal places"},{formula:'=IF(5 > 3, "Yes", "No")',description:"Conditional logic"},{formula:'=CONCATENATE("Hello", " ", "World")',description:"Text concatenation"},{formula:"=A1 + B1 * C1",description:"Using variables"}].map((r,x)=>e("div",{onClick:()=>re(r.formula),className:"p-3 rounded cursor-pointer",style:{background:"var(--color-bg-secondary)",border:"1px solid var(--color-border)",cursor:"pointer",flexWrap:"wrap"},onMouseOver:d=>d.currentTarget.style.borderColor="var(--color-primary)",onMouseOut:d=>d.currentTarget.style.borderColor="var(--color-border)",children:[e("div",{className:"font-mono font-medium text-sm",children:r.formula}),e("div",{className:"text-xs text-muted mt-1",children:r.description})]},x))})]})]}),U&&e("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},onClick:r=>{r.target===r.currentTarget&&D(!1)},children:e("div",{style:{backgroundColor:"white",borderRadius:"8px",padding:"24px",width:"90vw",maxWidth:"400px",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)"},onClick:r=>r.stopPropagation(),children:[e("h3",{style:{fontSize:"18px",fontWeight:"bold",marginBottom:"16px"},children:"Save Formula"}),e("div",{style:{marginBottom:"16px"},children:[e("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",marginBottom:"8px"},children:"Formula Name (optional)"}),e("input",{type:"text",value:O,onChange:r=>S(r.target.value),style:{width:"100%",padding:"8px 12px",border:"1px solid #ccc",borderRadius:"4px",fontSize:"14px"},placeholder:"e.g. 'Complex calculation', 'Tax formula'",autoFocus:!0})]}),e("div",{style:{marginBottom:"16px"},children:[e("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",marginBottom:"8px"},children:"Formula"}),e("div",{style:{padding:"8px 12px",backgroundColor:"#f5f5f5",borderRadius:"4px",fontFamily:"monospace",fontSize:"14px",overflowX:"auto"},children:n})]}),i.length>0&&e("div",{style:{marginBottom:"16px"},children:[e("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",marginBottom:"8px"},children:"Variables to Save"}),e("div",{style:{fontSize:"14px",color:"#666"},children:i.map(r=>`${r.name}=${r.value}`).join(", ")})]}),e("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end",flexWrap:"wrap"},children:[e("button",{onClick:()=>{D(!1),S("")},style:{padding:"8px 16px",border:"1px solid #ccc",borderRadius:"4px",backgroundColor:"white",cursor:"pointer",minWidth:"80px"},children:"Cancel"}),e("button",{onClick:()=>{I(n,O.trim()||null),D(!1),S("")},style:{padding:"8px 16px",border:"none",borderRadius:"4px",backgroundColor:"#007bff",color:"white",cursor:"pointer",minWidth:"80px"},children:"Save"})]})]})})]})}function ge(){const n="/xl-formula/";return e("div",{style:{minHeight:"100vh",display:"flex",flexDirection:"column"},children:[e(ce,{}),e("main",{style:{flex:1},children:e(ie,{children:[e(G,{path:n}),e(G,{path:`${n}`}),e(X,{path:`${n}docs`}),e(X,{path:`${n}docs/:category?`}),e(X,{path:`${n}docs/:category/:function?`}),e(be,{path:`${n}playground`})]})})]})}se(e(ge,{}),document.getElementById("app"));export{V as _};
