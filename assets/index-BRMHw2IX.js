const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/formula-wrapper-B6H7nW3V.js","assets/vendor-CzFS8S-F.js","assets/formula-DkIGol2c.js"])))=>i.map(i=>d[i]);
import{l as Y,C as ie,s as Q,_ as se,E as P,d as R,A as J,y as B,k as V,$ as oe,D as le,G as de}from"./vendor-CzFS8S-F.js";import{P as te}from"./formula-DkIGol2c.js";(function(){const f=document.createElement("link").relList;if(f&&f.supports&&f.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))h(l);new MutationObserver(l=>{for(const c of l)if(c.type==="childList")for(const u of c.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&h(u)}).observe(document,{childList:!0,subtree:!0});function n(l){const c={};return l.integrity&&(c.integrity=l.integrity),l.referrerPolicy&&(c.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?c.credentials="include":l.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function h(l){if(l.ep)return;l.ep=!0;const c=n(l);fetch(l.href,c)}})();var me=0;function e(a,f,n,h,l,c){f||(f={});var u,d,o=f;if("ref"in o)for(d in o={},f)d=="ref"?u=f[d]:o[d]=f[d];var i={type:a,props:o,key:n,ref:u,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--me,__i:-1,__u:0,__source:l,__self:c};if(typeof a=="function"&&(u=a.defaultProps))for(d in u)o[d]===void 0&&(o[d]=u[d]);return Y.vnode&&Y.vnode(i),i}var ce=["className","activeClass","activeClassName","path"];function _(a){var f=a.className,n=a.activeClass,h=a.activeClassName,l=a.path,c=function(A,v){if(A==null)return{};var t,s,N={},b=Object.keys(A);for(s=0;s<b.length;s++)v.indexOf(t=b[s])>=0||(N[t]=A[t]);return N}(a,ce),u=ie()[0],d=l&&u.path&&Q(u.path,l,{})||Q(u.url,c.href,{}),o=c.class||f||"",i=d&&(n||h)||"";return c.class=o+(o&&i&&" ")+i,se(P,c)}function ue(){const a="/velox/",[f,n]=R(!1),[h,l]=R(!1),c=J(null),u=J(null);return B(()=>()=>{c.current&&clearTimeout(c.current)},[]),e("header",{style:{borderBottom:"1px solid var(--color-border)",background:"var(--color-bg)",position:"sticky",top:0,zIndex:50},children:[e("div",{className:"container",children:e("nav",{className:"flex items-center justify-between",style:{height:"4rem"},children:[e("div",{className:"flex items-center",style:{flex:1},children:[e(_,{href:a,className:"text-xl font-bold",style:{textDecoration:"none",color:"var(--color-primary)"},children:"Velox"}),e("button",{className:"show-mobile",style:{marginLeft:"auto",background:"none",border:"none",color:"var(--color-text)",fontSize:"1.5rem",display:"none",padding:"0.25rem 0.5rem"},"aria-label":"Open menu",onClick:()=>n(!0),children:e("span",{style:{fontSize:"1.75rem",lineHeight:1},children:"â˜°"})}),e("div",{className:"flex items-center hide-mobile",style:{marginLeft:"1rem"},children:e("div",{style:{position:"relative"},onMouseEnter:()=>{c.current&&clearTimeout(c.current),l(!0)},onMouseLeave:()=>{c.current=setTimeout(()=>{l(!1)},150)},ref:u,children:[e("button",{className:"text-sm font-medium nav-link",style:{textDecoration:"none",color:"var(--color-text-secondary)",padding:"6px 10px",borderRadius:"6px",transition:"all 0.2s ease",background:"none",border:"none",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px"},children:["Formulas",e("span",{style:{fontSize:"0.75rem"},children:"â–¼"})]}),h&&e("div",{style:{position:"absolute",top:"100%",left:0,background:"var(--color-bg)",border:"1px solid var(--color-border)",borderRadius:"8px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)",minWidth:"160px",zIndex:100,marginTop:"4px"},children:[e(_,{href:`${a}formulas`,style:{display:"block",padding:"8px 12px",textDecoration:"none",color:"var(--color-text)",fontSize:"0.875rem",borderBottom:"1px solid var(--color-border)"},onMouseOver:i=>i.target.style.backgroundColor="var(--color-bg-secondary)",onMouseOut:i=>i.target.style.backgroundColor="transparent",children:"Overview"}),e(_,{href:`${a}formulas/playground`,style:{display:"block",padding:"8px 12px",textDecoration:"none",color:"var(--color-text)",fontSize:"0.875rem",borderBottom:"1px solid var(--color-border)"},onMouseOver:i=>i.target.style.backgroundColor="var(--color-bg-secondary)",onMouseOut:i=>i.target.style.backgroundColor="transparent",children:"Playground"}),e(_,{href:`${a}formulas/docs`,style:{display:"block",padding:"8px 12px",textDecoration:"none",color:"var(--color-text)",fontSize:"0.875rem"},onMouseOver:i=>i.target.style.backgroundColor="var(--color-bg-secondary)",onMouseOut:i=>i.target.style.backgroundColor="transparent",children:"Documentation"})]})]})})]}),e("div",{className:"flex items-center gap-4 hide-mobile",children:[e("a",{href:"https://github.com/rpenfold/xl-formula",target:"_blank",rel:"noopener noreferrer",className:"btn btn-sm",children:"GitHub"}),e("a",{href:"https://www.npmjs.com/package/@velox/formulas",target:"_blank",rel:"noopener noreferrer",className:"btn btn-sm btn-primary",children:"npm install"})]})]})}),f&&e(V,{children:[e("div",{className:"sidebar-mobile-backdrop",onClick:()=>n(!1)}),e("div",{className:"sidebar-mobile-drawer open",children:[e("div",{style:{padding:"1rem",borderBottom:"1px solid var(--color-border)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e("span",{className:"text-xl font-bold",style:{color:"var(--color-primary)"},children:"Velox"}),e("button",{className:"btn btn-sm",style:{background:"none",border:"none",fontSize:"1.5rem"},"aria-label":"Close menu",onClick:()=>n(!1),children:"Ã—"})]}),e("nav",{style:{display:"flex",flexDirection:"column",padding:"1rem"},children:[e(_,{href:a,className:"btn btn-sm",style:{marginBottom:"0.5rem"},onClick:()=>n(!1),children:"Home"}),e("div",{style:{marginBottom:"0.5rem"},children:[e("div",{className:"btn btn-sm",style:{width:"100%",textAlign:"left",background:"var(--color-bg-secondary)"},children:"Formulas"}),e("div",{style:{paddingLeft:"1rem",marginTop:"0.25rem"},children:[e(_,{href:`${a}formulas`,className:"btn btn-sm",style:{display:"block",marginBottom:"0.25rem",fontSize:"0.875rem"},onClick:()=>n(!1),children:"Overview"}),e(_,{href:`${a}formulas/playground`,className:"btn btn-sm",style:{display:"block",marginBottom:"0.25rem",fontSize:"0.875rem"},onClick:()=>n(!1),children:"Playground"}),e(_,{href:`${a}formulas/docs`,className:"btn btn-sm",style:{display:"block",fontSize:"0.875rem"},onClick:()=>n(!1),children:"Documentation"})]})]}),e("a",{href:"https://github.com/rpenfold/xl-formula",target:"_blank",rel:"noopener noreferrer",className:"btn btn-sm",children:"GitHub"}),e("a",{href:"https://www.npmjs.com/package/@velox/formulas",target:"_blank",rel:"noopener noreferrer",className:"btn btn-sm btn-primary",children:"npm install"})]})]})]})]})}const K="/velox/";function Z(){return e("div",{children:[e("section",{style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",padding:"6rem 0"},children:e("div",{className:"container",style:{textAlign:"center"},children:[e("h1",{className:"text-3xl font-bold mb-4",style:{fontSize:"3rem",marginBottom:"1.5rem"},children:"Velox"}),e("p",{className:"text-xl mb-8",style:{fontSize:"1.25rem",marginBottom:"2rem",opacity:.9},children:"High-performance libraries for modern web applications"}),e("div",{className:"flex gap-4",style:{justifyContent:"center",flexWrap:"wrap"},children:[e(P,{href:`${K}formulas`,className:"btn btn-primary",style:{background:"white",color:"#4f46e5",padding:"0.875rem 1.25rem",fontSize:"0.95rem",textDecoration:"none",marginBottom:"0.5rem",flex:"0 1 200px",minWidth:"140px",maxWidth:"220px"},children:"Explore Formulas"}),e("a",{href:"https://github.com/rpenfold/xl-formula",target:"_blank",rel:"noopener noreferrer",className:"btn",style:{background:"rgba(255,255,255,0.1)",border:"1px solid rgba(255,255,255,0.3)",color:"white",padding:"0.875rem 1.25rem",fontSize:"0.95rem",textDecoration:"none",marginBottom:"0.5rem",flex:"0 1 200px",minWidth:"140px",maxWidth:"220px"},children:"View on GitHub"})]})]})}),e("section",{style:{padding:"4rem 0"},children:e("div",{className:"container",children:e("div",{className:"grid grid-cols-2 gap-12 items-center",children:[e("div",{children:[e("h2",{className:"text-3xl font-bold mb-6",children:"Building the Future of Web Performance"}),e("p",{className:"text-lg mb-6",style:{color:"var(--color-text-secondary)"},children:"Velox is a collection of high-performance libraries designed to bring native-level performance to web applications. Our libraries are built with WebAssembly and modern web technologies to deliver exceptional speed and reliability."}),e("p",{className:"text-lg mb-8",style:{color:"var(--color-text-secondary)"},children:"Whether you're building data-intensive applications, real-time dashboards, or complex computational tools, Velox provides the performance foundation you need."})]}),e("div",{style:{textAlign:"center"},children:e("div",{style:{width:"12rem",height:"12rem",background:"var(--color-primary-light)",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto",fontSize:"4rem"},children:"âš¡"})})]})})}),e("section",{style:{padding:"4rem 0",background:"var(--color-bg-secondary)"},children:e("div",{className:"container",children:[e("h2",{className:"text-2xl font-bold mb-8",style:{textAlign:"center"},children:"Our Libraries"}),e("div",{className:"grid grid-cols-1 gap-8",style:{maxWidth:"800px",margin:"0 auto"},children:[e("div",{className:"card",style:{padding:"2rem",border:"1px solid var(--color-border)",borderRadius:"12px",background:"var(--color-bg)",transition:"transform 0.2s ease, box-shadow 0.2s ease"},children:e("div",{className:"flex items-center justify-between",children:[e("div",{children:[e("h3",{className:"text-xl font-bold mb-2",children:"Velox Formulas"}),e("p",{className:"text-muted mb-4",children:"High-performance Excel-like formula parser and evaluator. Supports 100+ Excel functions with WebAssembly-powered performance for complex calculations in the browser."}),e("div",{className:"flex gap-2",children:[e("span",{className:"badge",style:{background:"var(--color-primary-light)",color:"var(--color-primary)",padding:"0.25rem 0.5rem",borderRadius:"4px",fontSize:"0.75rem"},children:"WebAssembly"}),e("span",{className:"badge",style:{background:"var(--color-primary-light)",color:"var(--color-primary)",padding:"0.25rem 0.5rem",borderRadius:"4px",fontSize:"0.75rem"},children:"Excel Compatible"}),e("span",{className:"badge",style:{background:"var(--color-primary-light)",color:"var(--color-primary)",padding:"0.25rem 0.5rem",borderRadius:"4px",fontSize:"0.75rem"},children:"TypeScript"})]})]}),e(P,{href:`${K}formulas`,className:"btn btn-primary",style:{background:"var(--color-primary)",color:"white",padding:"0.5rem 1rem",textDecoration:"none",borderRadius:"6px",fontSize:"0.875rem"},children:"Learn More"})]})}),e("div",{className:"card",style:{padding:"2rem",border:"1px solid var(--color-border)",borderRadius:"12px",background:"var(--color-bg)",opacity:.6},children:e("div",{className:"flex items-center justify-between",children:[e("div",{children:[e("h3",{className:"text-xl font-bold mb-2",children:"More Libraries Coming Soon"}),e("p",{className:"text-muted mb-4",children:"We're working on additional high-performance libraries for data processing, visualization, and more. Stay tuned for updates!"}),e("div",{className:"flex gap-2",children:e("span",{className:"badge",style:{background:"var(--color-bg-secondary)",color:"var(--color-text-secondary)",padding:"0.25rem 0.5rem",borderRadius:"4px",fontSize:"0.75rem"},children:"Coming Soon"})})]}),e("button",{className:"btn",style:{background:"var(--color-bg-secondary)",color:"var(--color-text-secondary)",padding:"0.5rem 1rem",border:"1px solid var(--color-border)",borderRadius:"6px",fontSize:"0.875rem",cursor:"not-allowed"},disabled:!0,children:"Coming Soon"})]})})]})]})}),e("section",{style:{padding:"4rem 0"},children:e("div",{className:"container",children:[e("h2",{className:"text-2xl font-bold mb-8",style:{textAlign:"center"},children:"Why Choose Velox?"}),e("div",{className:"grid grid-cols-3 gap-8",children:[e("div",{className:"card",style:{textAlign:"center"},children:[e("div",{style:{width:"3rem",height:"3rem",background:"var(--color-primary-light)",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 1rem"},children:"ðŸš€"}),e("h3",{className:"font-semibold mb-2",children:"Native Performance"}),e("p",{className:"text-muted",children:"WebAssembly compilation delivers near-native performance in the browser"})]}),e("div",{className:"card",style:{textAlign:"center"},children:[e("div",{style:{width:"3rem",height:"3rem",background:"var(--color-primary-light)",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 1rem"},children:"ðŸ› ï¸"}),e("h3",{className:"font-semibold mb-2",children:"Developer Experience"}),e("p",{className:"text-muted",children:"TypeScript support, comprehensive documentation, and easy integration"})]}),e("div",{className:"card",style:{textAlign:"center"},children:[e("div",{style:{width:"3rem",height:"3rem",background:"var(--color-primary-light)",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 1rem"},children:"ðŸ”’"}),e("h3",{className:"font-semibold mb-2",children:"Production Ready"}),e("p",{className:"text-muted",children:"Battle-tested libraries with comprehensive test coverage and active maintenance"})]})]})]})})]})}const ee="/velox/";function pe(){return e("div",{children:[e("section",{style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",padding:"6rem 0"},children:e("div",{className:"container",style:{textAlign:"center"},children:[e("h1",{className:"text-3xl font-bold mb-4",style:{fontSize:"3rem",marginBottom:"1.5rem"},children:"Velox Formulas"}),e("p",{className:"text-xl mb-8",style:{fontSize:"1.25rem",marginBottom:"2rem",opacity:.9},children:"High-performance Excel-like formula parser and evaluator for web applications"}),e("div",{className:"flex gap-4",style:{justifyContent:"center",flexWrap:"wrap"},children:[e(P,{href:`${ee}formulas/playground`,className:"btn btn-primary",style:{background:"white",color:"#4f46e5",padding:"0.875rem 1.25rem",fontSize:"0.95rem",textDecoration:"none",marginBottom:"0.5rem",flex:"0 1 200px",minWidth:"140px",maxWidth:"220px"},children:"Try Playground"}),e(P,{href:`${ee}formulas/docs`,className:"btn",style:{background:"rgba(255,255,255,0.1)",border:"1px solid rgba(255,255,255,0.3)",color:"white",padding:"0.875rem 1.25rem",fontSize:"0.95rem",textDecoration:"none",marginBottom:"0.5rem",flex:"0 1 200px",minWidth:"140px",maxWidth:"220px"},children:"Documentation"})]})]})}),e("section",{style:{padding:"4rem 0"},children:e("div",{className:"container",children:[e("h2",{className:"text-2xl font-bold mb-8",style:{textAlign:"center"},children:"Why Velox Formulas?"}),e("div",{className:"grid grid-cols-3 gap-8",children:[e("div",{className:"card",style:{textAlign:"center"},children:[e("div",{style:{width:"3rem",height:"3rem",background:"var(--color-primary-light)",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 1rem"},children:"âš¡"}),e("h3",{className:"font-semibold mb-2",children:"Lightning Fast"}),e("p",{className:"text-muted",children:"Compiled to WebAssembly for near-native performance in the browser"})]}),e("div",{className:"card",style:{textAlign:"center"},children:[e("div",{style:{width:"3rem",height:"3rem",background:"var(--color-primary-light)",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 1rem"},children:"ðŸ“Š"}),e("h3",{className:"font-semibold mb-2",children:"Excel Compatible"}),e("p",{className:"text-muted",children:"Supports 100+ Excel functions with familiar syntax and behavior"})]}),e("div",{className:"card",style:{textAlign:"center"},children:[e("div",{style:{width:"3rem",height:"3rem",background:"var(--color-primary-light)",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 1rem"},children:"ðŸ”§"}),e("h3",{className:"font-semibold mb-2",children:"Easy Integration"}),e("p",{className:"text-muted",children:"Simple JavaScript API with TypeScript support and zero dependencies"})]})]})]})}),e("section",{style:{padding:"4rem 0",background:"var(--color-bg-secondary)"},children:e("div",{className:"container",children:[e("h2",{className:"text-2xl font-bold mb-8",style:{textAlign:"center"},children:"Quick Start"}),e("div",{className:"grid grid-cols-2 gap-8",children:[e("div",{children:[e("h3",{className:"font-semibold mb-4",children:"Installation"}),e("pre",{className:"p-4 rounded",style:{background:"var(--color-bg)",border:"1px solid var(--color-border)",fontFamily:"var(--font-mono)",fontSize:"0.875rem",overflowX:"auto"},children:e("code",{children:"npm install @velox/formulas"})})]}),e("div",{children:[e("h3",{className:"font-semibold mb-4",children:"Basic Usage"}),e("pre",{className:"p-4 rounded",style:{background:"var(--color-bg)",border:"1px solid var(--color-border)",fontFamily:"var(--font-mono)",fontSize:"0.875rem",overflowX:"auto"},children:e("code",{children:`import XLFormula from '@velox/formulas'

await XLFormula.init()
const result = XLFormula.evaluate('SUM(1,2,3)')
if (result.isSuccess()) {
  console.log(result.getValue().asNumber()) // 6
}`})})]})]})]})})]})}const fe={datetime:{functions:{DATE:{name:"DATE",description:"Creates a date from year, month, and day",syntax:"DATE(year, month, day)",parameters:[{name:"year",description:"Year value",required:!0},{name:"month",description:"Month value (1-12)",required:!0},{name:"day",description:"Day value (1-31)",required:!0}],examples:[{formula:"DATE(2024,1,15)",result:"2024-01-15 00:00:00",description:""}],nonStandard:!1},EDATE:{name:"EDATE",description:"Returns the date n months before/after start_date",syntax:"EDATE(start_date, months)",parameters:[{name:"start_date",description:"Starting date",required:!0},{name:"months",description:"Number of months before (negative) or after (positive)",required:!0}],examples:[{formula:"EDATE(DATE(2024,1,31), 1)",result:"2024-02-29 00:00:00",description:""}],nonStandard:!1},EOMONTH:{name:"EOMONTH",description:"Returns the last day of the month n months before/after start_date",syntax:"EOMONTH(start_date, months)",parameters:[{name:"start_date",description:"Starting date",required:!0},{name:"months",description:"Number of months before (negative) or after (positive)",required:!0}],examples:[{formula:"EOMONTH(DATE(2024,1,15), 1)",result:"2024-02-29 00:00:00",description:""}],nonStandard:!1},DATEVALUE:{name:"DATEVALUE",description:"Converts a date in text to a date value",syntax:"DATEVALUE(date_text)",parameters:[{name:"date_text",description:"Date string (e.g., 2024-01-15)",required:!0}],examples:[{formula:'DATEVALUE("2024-01-15")',result:"2024-01-15 00:00:00",description:""}],nonStandard:!1},TIMEVALUE:{name:"TIMEVALUE",description:"Converts a time in text to a fraction of a day",syntax:"TIMEVALUE(time_text)",parameters:[{name:"time_text",description:"Time string (e.g., 14:30:00 or 1:30 PM)",required:!0}],examples:[{formula:'TIMEVALUE("12:00:00")',result:"0.5",description:""}],nonStandard:!1},DATEDIF:{name:"DATEDIF",description:"",syntax:"DATEDIF()",parameters:[],examples:[],nonStandard:!1},DAY:{name:"DAY",description:"",syntax:"DAY()",parameters:[],examples:[],nonStandard:!1},HOUR:{name:"HOUR",description:"",syntax:"HOUR()",parameters:[],examples:[],nonStandard:!1},MINUTE:{name:"MINUTE",description:"",syntax:"MINUTE()",parameters:[],examples:[],nonStandard:!1},MONTH:{name:"MONTH",description:"",syntax:"MONTH()",parameters:[],examples:[],nonStandard:!1},NOW:{name:"NOW",description:"Returns the current date and time",syntax:"NOW()",parameters:[],examples:[{formula:"NOW()",result:"2025-08-11 10:00:00",description:""}],nonStandard:!1},SECOND:{name:"SECOND",description:"",syntax:"SECOND()",parameters:[],examples:[],nonStandard:!1},TIME:{name:"TIME",description:"",syntax:"TIME()",parameters:[],examples:[],nonStandard:!1},TODAY:{name:"TODAY",description:"Returns the current date (without time)",syntax:"TODAY()",parameters:[],examples:[{formula:"TODAY()",result:"2025-08-11 00:00:00",description:""}],nonStandard:!1},WEEKDAY:{name:"WEEKDAY",description:"",syntax:"WEEKDAY()",parameters:[],examples:[],nonStandard:!1},YEAR:{name:"YEAR",description:"",syntax:"YEAR()",parameters:[],examples:[],nonStandard:!1},NS_UNIXTIME:{name:"NS_UNIXTIME",description:"[Non-Standard] Returns Unix epoch seconds for a given date",syntax:"NS_UNIXTIME(date)",parameters:[{name:"date",description:"Date/time value to convert",required:!0}],examples:[{formula:"NS_UNIXTIME(NOW())",result:"1697040000",description:""}],nonStandard:!0},NS_NEARESTDATE:{name:"NS_NEARESTDATE",description:"[Non-Standard] Returns the date closest to the current time from a list/array",syntax:"NS_NEARESTDATE(dates, â€¦)",parameters:[{name:"dates",description:"Array of dates or variadic list of date arguments",required:!0}],examples:[{formula:"NS_NEARESTDATE({TODAY()-1, TODAY(), TODAY()+2})",result:"2025-01-01",description:""},{formula:"NS_NEARESTDATE(TODAY()-1, TODAY()+3)",result:"2024-12-31",description:""}],nonStandard:!0},NS_FURTHESTDATE:{name:"NS_FURTHESTDATE",description:"[Non-Standard] Returns the date farthest from the current time from a list/array",syntax:"NS_FURTHESTDATE(dates, â€¦)",parameters:[{name:"dates",description:"Array of dates or variadic list of date arguments",required:!0}],examples:[{formula:"NS_FURTHESTDATE({TODAY()-1, TODAY()+3})",result:"2025-01-03",description:""},{formula:"NS_FURTHESTDATE(TODAY()-10, TODAY()+2, TODAY()+5)",result:"2024-12-22",description:""}],nonStandard:!0}}},engineering:{functions:{BIN2DEC:{name:"BIN2DEC",description:"Converts a binary number to decimal",syntax:"BIN2DEC(number)",parameters:[{name:"number",description:"Binary string (up to 10 bits; two's complement for negatives)",required:!0}],examples:[{formula:'BIN2DEC("1010")',result:"10",description:""}],nonStandard:!1},BIN2OCT:{name:"BIN2OCT",description:"Converts a binary number to octal",syntax:"BIN2OCT(number)",parameters:[{name:"number",description:"Binary string (up to 10 bits)",required:!0}],examples:[{formula:'BIN2OCT("1111111111")',result:'"1777"',description:""}],nonStandard:!1},BITAND:{name:"BITAND",description:"Returns a bitwise AND of two numbers",syntax:"BITAND(number1, number2)",parameters:[{name:"number1",description:"First number",required:!0},{name:"number2",description:"Second number",required:!0}],examples:[{formula:"BITAND(5, 3)",result:"1",description:""}],nonStandard:!1},BITOR:{name:"BITOR",description:"Returns a bitwise OR of two numbers",syntax:"BITOR(number1, number2)",parameters:[{name:"number1",description:"First number",required:!0},{name:"number2",description:"Second number",required:!0}],examples:[{formula:"BITOR(5, 3)",result:"7",description:""}],nonStandard:!1},BITXOR:{name:"BITXOR",description:"Returns a bitwise XOR of two numbers",syntax:"BITXOR(number1, number2)",parameters:[{name:"number1",description:"First number",required:!0},{name:"number2",description:"Second number",required:!0}],examples:[{formula:"BITXOR(5, 3)",result:"6",description:""}],nonStandard:!1},COMPLEX:{name:"COMPLEX",description:"Creates a complex number from real and imaginary parts",syntax:"COMPLEX(real_num, i_num, suffix)",parameters:[{name:"real_num",description:"Real coefficient",required:!0},{name:"i_num",description:"Imaginary coefficient",required:!0},{name:"suffix",description:"Suffix for imaginary part (optional; i or j)",required:!0}],examples:[{formula:"COMPLEX(3, -4)",result:'"3-4i"',description:""}],nonStandard:!1},CONVERT:{name:"CONVERT",description:"Converts a number from one measurement system to another",syntax:"CONVERT(number, from_unit, to_unit)",parameters:[{name:"number",description:"Value to convert",required:!0},{name:"from_unit",description:"Unit to convert from",required:!0},{name:"to_unit",description:"Unit to convert to",required:!0}],examples:[{formula:'CONVERT(32,"F","C")',result:"0",description:""}],nonStandard:!1},DEC2BIN:{name:"DEC2BIN",description:"Converts a decimal number to binary",syntax:"DEC2BIN(number, [places])",parameters:[{name:"number",description:"Decimal number (range -512 to 511)",required:!0},{name:"places",description:"Number of characters to use",required:!1}],examples:[{formula:"DEC2BIN(10)",result:'"1010"',description:""}],nonStandard:!1},DEC2HEX:{name:"DEC2HEX",description:"Converts a decimal number to hexadecimal",syntax:"DEC2HEX(number, [places])",parameters:[{name:"number",description:"Decimal number (range per Excel limits)",required:!0},{name:"places",description:"Number of characters to use",required:!1}],examples:[{formula:"DEC2HEX(255)",result:'"FF"',description:""}],nonStandard:!1},DEC2OCT:{name:"DEC2OCT",description:"Converts a decimal number to octal",syntax:"DEC2OCT(number, [places])",parameters:[{name:"number",description:"Decimal number (range per Excel limits)",required:!0},{name:"places",description:"Number of characters to use",required:!1}],examples:[{formula:"DEC2OCT(8)",result:'"10"',description:""}],nonStandard:!1},HEX2DEC:{name:"HEX2DEC",description:"Converts a hexadecimal number to decimal",syntax:"HEX2DEC(number)",parameters:[{name:"number",description:"Hex string (up to 10 hex digits; two's complement for negatives)",required:!0}],examples:[{formula:'HEX2DEC("FF")',result:"255",description:""}],nonStandard:!1},HEX2OCT:{name:"HEX2OCT",description:"Converts a hexadecimal number to octal",syntax:"HEX2OCT(number)",parameters:[{name:"number",description:"Hex string (up to 10 hex digits)",required:!0}],examples:[{formula:'HEX2OCT("FF")',result:'"377"',description:""}],nonStandard:!1},IMAGINARY:{name:"IMAGINARY",description:"Returns the imaginary coefficient of a complex number",syntax:"IMAGINARY(inumber)",parameters:[{name:"inumber",description:"Complex number as text",required:!0}],examples:[{formula:'IMAGINARY("3-4i")',result:"-4",description:""}],nonStandard:!1},IMREAL:{name:"IMREAL",description:"Returns the real coefficient of a complex number",syntax:"IMREAL(inumber)",parameters:[{name:"inumber",description:"Complex number as text",required:!0}],examples:[{formula:'IMREAL("3-4i")',result:"3",description:""}],nonStandard:!1},OCT2BIN:{name:"OCT2BIN",description:"Converts an octal number to binary",syntax:"OCT2BIN(number)",parameters:[{name:"number",description:"Octal string (up to 10 digits)",required:!0}],examples:[{formula:'OCT2BIN("1777")',result:'"1111111111"',description:""}],nonStandard:!1},OCT2HEX:{name:"OCT2HEX",description:"Converts an octal number to hexadecimal",syntax:"OCT2HEX(number)",parameters:[{name:"number",description:"Octal string (up to 10 digits)",required:!0}],examples:[{formula:'OCT2HEX("377")',result:'"FF"',description:""}],nonStandard:!1}}},financial:{functions:{FV:{name:"FV",description:"Returns the future value of an investment",syntax:"FV(rate, nper, pmt, [pv], [type])",parameters:[{name:"rate",description:"Interest rate per period",required:!0},{name:"nper",description:"Number of payment periods",required:!0},{name:"pmt",description:"Payment made each period",required:!0},{name:"pv",description:"Present value",required:!1},{name:"type",description:"Payment timing: 0=end of period, 1=beginning",required:!1}],examples:[{formula:"FV(0.05, 10, -100, 0, 0)",result:"1257.79",description:""}],nonStandard:!1},IRR:{name:"IRR",description:"Returns the internal rate of return for a series of cash flows",syntax:"IRR(values, [guess])",parameters:[{name:"values",description:"Cash flow values (array or arguments)",required:!0},{name:"guess",description:"Initial guess for IRR",required:!1}],examples:[{formula:"IRR({-1000, 300, 400, 500})",result:"0.1296",description:""}],nonStandard:!1},MIRR:{name:"MIRR",description:"Returns the modified internal rate of return for a series of cash flows",syntax:"MIRR(values, finance_rate, reinvest_rate)",parameters:[{name:"values",description:"Cash flow values (array or arguments)",required:!0},{name:"finance_rate",description:"Interest rate for financing costs",required:!0},{name:"reinvest_rate",description:"Interest rate for reinvestment",required:!0}],examples:[{formula:"MIRR({-1000, 300, 400, 500}, 0.1, 0.12)",result:"0.1342",description:""}],nonStandard:!1},NPER:{name:"NPER",description:"Returns the number of periods for an investment",syntax:"NPER(rate, pmt, pv, [fv], [type])",parameters:[{name:"rate",description:"Interest rate per period",required:!0},{name:"pmt",description:"Payment made each period",required:!0},{name:"pv",description:"Present value",required:!0},{name:"fv",description:"Future value",required:!1},{name:"type",description:"Payment timing: 0=end of period, 1=beginning",required:!1}],examples:[{formula:"NPER(0.05, -100, 1000)",result:"14.21",description:""}],nonStandard:!1},NPV:{name:"NPV",description:"Returns the net present value of an investment based on a series of cash flows",syntax:"NPV(rate, value1, value2)",parameters:[{name:"rate",description:"Discount rate per period",required:!0},{name:"value1",description:"First cash flow value or array",required:!0},{name:"value2",description:"Additional cash flow values (optional, variadic)",required:!0}],examples:[{formula:"NPV(0.1, -1000, 300, 400, 500)",result:"18.78",description:""}],nonStandard:!1},PMT:{name:"PMT",description:"Returns the periodic payment for an annuity",syntax:"PMT(rate, nper, pv, [fv], [type])",parameters:[{name:"rate",description:"Interest rate per period",required:!0},{name:"nper",description:"Number of payment periods",required:!0},{name:"pv",description:"Present value",required:!0},{name:"fv",description:"Future value",required:!1},{name:"type",description:"Payment timing: 0=end of period, 1=beginning",required:!1}],examples:[{formula:"PMT(0.06/12, 360, 200000)",result:"-1199.10",description:""}],nonStandard:!1},PV:{name:"PV",description:"Returns the present value of an investment",syntax:"PV(rate, nper, pmt, [fv], [type])",parameters:[{name:"rate",description:"Interest rate per period",required:!0},{name:"nper",description:"Number of payment periods",required:!0},{name:"pmt",description:"Payment made each period",required:!0},{name:"fv",description:"Future value",required:!1},{name:"type",description:"Payment timing: 0=end of period, 1=beginning",required:!1}],examples:[{formula:"PV(0.08, 10, -100, 0, 0)",result:"671.01",description:""}],nonStandard:!1},RATE:{name:"RATE",description:"Returns the interest rate per period of an annuity",syntax:"RATE(nper, pmt, pv, [fv], [type], [guess])",parameters:[{name:"nper",description:"Number of payment periods",required:!0},{name:"pmt",description:"Payment made each period",required:!0},{name:"pv",description:"Present value",required:!0},{name:"fv",description:"Future value",required:!1},{name:"type",description:"Payment timing: 0=end of period, 1=beginning",required:!1},{name:"guess",description:"Initial guess for rate",required:!1}],examples:[{formula:"RATE(10, -100, 1000)",result:"0.0507",description:""}],nonStandard:!1}}},logical:{functions:{AND:{name:"AND",description:"Returns TRUE if all arguments are TRUE",syntax:"AND(logical1, logical2)",parameters:[{name:"logical1",description:"First logical value",required:!0},{name:"logical2",description:"Additional logical values (optional, variadic)",required:!0}],examples:[{formula:'AND(TRUE, 1, "text")',result:"TRUE",description:""}],nonStandard:!1},FALSE:{name:"FALSE",description:"Returns the logical value FALSE",syntax:"FALSE()",parameters:[],examples:[{formula:"FALSE()",result:"FALSE",description:""}],nonStandard:!1},IF:{name:"IF",description:"Returns one value if condition is TRUE, another if FALSE",syntax:"IF(logical_test, value_if_true, value_if_false)",parameters:[{name:"logical_test",description:"Condition to evaluate",required:!0},{name:"value_if_true",description:"Value to return if condition is TRUE",required:!0},{name:"value_if_false",description:"Value to return if condition is FALSE",required:!0}],examples:[{formula:'IF(5>3,"Yes","No")',result:'"Yes"',description:""}],nonStandard:!1},IFERROR:{name:"IFERROR",description:"Returns value_if_error if value is an error; otherwise returns value",syntax:"IFERROR(value, value_if_error)",parameters:[{name:"value",description:"Value to check for error",required:!0},{name:"value_if_error",description:"Value to return if value is an error",required:!0}],examples:[{formula:"IFERROR(1/0, 42)",result:"42",description:""}],nonStandard:!1},IFNA:{name:"IFNA",description:"Returns value_if_na if value is the #N/A error; otherwise returns value",syntax:"IFNA(value, value_if_na)",parameters:[{name:"value",description:"Value to check for #N/A",required:!0},{name:"value_if_na",description:"Value to return if value is #N/A",required:!0}],examples:[{formula:"IFNA(#N/A, 0)",result:"0",description:""}],nonStandard:!1},IFS:{name:"IFS",description:"Checks multiple conditions and returns result for first TRUE condition",syntax:"IFS(condition1, result1, condition2/result2)",parameters:[{name:"condition1",description:"First logical condition to test",required:!0},{name:"result1",description:"Result to return if condition1 is TRUE",required:!0},{name:"condition2/result2",description:"Additional pairs (optional, variadic)",required:!0}],examples:[{formula:'IFS(FALSE, "First", TRUE, "Second")',result:'"Second"',description:""}],nonStandard:!1},ISBLANK:{name:"ISBLANK",description:"Returns TRUE if the value is empty",syntax:"ISBLANK(value)",parameters:[{name:"value",description:"Value to test",required:!0}],examples:[{formula:'ISBLANK("")',result:"TRUE",description:""}],nonStandard:!1},ISERROR:{name:"ISERROR",description:"Returns TRUE if the value is an error",syntax:"ISERROR(value)",parameters:[{name:"value",description:"Value to test",required:!0}],examples:[{formula:"ISERROR(#DIV/0!)",result:"TRUE",description:""}],nonStandard:!1},ISNUMBER:{name:"ISNUMBER",description:"Returns TRUE if the value is a number or convertible to a number",syntax:"ISNUMBER(value)",parameters:[{name:"value",description:"Value to test",required:!0}],examples:[{formula:'ISNUMBER("123")',result:"TRUE",description:""}],nonStandard:!1},ISTEXT:{name:"ISTEXT",description:"Returns TRUE if the value is text",syntax:"ISTEXT(value)",parameters:[{name:"value",description:"Value to test",required:!0}],examples:[{formula:'ISTEXT("abc")',result:"TRUE",description:""}],nonStandard:!1},NOT:{name:"NOT",description:"Returns the opposite of a logical value",syntax:"NOT(logical)",parameters:[{name:"logical",description:"Logical value to negate",required:!0}],examples:[{formula:"NOT(TRUE)",result:"FALSE",description:""}],nonStandard:!1},OR:{name:"OR",description:"Returns TRUE if any argument is TRUE",syntax:"OR(logical1, logical2)",parameters:[{name:"logical1",description:"First logical value",required:!0},{name:"logical2",description:"Additional logical values (optional, variadic)",required:!0}],examples:[{formula:'OR(FALSE, 0, "")',result:"FALSE",description:""}],nonStandard:!1},SWITCH:{name:"SWITCH",description:"Compares an expression against multiple values and returns corresponding result",syntax:"SWITCH(expression, value1, result1, value2/result2, default)",parameters:[{name:"expression",description:"The value to compare against",required:!0},{name:"value1",description:"First value to compare, followed by result1",required:!0},{name:"result1",description:"Result to return if value1 matches",required:!0},{name:"value2/result2",description:"Additional pairs (optional, variadic)",required:!0},{name:"default",description:"Optional default value if no match",required:!0}],examples:[{formula:'SWITCH(2, 1, "One", 2, "Two", 3, "Three")',result:'"Two"',description:""}],nonStandard:!1},TRUE:{name:"TRUE",description:"Returns the logical value TRUE",syntax:"TRUE()",parameters:[],examples:[{formula:"TRUE()",result:"TRUE",description:""}],nonStandard:!1},XOR:{name:"XOR",description:"Returns TRUE if an odd number of arguments are TRUE",syntax:"XOR(logical1, logical2)",parameters:[{name:"logical1",description:"First logical value",required:!0},{name:"logical2",description:"Additional logical values (optional, variadic)",required:!0}],examples:[{formula:"XOR(TRUE, TRUE, TRUE)",result:"TRUE",description:""}],nonStandard:!1}}},lookup:{functions:{CHOOSE:{name:"CHOOSE",description:"Chooses a value from a list of values",syntax:"CHOOSE(index, value1, value2, â€¦)",parameters:[{name:"index",description:"1-based index of the value to return",required:!0},{name:"value1",description:"First value",required:!0},{name:"value2",description:"Additional values",required:!0}],examples:[{formula:'CHOOSE(2,"A","B","C")',result:'"B"',description:""}],nonStandard:!1},ROW:{name:"ROW",description:"Returns the row number of a reference (stubbed)",syntax:"ROW([reference])",parameters:[{name:"reference",description:"Reference",required:!1}],examples:[{formula:"ROW()",result:"1",description:""}],nonStandard:!1},COLUMN:{name:"COLUMN",description:"Returns the column number of a reference (stubbed)",syntax:"COLUMN([reference])",parameters:[{name:"reference",description:"Reference",required:!1}],examples:[{formula:"COLUMN()",result:"1",description:""}],nonStandard:!1}}},math:{functions:{ABS:{name:"ABS",description:"Returns the absolute value of a number",syntax:"ABS(number)",parameters:[{name:"number",description:"Number to convert to absolute value",required:!0}],examples:[{formula:"ABS(-5)",result:"5",description:""}],nonStandard:!1},ACOS:{name:"ACOS",description:"Returns the arccosine of a number",syntax:"ACOS(number)",parameters:[{name:"number",description:"Value in range [-1, 1]",required:!0}],examples:[{formula:"ACOS(1)",result:"0",description:""}],nonStandard:!1},ASIN:{name:"ASIN",description:"Returns the arcsine of a number",syntax:"ASIN(number)",parameters:[{name:"number",description:"Value in range [-1, 1]",required:!0}],examples:[{formula:"ASIN(0)",result:"0",description:""}],nonStandard:!1},ATAN:{name:"ATAN",description:"Returns the arctangent of a number",syntax:"ATAN(number)",parameters:[{name:"number",description:"Value whose arctangent is returned",required:!0}],examples:[{formula:"ATAN(1)",result:"PI()/4",description:""}],nonStandard:!1},ATAN2:{name:"ATAN2",description:"Returns the arctangent of y/x, using the signs of both arguments to determine the quadrant",syntax:"ATAN2(y, x)",parameters:[{name:"y",description:"The y-coordinate",required:!0},{name:"x",description:"The x-coordinate",required:!0}],examples:[{formula:"ATAN2(1, 1)",result:"PI()/4",description:""}],nonStandard:!1},AVERAGE:{name:"AVERAGE",description:"Returns the average (arithmetic mean) of the arguments",syntax:"AVERAGE([number1], number2, â€¦)",parameters:[{name:"number1",description:"First number",required:!1},{name:"number2",description:"Additional numbers",required:!0}],examples:[{formula:"AVERAGE(1,2,3,4,5)",result:"3",description:""}],nonStandard:!1},AVERAGEIF:{name:"AVERAGEIF",description:"Returns the average of values that meet a condition",syntax:"AVERAGEIF(range, criteria, [average_range])",parameters:[{name:"range",description:"Range to test against the criterion",required:!0},{name:"criteria",description:"Condition to evaluate",required:!0},{name:"average_range",description:"Values to average",required:!1}],examples:[{formula:'AVERAGEIF(3, "=3", 5)',result:"5",description:""}],nonStandard:!1},AVERAGEIFS:{name:"AVERAGEIFS",description:"Returns the average of values that meet multiple conditions",syntax:"AVERAGEIFS(average_range, criteria_range1, criteria1, criteria_range2, criteria2)",parameters:[{name:"average_range",description:"Values to average",required:!0},{name:"criteria_range1",description:"First range to test",required:!0},{name:"criteria1",description:"First condition",required:!0},{name:"criteria_range2",description:"Additional ranges (optional, variadic)",required:!0},{name:"criteria2",description:"Additional conditions (optional, variadic)",required:!0}],examples:[{formula:'AVERAGEIFS(5, 3, "=3")',result:"5",description:""}],nonStandard:!1},CEILING:{name:"CEILING",description:"Rounds a number up to the nearest multiple of significance",syntax:"CEILING(number, [significance])",parameters:[{name:"number",description:"The number to round up",required:!0},{name:"significance",description:"The multiple to round up to",required:!1}],examples:[{formula:"CEILING(4.3)",result:"5",description:""}],nonStandard:!1},COMBIN:{name:"COMBIN",description:"Returns the number of combinations for a given number of items",syntax:"COMBIN(n, k)",parameters:[{name:"n",description:"Total number of items",required:!0},{name:"k",description:"Number of items in each combination",required:!0}],examples:[{formula:"COMBIN(5, 2)",result:"10",description:""}],nonStandard:!1},CORREL:{name:"CORREL",description:"Pearson correlation coefficient between two data sets",syntax:"CORREL(array1, array2)",parameters:[{name:"array1",description:"First range or array",required:!0},{name:"array2",description:"Second range or array",required:!0}],examples:[{formula:"CORREL([1,2,3,4],[2,4,6,8])",result:"1",description:""}],nonStandard:!1},PEARSON:{name:"CORREL",description:"Pearson correlation coefficient between two data sets",syntax:"CORREL(array1, array2)",parameters:[{name:"array1",description:"First range or array",required:!0},{name:"array2",description:"Second range or array",required:!0}],examples:[{formula:"CORREL([1,2,3,4],[2,4,6,8])",result:"1",description:""}],nonStandard:!1},RSQ:{name:"RSQ",description:"Returns the square of the Pearson correlation coefficient (R^2)",syntax:"RSQ(array_x, array_y)",parameters:[{name:"array_x",description:"First range or array",required:!0},{name:"array_y",description:"Second range or array",required:!0}],examples:[{formula:"RSQ([1,2,3,4],[2,4,6,8])",result:"1",description:""}],nonStandard:!1},SLOPE:{name:"SLOPE",description:"Returns the slope of the linear regression line through data points",syntax:"SLOPE(known_yâ€™s, known_xâ€™s)",parameters:[{name:"known_yâ€™s",description:"Dependent data points",required:!0},{name:"known_xâ€™s",description:"Independent data points",required:!0}],examples:[{formula:"SLOPE([2,4,6,8],[1,2,3,4])",result:"2",description:""}],nonStandard:!1},INTERCEPT:{name:"INTERCEPT",description:"Returns the y-intercept of the linear regression line through data points",syntax:"INTERCEPT(known_yâ€™s, known_xâ€™s)",parameters:[{name:"known_yâ€™s",description:"Dependent data points",required:!0},{name:"known_xâ€™s",description:"Independent data points",required:!0}],examples:[{formula:"INTERCEPT([2,4,6,8],[1,2,3,4])",result:"0",description:""}],nonStandard:!1},COVAR:{name:"COVAR",description:"Returns population covariance of two data sets (historical; same as COVARIANCE.P)",syntax:"COVAR(array_x, array_y)",parameters:[{name:"array_x",description:"First range or array",required:!0},{name:"array_y",description:"Second range or array",required:!0}],examples:[{formula:"COVAR([1,2,3],[2,4,6])",result:"1.3333",description:""}],nonStandard:!1},"COVARIANCE.P":{name:"COVARIANCE.P",description:"Population covariance (denominator N)",syntax:"COVARIANCE.P(array_x, array_y)",parameters:[{name:"array_x",description:"First range or array",required:!0},{name:"array_y",description:"Second range or array",required:!0}],examples:[{formula:"COVARIANCE.P([1,2,3],[2,4,6])",result:"1.3333",description:""}],nonStandard:!1},"COVARIANCE.S":{name:"COVARIANCE.S",description:"Sample covariance (denominator N-1)",syntax:"COVARIANCE.S(array_x, array_y)",parameters:[{name:"array_x",description:"First range or array",required:!0},{name:"array_y",description:"Second range or array",required:!0}],examples:[{formula:"COVARIANCE.S([1,2,3],[2,4,6])",result:"2",description:""}],nonStandard:!1},COVARIANCEIMPL:{name:"COVARIANCEIMPL",description:"",syntax:"COVARIANCEIMPL()",parameters:[],examples:[],nonStandard:!1},COVARIANCE_P:{name:"COVARIANCE_P",description:"",syntax:"COVARIANCE_P()",parameters:[],examples:[],nonStandard:!1},COVARIANCE_S:{name:"COVARIANCE_S",description:"",syntax:"COVARIANCE_S()",parameters:[],examples:[],nonStandard:!1},COS:{name:"COS",description:"Returns the cosine of an angle (in radians)",syntax:"COS(angle)",parameters:[{name:"angle",description:"Angle in radians",required:!0}],examples:[{formula:"COS(0)",result:"1",description:""}],nonStandard:!1},COSH:{name:"COSH",description:"Returns the hyperbolic cosine of a number",syntax:"COSH(number)",parameters:[{name:"number",description:"Value whose hyperbolic cosine is returned",required:!0}],examples:[{formula:"COSH(0)",result:"1",description:""}],nonStandard:!1},COUNT:{name:"COUNT",description:"Counts the number of numeric values among the arguments",syntax:"COUNT(value1, value2)",parameters:[{name:"value1",description:"First value or range",required:!0},{name:"value2",description:"Additional values (optional, variadic)",required:!0}],examples:[{formula:'COUNT(1, 2, "x")',result:"2",description:""}],nonStandard:!1},COUNTA:{name:"COUNTA",description:"Counts the number of non-empty values among the arguments",syntax:"COUNTA(value1, value2)",parameters:[{name:"value1",description:"First value or range",required:!0},{name:"value2",description:"Additional values (optional, variadic)",required:!0}],examples:[{formula:'COUNTA(1, "x", "")',result:"2",description:""}],nonStandard:!1},COUNTIF:{name:"COUNTIF",description:"Counts the number of values that meet a condition",syntax:"COUNTIF(range, criteria)",parameters:[{name:"range",description:"Values to test",required:!0},{name:"criteria",description:"Condition to evaluate",required:!0}],examples:[{formula:'COUNTIF({1,2,3}, ">=2")',result:"2",description:""}],nonStandard:!1},DEGREES:{name:"DEGREES",description:"Converts radians to degrees",syntax:"DEGREES(angle)",parameters:[{name:"angle",description:"Angle in radians",required:!0}],examples:[{formula:"DEGREES(PI())",result:"180",description:""}],nonStandard:!1},EVEN:{name:"EVEN",description:"Rounds a number up to the nearest even integer",syntax:"EVEN(number)",parameters:[{name:"number",description:"The value to round",required:!0}],examples:[{formula:"EVEN(3)",result:"4",description:""}],nonStandard:!1},EXP:{name:"EXP",description:"Returns e raised to the power of a number",syntax:"EXP(number)",parameters:[{name:"number",description:"Exponent",required:!0}],examples:[{formula:"EXP(1)",result:"2.7182818",description:""}],nonStandard:!1},FACT:{name:"FACT",description:"Returns the factorial of a number",syntax:"FACT(number)",parameters:[{name:"number",description:"Non-negative integer (n <= 170)",required:!0}],examples:[{formula:"FACT(5)",result:"120",description:""}],nonStandard:!1},FLOOR:{name:"FLOOR",description:"Rounds a number down to the nearest multiple of significance",syntax:"FLOOR(number, [significance])",parameters:[{name:"number",description:"The number to round down",required:!0},{name:"significance",description:"The multiple to round down to",required:!1}],examples:[{formula:"FLOOR(4.7)",result:"4",description:""}],nonStandard:!1},GCD:{name:"GCD",description:"Returns the greatest common divisor",syntax:"GCD(number1, number2)",parameters:[{name:"number1",description:"First integer",required:!0},{name:"number2",description:"Additional integers (optional, variadic)",required:!0}],examples:[{formula:"GCD(12, 18)",result:"6",description:""}],nonStandard:!1},INT:{name:"INT",description:"Rounds a number down to the nearest integer",syntax:"INT(number)",parameters:[{name:"number",description:"The number to round down",required:!0}],examples:[{formula:"INT(3.9)",result:"3",description:""}],nonStandard:!1},LCM:{name:"LCM",description:"Returns the least common multiple",syntax:"LCM(number1, number2)",parameters:[{name:"number1",description:"First integer",required:!0},{name:"number2",description:"Additional integers (optional, variadic)",required:!0}],examples:[{formula:"LCM(4, 6)",result:"12",description:""}],nonStandard:!1},LN:{name:"LN",description:"Returns the natural logarithm of a number",syntax:"LN(number)",parameters:[{name:"number",description:"Positive number",required:!0}],examples:[{formula:"LN(EXP(1))",result:"1",description:""}],nonStandard:!1},LOG:{name:"LOG",description:"Returns the logarithm of a number to a specified base (default base 10)",syntax:"LOG(number, base)",parameters:[{name:"number",description:"Positive number",required:!0},{name:"base",description:"Base of the logarithm (optional, default: 10)",required:!0}],examples:[{formula:"LOG(8, 2)",result:"3",description:""}],nonStandard:!1},LOG10:{name:"LOG10",description:"Returns the base-10 logarithm of a number",syntax:"LOG10(number)",parameters:[{name:"number",description:"Positive number",required:!0}],examples:[{formula:"LOG10(1000)",result:"3",description:""}],nonStandard:!1},MAX:{name:"MAX",description:"Returns the largest value among the arguments",syntax:"MAX([number1], number2, â€¦)",parameters:[{name:"number1",description:"First number",required:!1},{name:"number2",description:"Additional numbers",required:!0}],examples:[{formula:"MAX(10,20,5)",result:"20",description:""}],nonStandard:!1},MEDIAN:{name:"MEDIAN",description:"Returns the median (middle value) of the arguments",syntax:"MEDIAN(number1, number2)",parameters:[{name:"number1",description:"First number",required:!0},{name:"number2",description:"Additional numbers (optional, variadic)",required:!0}],examples:[{formula:"MEDIAN(1, 2, 3, 4)",result:"2.5",description:""}],nonStandard:!1},MIN:{name:"MIN",description:"Returns the smallest value among the arguments",syntax:"MIN([number1], number2, â€¦)",parameters:[{name:"number1",description:"First number",required:!1},{name:"number2",description:"Additional numbers",required:!0}],examples:[{formula:"MIN(10,20,5)",result:"5",description:""}],nonStandard:!1},MOD:{name:"MOD",description:"Returns the remainder after division",syntax:"MOD(number, divisor)",parameters:[{name:"number",description:"The number to divide (numerator)",required:!0},{name:"divisor",description:"The divisor",required:!0}],examples:[{formula:"MOD(10, 3)",result:"1",description:""}],nonStandard:!1},MODE:{name:"MODE",description:"Returns the most frequently occurring value",syntax:"MODE(number1, number2)",parameters:[{name:"number1",description:"First number",required:!0},{name:"number2",description:"Additional numbers (optional, variadic)",required:!0}],examples:[{formula:"MODE(1,2,2,3)",result:"2",description:""}],nonStandard:!1},MROUND:{name:"MROUND",description:"Rounds a number to the nearest multiple",syntax:"MROUND(number, multiple)",parameters:[{name:"number",description:"The value to round",required:!0},{name:"multiple",description:"The multiple to which to round",required:!0}],examples:[{formula:"MROUND(10, 3)",result:"9",description:""}],nonStandard:!1},ODD:{name:"ODD",description:"Rounds a number up to the nearest odd integer",syntax:"ODD(number)",parameters:[{name:"number",description:"The value to round",required:!0}],examples:[{formula:"ODD(2)",result:"3",description:""}],nonStandard:!1},PERMUT:{name:"PERMUT",description:"Returns the number of permutations for a given number of items",syntax:"PERMUT(n, k)",parameters:[{name:"n",description:"Total number of items",required:!0},{name:"k",description:"Number of items to arrange",required:!0}],examples:[{formula:"PERMUT(5, 3)",result:"60",description:""}],nonStandard:!1},PI:{name:"PI",description:"Returns the value of pi (Ï€)",syntax:"PI()",parameters:[],examples:[{formula:"PI()",result:"3.14159",description:""}],nonStandard:!1},POWER:{name:"POWER",description:"Returns a number raised to a power",syntax:"POWER(number, power)",parameters:[{name:"number",description:"The base number",required:!0},{name:"power",description:"The exponent",required:!0}],examples:[{formula:"POWER(2, 3)",result:"8",description:""}],nonStandard:!1},QUOTIENT:{name:"QUOTIENT",description:"Returns the integer portion of a division",syntax:"QUOTIENT(numerator, denominator)",parameters:[{name:"numerator",description:"Dividend",required:!0},{name:"denominator",description:"Divisor",required:!0}],examples:[{formula:"QUOTIENT(10, 3)",result:"3",description:""}],nonStandard:!1},RADIANS:{name:"RADIANS",description:"Converts degrees to radians",syntax:"RADIANS(angle)",parameters:[{name:"angle",description:"Angle in degrees",required:!0}],examples:[{formula:"RADIANS(180)",result:"PI()",description:""}],nonStandard:!1},RAND:{name:"RAND",description:"Returns a random number between 0 and 1",syntax:"RAND()",parameters:[],examples:[{formula:"RAND()",result:"0.1234",description:""}],nonStandard:!1},RANDBETWEEN:{name:"RANDBETWEEN",description:"Returns a random integer between bottom and top (inclusive)",syntax:"RANDBETWEEN(bottom, top)",parameters:[{name:"bottom",description:"Lowest integer to return",required:!0},{name:"top",description:"Highest integer to return",required:!0}],examples:[{formula:"RANDBETWEEN(1, 10)",result:"7",description:""}],nonStandard:!1},ROUND:{name:"ROUND",description:"Rounds a number to a specified number of digits",syntax:"ROUND(number, [num_digits])",parameters:[{name:"number",description:"Number to round",required:!0},{name:"num_digits",description:"Number of digits",required:!1}],examples:[{formula:"ROUND(3.14159,2)",result:"3.14",description:""}],nonStandard:!1},ROUNDDOWN:{name:"ROUNDDOWN",description:"Rounds a number down, toward zero",syntax:"ROUNDDOWN(number, num_digits)",parameters:[{name:"number",description:"The number to round down",required:!0},{name:"num_digits",description:"The number of digits to round to",required:!0}],examples:[{formula:"ROUNDDOWN(3.9, 0)",result:"3",description:""}],nonStandard:!1},ROUNDUP:{name:"ROUNDUP",description:"Rounds a number up, away from zero",syntax:"ROUNDUP(number, num_digits)",parameters:[{name:"number",description:"The number to round up",required:!0},{name:"num_digits",description:"The number of digits to round to",required:!0}],examples:[{formula:"ROUNDUP(3.2, 0)",result:"4",description:""}],nonStandard:!1},SIGN:{name:"SIGN",description:"Returns the sign of a number (1, 0, or -1)",syntax:"SIGN(number)",parameters:[{name:"number",description:"The number to test",required:!0}],examples:[{formula:"SIGN(-3)",result:"-1",description:""}],nonStandard:!1},SIN:{name:"SIN",description:"Returns the sine of an angle (in radians)",syntax:"SIN(angle)",parameters:[{name:"angle",description:"Angle in radians",required:!0}],examples:[{formula:"SIN(PI()/2)",result:"1",description:""}],nonStandard:!1},SINH:{name:"SINH",description:"Returns the hyperbolic sine of a number",syntax:"SINH(number)",parameters:[{name:"number",description:"Value whose hyperbolic sine is returned",required:!0}],examples:[{formula:"SINH(0)",result:"0",description:""}],nonStandard:!1},SQRT:{name:"SQRT",description:"Returns the square root of a number",syntax:"SQRT(number)",parameters:[{name:"number",description:"The number to get square root of",required:!0}],examples:[{formula:"SQRT(16)",result:"4",description:""}],nonStandard:!1},STDEV:{name:"STDEV",description:"Returns the standard deviation of a sample",syntax:"STDEV(number1, number2)",parameters:[{name:"number1",description:"First number",required:!0},{name:"number2",description:"Additional numbers (optional, variadic)",required:!0}],examples:[{formula:"STDEV(1,2,3)",result:"1",description:""}],nonStandard:!1},SUM:{name:"SUM",description:"Adds all numeric arguments",syntax:"SUM([number1], number2, â€¦)",parameters:[{name:"number1",description:"First number",required:!1},{name:"number2",description:"Additional numbers",required:!0}],examples:[{formula:"SUM(1,2,3)",result:"6",description:""}],nonStandard:!1},SUMIF:{name:"SUMIF",description:"Sums values that meet a condition",syntax:"SUMIF(range, criteria, sum_range)",parameters:[{name:"range",description:"Range to test against the criterion",required:!0},{name:"criteria",description:"Condition to evaluate",required:!0},{name:"sum_range",description:"Values to sum (optional; defaults to range)",required:!0}],examples:[{formula:'SUMIF(3, "=3", 5)',result:"5",description:""}],nonStandard:!1},SUMIFS:{name:"SUMIFS",description:"Sums values that meet multiple conditions",syntax:"SUMIFS(sum_range, criteria_range1, criteria1, criteria_range2, criteria2)",parameters:[{name:"sum_range",description:"Values to sum",required:!0},{name:"criteria_range1",description:"First range to test",required:!0},{name:"criteria1",description:"First condition",required:!0},{name:"criteria_range2",description:"Additional ranges (optional, variadic)",required:!0},{name:"criteria2",description:"Additional conditions (optional, variadic)",required:!0}],examples:[{formula:'SUMIFS(5, 3, "=3")',result:"5",description:""}],nonStandard:!1},SUMPRODUCT:{name:"SUMPRODUCT",description:"Returns the sum of the products of corresponding values",syntax:"SUMPRODUCT(array1, array2)",parameters:[{name:"array1",description:"First array or value",required:!0},{name:"array2",description:"Second array or value (optional, variadic)",required:!0}],examples:[{formula:"SUMPRODUCT(2,3,4)",result:"24",description:""}],nonStandard:!1},SUMSQ:{name:"SUMSQ",description:"",syntax:"SUMSQ()",parameters:[],examples:[],nonStandard:!1},SUMX2MY2:{name:"SUMX2MY2",description:"Sum of the difference of squares of corresponding values: Î£(x^2 âˆ’ y^2)",syntax:"SUMX2MY2(array_x, array_y)",parameters:[{name:"array_x",description:"First range or array",required:!0},{name:"array_y",description:"Second range or array",required:!0}],examples:[{formula:"SUMX2MY2([1,2],[3,4])",result:"-20",description:""}],nonStandard:!1},SUMX2PY2:{name:"SUMX2PY2",description:"Sum of the sum of squares of corresponding values: Î£(x^2 + y^2)",syntax:"SUMX2PY2(array_x, array_y)",parameters:[{name:"array_x",description:"First range or array",required:!0},{name:"array_y",description:"Second range or array",required:!0}],examples:[{formula:"SUMX2PY2([1,2],[3,4])",result:"30",description:""}],nonStandard:!1},SUMXMY2:{name:"SUMXMY2",description:"Sum of squares of differences of corresponding values: Î£(x âˆ’ y)^2",syntax:"SUMXMY2(array_x, array_y)",parameters:[{name:"array_x",description:"First range or array",required:!0},{name:"array_y",description:"Second range or array",required:!0}],examples:[{formula:"SUMXMY2([5,7],[2,4])",result:"18",description:""}],nonStandard:!1},TAN:{name:"TAN",description:"Returns the tangent of an angle (in radians)",syntax:"TAN(angle)",parameters:[{name:"angle",description:"Angle in radians",required:!0}],examples:[{formula:"TAN(PI()/4)",result:"1",description:""}],nonStandard:!1},TANH:{name:"TANH",description:"Returns the hyperbolic tangent of a number",syntax:"TANH(number)",parameters:[{name:"number",description:"Value whose hyperbolic tangent is returned",required:!0}],examples:[{formula:"TANH(0)",result:"0",description:""}],nonStandard:!1},TRUNC:{name:"TRUNC",description:"Truncates a number to an integer or to a specified number of digits",syntax:"TRUNC(number, num_digits, â€¦)",parameters:[{name:"number",description:"The number to truncate",required:!0},{name:"num_digits",description:"Number of digits (optional; negative truncates to tens, hundreds, ...)",required:!0}],examples:[{formula:"TRUNC(3.14159, 2)",result:"3.14",description:""}],nonStandard:!1},VAR:{name:"VAR",description:"Returns the variance of a sample",syntax:"VAR(number1, number2)",parameters:[{name:"number1",description:"First number",required:!0},{name:"number2",description:"Additional numbers (optional, variadic)",required:!0}],examples:[{formula:"VAR(1,2,3)",result:"1",description:""}],nonStandard:!1}}},text:{functions:{CHAR:{name:"CHAR",description:"Returns the character specified by a code number (1-255)",syntax:"CHAR(number)",parameters:[{name:"number",description:"Code number between 1 and 255",required:!0}],examples:[{formula:"CHAR(65)",result:'"A"',description:""}],nonStandard:!1},CLEAN:{name:"CLEAN",description:"Removes all nonprintable characters from text (ASCII < 32)",syntax:"CLEAN(text)",parameters:[{name:"text",description:"The text from which to remove nonprintable characters",required:!0}],examples:[{formula:'CLEAN("Hello\\nWorld")',result:'"HelloWorld"',description:""}],nonStandard:!1},CODE:{name:"CODE",description:"Returns a numeric code for the first character in a text string",syntax:"CODE(text)",parameters:[{name:"text",description:"The text to examine",required:!0}],examples:[{formula:'CODE("A")',result:"65",description:""}],nonStandard:!1},CONCATENATE:{name:"CONCATENATE",description:"Joins two or more text strings into one string",syntax:"CONCATENATE(text1, text2)",parameters:[{name:"text1",description:"The first text string",required:!0},{name:"text2",description:"Additional text strings (optional, variadic)",required:!0}],examples:[{formula:'CONCATENATE("Hello", " ", "World")',result:'"Hello World"',description:""}],nonStandard:!1},CONCAT:{name:"CONCATENATE",description:"Joins two or more text strings into one string",syntax:"CONCATENATE(text1, text2)",parameters:[{name:"text1",description:"The first text string",required:!0},{name:"text2",description:"Additional text strings (optional, variadic)",required:!0}],examples:[{formula:'CONCATENATE("Hello", " ", "World")',result:'"Hello World"',description:""}],nonStandard:!1},EXACT:{name:"EXACT",description:"Checks whether two text strings are exactly the same (case-sensitive)",syntax:"EXACT(text1, text2)",parameters:[{name:"text1",description:"First text string",required:!0},{name:"text2",description:"Second text string",required:!0}],examples:[{formula:'EXACT("Hello", "hello")',result:"FALSE",description:""}],nonStandard:!1},FIND:{name:"FIND",description:"Finds one text string within another (case-sensitive)",syntax:"FIND(find_text, within_text, [start_num])",parameters:[{name:"find_text",description:"Substring to find",required:!0},{name:"within_text",description:"Text to search within",required:!0},{name:"start_num",description:"Starting position",required:!1}],examples:[{formula:'FIND("lo", "Hello")',result:"4",description:""}],nonStandard:!1},LEFT:{name:"LEFT",description:"Returns the leftmost characters from a text string",syntax:"LEFT(text, [num_chars])",parameters:[{name:"text",description:"Input text",required:!0},{name:"num_chars",description:"Number of characters",required:!1}],examples:[{formula:'LEFT("Hello",2)',result:'"He"',description:""}],nonStandard:!1},LEN:{name:"LEN",description:"Returns the number of characters in a text string",syntax:"LEN(text)",parameters:[{name:"text",description:"Input text",required:!0}],examples:[{formula:'LEN("Hello")',result:"5",description:""}],nonStandard:!1},LOWER:{name:"LOWER",description:"Converts text to lowercase",syntax:"LOWER(text)",parameters:[{name:"text",description:"Text to convert",required:!0}],examples:[{formula:'LOWER("HELLO")',result:'"hello"',description:""}],nonStandard:!1},MID:{name:"MID",description:"Returns characters from the middle of a text string",syntax:"MID(text, start_num, num_chars)",parameters:[{name:"text",description:"Input text",required:!0},{name:"start_num",description:"Position of first character (1-based)",required:!0},{name:"num_chars",description:"Number of characters to extract",required:!0}],examples:[{formula:'MID("Hello World",7,5)',result:'"World"',description:""}],nonStandard:!1},PROPER:{name:"PROPER",description:"Capitalizes the first letter of each word in text",syntax:"PROPER(text)",parameters:[{name:"text",description:"The text to convert to proper case",required:!0}],examples:[{formula:'PROPER("hello world")',result:'"Hello World"',description:""}],nonStandard:!1},REPLACE:{name:"REPLACE",description:"Replaces part of a text string",syntax:"REPLACE(old_text, start_num, num_chars, new_text)",parameters:[{name:"old_text",description:"Original text",required:!0},{name:"start_num",description:"Position to start replacing (1-based)",required:!0},{name:"num_chars",description:"Number of characters to replace",required:!0},{name:"new_text",description:"Replacement text",required:!0}],examples:[{formula:'REPLACE("Hello", 2, 2, "i")',result:'"Hilo"',description:""}],nonStandard:!1},RIGHT:{name:"RIGHT",description:"Returns the rightmost characters from a text string",syntax:"RIGHT(text, [num_chars])",parameters:[{name:"text",description:"Input text",required:!0},{name:"num_chars",description:"Number of characters",required:!1}],examples:[{formula:'RIGHT("Hello",2)',result:'"lo"',description:""}],nonStandard:!1},ROMAN:{name:"ROMAN",description:"Converts an Arabic number to Roman numerals",syntax:"ROMAN(number)",parameters:[{name:"number",description:"Positive integer to convert to Roman numerals",required:!0}],examples:[{formula:"ROMAN(1987)",result:'"MCMLXXXVII"',description:""}],nonStandard:!1},ARABIC:{name:"ARABIC",description:"Converts Roman numerals to an Arabic number",syntax:"ARABIC(text)",parameters:[{name:"text",description:"Roman numeral string to convert",required:!0}],examples:[{formula:'ARABIC("IV")',result:"4",description:""}],nonStandard:!1},RPT:{name:"RPT",description:"",syntax:"RPT()",parameters:[],examples:[],nonStandard:!1},SEARCH:{name:"SEARCH",description:"Finds one text string within another (case-insensitive)",syntax:"SEARCH(find_text, within_text, [start_num])",parameters:[{name:"find_text",description:"Substring to find",required:!0},{name:"within_text",description:"Text to search within",required:!0},{name:"start_num",description:"Starting position",required:!1}],examples:[{formula:'SEARCH("LO", "Hello")',result:"4",description:""}],nonStandard:!1},SUBSTITUTE:{name:"SUBSTITUTE",description:"Substitutes new text for old text",syntax:"SUBSTITUTE(text, old_text, new_text, instance_num)",parameters:[{name:"text",description:"Original text",required:!0},{name:"old_text",description:"Text to replace",required:!0},{name:"new_text",description:"Replacement text",required:!0},{name:"instance_num",description:"Which occurrence to replace (optional; default all)",required:!0}],examples:[{formula:'SUBSTITUTE("a,b,c", ",", ";")',result:'"a;b;c"',description:""}],nonStandard:!1},T:{name:"T",description:"",syntax:"T()",parameters:[],examples:[],nonStandard:!1},TEXT:{name:"TEXT",description:"Formats a number as text according to a specified format",syntax:"TEXT(value, format_text)",parameters:[{name:"value",description:"Number to format",required:!0},{name:"format_text",description:"Format pattern (e.g., 0.00, 0%)",required:!0}],examples:[{formula:'TEXT(123.456, "0.00")',result:'"123.46"',description:""}],nonStandard:!1},TEXTJOIN:{name:"TEXTJOIN",description:"",syntax:"TEXTJOIN()",parameters:[],examples:[],nonStandard:!1},TRIM:{name:"TRIM",description:"Removes leading and trailing spaces from text",syntax:"TRIM(text)",parameters:[{name:"text",description:"The text to trim",required:!0}],examples:[{formula:'TRIM("  Hello  ")',result:'"Hello"',description:""}],nonStandard:!1},UNICHAR:{name:"UNICHAR",description:"",syntax:"UNICHAR()",parameters:[],examples:[],nonStandard:!1},UNICODE:{name:"UNICODE",description:"",syntax:"UNICODE()",parameters:[],examples:[],nonStandard:!1},UPPER:{name:"UPPER",description:"Converts text to uppercase",syntax:"UPPER(text)",parameters:[{name:"text",description:"Text to convert",required:!0}],examples:[{formula:'UPPER("hello")',result:'"HELLO"',description:""}],nonStandard:!1},VALUE:{name:"VALUE",description:"Converts text that represents a number to a number",syntax:"VALUE(text)",parameters:[{name:"text",description:"The text to convert",required:!0}],examples:[{formula:'VALUE("$1,234.00")',result:"1234",description:""}],nonStandard:!1}}}},U={};Object.entries(fe||{}).forEach(([a,f])=>{U[a]={name:a.charAt(0).toUpperCase()+a.slice(1),description:"",functions:{...(f==null?void 0:f.functions)||{}}}});U.all={name:"All Functions",description:"All available functions across all categories",functions:{}};const xe=()=>{const a=[];return Object.entries(U).forEach(([f,n])=>{f!=="all"&&Object.entries(n.functions).forEach(([h,l])=>{a.push({...l,category:f,categoryName:n.name})})}),a},he=()=>{const a=xe(),f={};return a.forEach(n=>{f[n.name]=n}),U.all.functions=f,U};he();const be="modulepreload",ge=function(a){return"/velox/"+a},re={},G=function(f,n,h){let l=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const u=document.querySelector("meta[property=csp-nonce]"),d=(u==null?void 0:u.nonce)||(u==null?void 0:u.getAttribute("nonce"));l=Promise.allSettled(n.map(o=>{if(o=ge(o),o in re)return;re[o]=!0;const i=o.endsWith(".css"),A=i?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${o}"]${A}`))return;const v=document.createElement("link");if(v.rel=i?"stylesheet":be,i||(v.as="script"),v.crossOrigin="",v.href=o,d&&v.setAttribute("nonce",d),document.head.appendChild(v),i)return new Promise((t,s)=>{v.addEventListener("load",t),v.addEventListener("error",()=>s(new Error(`Unable to preload CSS for ${o}`)))})}))}function c(u){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=u,window.dispatchEvent(d),!d.defaultPrevented)throw u}return l.then(u=>{for(const d of u||[])d.status==="rejected"&&c(d.reason);return f().catch(c)})};function ye({func:a,category:f,categoryName:n}){var C;const[h,l]=R(((C=a.examples[0])==null?void 0:C.formula)||""),[c,u]=R(""),[d,o]=R(null),[i,A]=R(null),[v,t]=R(!1);B(()=>{s()},[]),B(()=>{d&&h&&N()},[h,d]);const s=async()=>{try{const m=await G(()=>import("./formula-wrapper-B6H7nW3V.js"),__vite__mapDeps([0,1,2]));console.log("ðŸ” XL Formula module loaded:",m),await m.default.init(),console.log("ðŸ” XL Formula initialized successfully");const y=new m.default.FormulaEngine;console.log("ðŸ” FormulaEngine created:",y);const S=y.evaluate("SUM(1,2,3)");if(S.isSuccess()){const T=S.getValue();console.log("ðŸ” XL Formula test result:",T.asNumber())}try{const T=y.evaluate("NOW()");if(T.isSuccess()){const W=T.getValue();console.log("ðŸ” NOW() test result:",W.asText())}}catch(T){console.error("ðŸ” NOW() test failed:",T)}o(y)}catch(m){throw console.error("ðŸ” Failed to initialize XL Formula:",m),m}},N=()=>{if(!(!d||!h))try{const m=h.startsWith("=")?h.substring(1):h;console.log("ðŸ” FunctionDetail runTest:",{formula:m,xlFormula:d,hasEvaluate:typeof d.evaluate=="function"});const y=d.evaluate(m);if(y.isSuccess()){const S=y.getValue(),T=b(S);console.log("ðŸ” evaluate result:",T,"Type:",S.getTypeName()),u(String(T))}else{const S=y.getErrorMessage()||"Unknown error";console.error("ðŸ” evaluate error:",S),u(`Error: ${S}`)}}catch(m){console.error("ðŸ” FunctionDetail error:",m),u(`Error: ${m.message}`)}},b=m=>{if(m.isNumber()){const y=m.asNumber();return Number.isInteger(y)?y.toString():y.toFixed(6).replace(/\.?0+$/,"")}else{if(m.isBoolean())return m.asBoolean()?"TRUE":"FALSE";if(m.isError())return m.getErrorText()}return m.asText()},g=async()=>{var m;if(!(!d||!h)){t(!0),A(null);try{const S=h.startsWith("=")?h.substring(1):h,T=(m=S.split("(")[0])==null?void 0:m.trim().toUpperCase(),W=T==null?void 0:T.startsWith("NS_");console.log("Running benchmark with XL Formula implementation"),console.log("Formula:",S),d.evaluate(S);const H=performance.now();let I;for(let D=0;D<1e5;D++){const k=d.evaluate(S);k.isSuccess()&&(I=k.getValue())}const X=performance.now()-H;console.log("XL Formula result:",I,"Time:",X,"ms");let M=null,O=null,F=!0;if(W)F=!1;else try{const D=new te,k=D.parse(S);if(k.error)F=!1;else{O=k.result,D.parse(S);const z=performance.now();for(let $=0;$<1e5;$++)D.parse(S);M=performance.now()-z,console.log("Hot-formula-parser result:",O,"Time:",M,"ms")}}catch(D){console.warn("Hot-formula-parser benchmark failed:",D),F=!1}let q=!1;O!==null&&(typeof I=="number"&&typeof O=="number"?q=Math.abs(I-O)<.001:q=String(I)===String(O)),!q&&O!==null&&console.warn("Results don't match! XL:",I,"(",typeof I,") Hot-formula-parser:",O,"(",typeof O,")"),A({xlFormula:X,hotFormulaParser:F?M:null,hotFormulaSupported:F,iterations:1e5,speedup:F&&M?(M/X).toFixed(2):null,xlResult:I,hotFormulaResult:O,resultsMatch:F&&O!==null?q:null})}catch(y){console.error("Benchmark failed:",y),A({error:y.message,xlFormula:null,hotFormulaParser:null,iterations:0,speedup:null})}finally{t(!1)}}};return e("div",{children:[e("div",{style:{marginBottom:"2rem"},children:[e("div",{style:{marginBottom:"0.25rem"},children:[e("div",{style:{display:"inline-flex",alignItems:"center",gap:"0.4rem",marginBottom:"0"},children:[e("span",{className:"text-xs rounded",style:{background:"var(--color-primary-light)",color:"var(--color-primary)",padding:"2px 8px"},children:n}),a.nonStandard&&e("span",{className:"text-xs rounded",title:"Non-Standard function",style:{background:"var(--color-warning-light)",color:"var(--color-warning)",padding:"2px 8px"},children:"Non-Standard"})]}),e("h1",{className:"text-3xl font-mono font-bold",style:{overflowWrap:"anywhere"},children:a.name})]}),e("p",{className:"text-lg text-muted",children:a.description})]}),e("div",{className:"grid grid-cols-2 gap-8",style:{gap:"1rem"},children:[e("div",{children:[e("div",{className:"card mb-6",children:[e("h3",{className:"font-semibold mb-4",children:"Syntax & Parameters"}),e("div",{className:"mb-4",children:[e("div",{className:"text-sm font-medium mb-2",children:"Syntax"}),e("div",{className:"font-mono p-3 rounded",style:{background:"var(--color-bg-secondary)",overflowX:"auto"},children:a.syntax})]}),e("div",{children:[e("div",{className:"text-sm font-medium mb-3",children:"Parameters"}),a.parameters.length>0?e("div",{className:"grid gap-3",children:[a.parameters.map((m,y)=>e("div",{className:"flex gap-3",style:{flexWrap:"wrap"},children:[e("div",{className:"font-mono text-sm font-medium",style:{minWidth:"100px"},children:[m.name,m.required&&e("span",{className:"text-error",children:"*"})]}),e("div",{className:"text-sm text-muted",children:m.description})]},y)),e("div",{className:"text-xs text-muted mt-2",children:"* Required parameter"})]}):e("p",{className:"text-muted text-sm",children:"This function takes no parameters."})]})]}),e("div",{className:"card",children:[e("h3",{className:"font-semibold mb-3",children:"Examples"}),e("div",{className:"grid gap-4",children:a.examples.map((m,y)=>e("div",{className:"p-3 rounded",style:{background:"var(--color-bg-secondary)",overflowX:"auto"},children:[e("div",{className:"flex justify-between items-start mb-2",style:{flexWrap:"wrap"},children:[e("code",{className:"font-mono text-sm",children:m.formula}),e("span",{className:"text-sm text-success",children:m.result})]}),e("div",{className:"text-xs text-muted",children:m.description})]},y))})]})]}),e("div",{children:[e("div",{className:"card mb-6",children:[e("h3",{className:"font-semibold mb-3",children:"Try It Out"}),e("label",{className:"label",children:"Formula"}),e("input",{type:"text",value:h,onChange:m=>l(m.target.value),className:"input monospace mb-3",placeholder:"Enter a formula to test",style:{minWidth:"180px",width:"100%"}}),e("div",{className:"p-3 rounded",style:{background:"var(--color-success-light)",border:"1px solid var(--color-success)",color:"var(--color-text)",overflowX:"auto"},children:[e("div",{className:"flex justify-between items-center",style:{flexWrap:"wrap"},children:[e("strong",{children:"Result:"}),e("button",{onClick:N,className:"btn btn-sm",children:"Run Test"})]}),e("div",{className:"font-mono mt-2",children:c||'Click "Run Test" to see result'})]}),e("div",{className:"mt-4",children:[e("h4",{className:"font-medium mb-2",children:"Quick Examples"}),e("div",{className:"grid gap-2",children:a.examples.map((m,y)=>e("button",{onClick:()=>l(m.formula),className:"btn btn-sm text-left",style:{justifyContent:"flex-start",width:"100%"},children:e("code",{className:"font-mono text-xs",children:m.formula})},y))})]})]}),e("div",{className:"card",children:[e("h3",{className:"font-semibold mb-3",children:"Performance Benchmark"}),e("p",{className:"text-sm text-muted mb-4",children:"Compare XL Formula performance against Hot Formula Parser"}),e("button",{onClick:g,disabled:v||!h,className:"btn btn-primary mb-4",style:{width:"100%"},children:v?"Running Benchmark...":"Run Benchmark"}),i&&e("div",{className:"grid gap-3",children:i.error?e("div",{className:"p-3 rounded",style:{background:"var(--color-error-light)",color:"var(--color-error)"},children:[e("strong",{children:"Benchmark Error:"})," ",i.error]}):e(V,{children:[e("div",{className:"flex justify-between",children:[e("span",{children:"XL Formula:"}),e("span",{className:"font-mono",children:i.xlFormula?`${i.xlFormula.toFixed(2)}ms`:"N/A"})]}),e("div",{className:"flex justify-between",children:[e("span",{children:"Hot Formula Parser:"}),e("span",{className:"font-mono",children:i.hotFormulaSupported===!1?"Not supported":i.hotFormulaParser?`${i.hotFormulaParser.toFixed(2)}ms`:"N/A"})]}),i.hotFormulaSupported!==!1&&i.speedup&&e("div",{className:"flex justify-between font-semibold",children:[e("span",{children:"Speedup:"}),e("span",{className:i.speedup>1?"text-success":"text-error",children:i.speedup>1?`${i.speedup}x faster`:`${(1/parseFloat(i.speedup)).toFixed(2)}x slower`})]}),i.hotFormulaSupported!==!1&&i.resultsMatch!==null&&e("div",{className:"flex justify-between text-xs",children:[e("span",{children:"Results match:"}),e("span",{className:i.resultsMatch?"text-success":"text-error",children:[i.resultsMatch?"âœ“ Yes":"âœ— No",!i.resultsMatch&&` (XL: ${i.xlResult}, HFP: ${i.hotFormulaResult})`]})]}),e("div",{className:"text-xs text-muted",children:["Tested with ",i.iterations.toLocaleString()," iterations"]})]})}),!i&&!v&&e("div",{className:"text-sm text-muted",children:'Enter a formula above and click "Run Benchmark" to compare performance against Hot Formula Parser.'})]})]})]})]})}const L="/velox/";function j({category:a,function:f}){const n=a||"all",h=f||null,[l,c]=R(""),[u,d]=R(!1);B(()=>{!a&&!f&&window.location.pathname===`${L}docs`&&oe(`${L}docs/all`,!0)},[a,f]);const o=U[n],i=h&&(o==null?void 0:o.functions[h.toUpperCase()]),v=(()=>{if(!o)return[];const t=Object.entries(o.functions);let s;if(!l.trim())s=t;else{const N=l.toLowerCase();s=t.filter(([b,g])=>g.name.toLowerCase().includes(N)||g.description.toLowerCase().includes(N)||g.syntax.toLowerCase().includes(N))}return s.sort(([N,b],[g,C])=>b.name.localeCompare(C.name))})();return h&&i?e("div",{className:"container",style:{padding:"2rem 0"},children:[e("div",{className:"mb-6",children:e("nav",{className:"flex items-center gap-2 text-sm text-muted hide-mobile",children:[e(P,{href:`${L}docs`,style:{textDecoration:"none",color:"var(--color-primary)"},children:"Documentation"}),e("span",{children:"â†’"}),e(P,{href:`${L}docs/${n}`,style:{textDecoration:"none",color:"var(--color-primary)"},children:o==null?void 0:o.name}),e("span",{children:"â†’"}),e("span",{children:i.name})]})}),e(ye,{func:i,category:i.category||n,categoryName:i.categoryName||o.name})]}):e("div",{className:"container",style:{padding:"2rem 0"},children:[e("h1",{className:"text-2xl font-bold mb-6",children:"Documentation"}),e("button",{className:"btn btn-sm show-mobile",style:{marginBottom:"1rem",width:"100%"},onClick:()=>d(!0),children:"Browse Categories"}),u&&e(V,{children:[e("div",{className:"sidebar-mobile-backdrop",onClick:()=>d(!1)}),e("div",{className:"sidebar-mobile-drawer open",children:[e("div",{style:{padding:"1rem",borderBottom:"1px solid var(--color-border)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e("span",{className:"text-xl font-bold",style:{color:"var(--color-primary)"},children:"Categories"}),e("button",{className:"btn btn-sm",style:{background:"none",border:"none",fontSize:"1.5rem"},"aria-label":"Close menu",onClick:()=>d(!1),children:"Ã—"})]}),e("nav",{style:{display:"flex",flexDirection:"column",padding:"1rem"},children:Object.entries(U).sort(([t],[s])=>t==="all"?-1:s==="all"?1:t.localeCompare(s)).map(([t,s])=>{const b={all:"ðŸ“š",math:"ðŸ”¢",text:"ðŸ“",logical:"ðŸ”€",datetime:"ðŸ“…",financial:"ðŸ’°",engineering:"âš™ï¸"}[t]||"ðŸ“„",g=t==="datetime"?"Date / Time":s.name;return e(P,{href:`${L}docs/${t}`,className:`btn btn-sm${n===t?" btn-primary":""}`,style:{marginBottom:"0.5rem",textAlign:"left"},onClick:()=>d(!1),children:[e("span",{style:{marginRight:"0.75rem"},children:b}),g]},t)})})]})]}),e("div",{style:{display:"flex",gap:"2rem"},children:[e("div",{className:"hide-mobile",style:{width:"25%",minWidth:"250px"},children:e("div",{className:"card",children:[e("h3",{className:"font-semibold mb-4",children:"Categories"}),e("div",{className:"grid gap-2",children:Object.entries(U).sort(([t],[s])=>t==="all"?-1:s==="all"?1:t.localeCompare(s)).map(([t,s])=>{const b={all:"ðŸ“š",math:"ðŸ”¢",text:"ðŸ“",logical:"ðŸ”€",datetime:"ðŸ“…",financial:"ðŸ’°",engineering:"âš™ï¸"}[t]||"ðŸ“„",g=t==="datetime"?"Date / Time":s.name;return e(P,{href:`${L}docs/${t}`,className:`p-3 rounded text-sm ${n===t?"bg-primary text-white":"hover:bg-secondary"}`,style:{textDecoration:"none",display:"block",background:n===t?"var(--color-primary)":"transparent",color:n===t?"white":"var(--color-text)"},children:e("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e("span",{style:{fontSize:"1.2rem"},children:b}),e("div",{children:[e("div",{className:"font-medium",children:g}),e("div",{className:"text-xs opacity-80",children:[Object.keys(s.functions).length," functions"]})]})]})},t)})})]})}),e("div",{style:{flex:1},children:e("div",{className:"card",children:[e("div",{className:"flex justify-between items-center mb-4",style:{flexWrap:"wrap"},children:[e("h3",{className:"font-semibold",children:o==null?void 0:o.name}),e("div",{className:"text-sm text-muted",children:[v.length," function",v.length!==1?"s":"",l&&` matching "${l}"`]})]}),e("div",{className:"mb-4",children:e("input",{type:"text",placeholder:"Search functions...",value:l,onChange:t=>c(t.target.value),onInput:t=>c(t.target.value),onKeyUp:t=>c(t.target.value),style:{width:"100%",padding:"8px 12px",border:"1px solid var(--color-border)",borderRadius:"4px",fontSize:"14px"}})}),e("p",{className:"text-sm text-muted mb-4",children:o==null?void 0:o.description}),e("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:v.length>0?v.map(([t,s])=>e(P,{href:`${L}docs/${n}/${t.toLowerCase()}`,className:"p-3 rounded border hover:border-primary",style:{textDecoration:"none",display:"block",border:"1px solid var(--color-border)",color:"var(--color-text)"},children:[e("div",{className:"font-mono font-medium text-sm",style:{color:"var(--color-text)"},children:s.name}),e("div",{className:"text-xs text-muted mt-1",children:s.description})]},t)):e("div",{className:"col-span-full text-center py-8 text-muted",children:[e("div",{className:"text-lg mb-2",children:"No functions found"}),e("div",{className:"text-sm",children:l?`No functions match "${l}"`:"No functions in this category"})]})})]})})]})]})}function ve({formula:a="SUM(1,2,3,4,5)",compact:f=!1}){var o,i,A,v;const[n,h]=R({}),[l,c]=R(!0);B(()=>{d()},[a]);const u=()=>{d()},d=async()=>{c(!0);const t={};try{t.importTest="attempting...";try{const s=await G(()=>import("./formula-wrapper-B6H7nW3V.js"),__vite__mapDeps([0,1,2]));t.importTest="success",t.module=Object.keys(s),t.initTest="attempting...",await s.default.init(),t.initTest="success",t.calcTest="attempting...";const N=a.startsWith("=")?a.substring(1):a;try{const b=s.default.evaluate(N);if(b.isSuccess()){const g=b.getValue();t.calcTest=`success: ${g.asText()}`,t.isReal=!0;const C=1e4,m=performance.now();for(let S=0;S<C;S++)s.default.evaluate(N);const y=performance.now()-m;t.xlPerformance=`${y.toFixed(2)}ms for ${C} iterations`}else t.calcTest=`failed: ${b.getErrorMessage()}`,t.xlPerformance="Skipped (invalid formula)",t.isReal=!1}catch(b){t.calcTest=`failed: ${b.message}`,t.xlPerformance="Skipped (invalid formula)",t.isReal=!1}}catch(s){t.importTest=`failed: ${s.message}`,t.error=s.toString(),t.isReal=!1}try{const N=new te,b=a.startsWith("=")?a.substring(1):a,g=N.parse(b);if(g.error)t.hotFormulaParserPerformance=`Skipped (${g.error})`;else{const C=performance.now();for(let y=0;y<1e4;y++)N.parse(b);const m=performance.now()-C;t.hotFormulaParserPerformance=`${m.toFixed(2)}ms for 10000 iterations`}}catch(s){t.hotFormulaParserError=s.toString()}try{const s=await fetch("/packages/web/xl-formula.wasm");t.wasmFileCheck=s.ok?"accessible":`failed: ${s.status}`}catch(s){t.wasmFileCheck=`failed: ${s.message}`}try{const s=await fetch("/packages/web/xl-formula-wrapper.js");t.wrapperFileCheck=s.ok?"accessible":`failed: ${s.status}`}catch(s){t.wrapperFileCheck=`failed: ${s.message}`}}catch(s){t.generalError=s.toString()}h(t),c(!1)};return l?e("div",{children:"Running diagnostic..."}):f?e("div",{className:"text-xs text-muted",children:l?e("span",{children:"Benchmarking..."}):e(V,{children:n.error?e("span",{children:"Benchmark error"}):e(V,{children:[n.xlPerformance&&n.hotFormulaParserPerformance&&!n.xlPerformance.includes("Skipped")&&!n.hotFormulaParserPerformance.includes("Skipped")&&e("div",{children:(()=>{var g,C,m;const t=parseFloat(((g=n.xlPerformance.match(/(\d+\.?\d*)/))==null?void 0:g[1])||"0"),s=parseFloat(((C=n.hotFormulaParserPerformance.match(/(\d+\.?\d*)/))==null?void 0:C[1])||"0"),N=((m=n.xlPerformance.match(/(\d+(?:,\d+)*) iterations/))==null?void 0:m[1])||"10000",b=s/t;return e(V,{children:[e("div",{children:["XL Formula: ",t,"ms â€¢ Hot Formula Parser: ",s,"ms (",N," iterations)"]}),e("div",{className:b>1?"text-success":"text-error",children:b>1?`${b.toFixed(1)}x faster`:`${(1/b).toFixed(1)}x slower`})]})})()}),(((o=n.calcTest)==null?void 0:o.includes("failed"))||((i=n.hotFormulaParserPerformance)==null?void 0:i.includes("Skipped")))&&e("span",{children:"Benchmark skipped"})]})})}):e("div",{className:"card",children:[e("div",{className:"flex justify-between items-center mb-3",children:[e("h3",{className:"font-semibold",children:"Performance Benchmark"}),e("button",{onClick:u,className:"btn btn-sm",disabled:l,children:l?"Running...":"Refresh"})]}),e("p",{className:"text-sm text-muted mb-3",children:["Formula: ",e("code",{className:"font-mono",children:a})]}),n.error?e("div",{className:"p-3 rounded text-sm",style:{background:"var(--color-error-light)",color:"var(--color-error)"},children:[e("strong",{children:"Error:"})," ",n.error]}):e("div",{className:"grid gap-3",children:[n.xlPerformance&&n.hotFormulaParserPerformance&&e(V,{children:[e("div",{className:"flex justify-between",children:[e("span",{children:"XL Formula:"}),e("span",{className:"font-mono",children:n.xlPerformance})]}),e("div",{className:"flex justify-between",children:[e("span",{children:"Hot Formula Parser:"}),e("span",{className:"font-mono",children:n.hotFormulaParserPerformance})]}),n.xlPerformance&&n.hotFormulaParserPerformance&&!n.xlPerformance.includes("Skipped")&&!n.hotFormulaParserPerformance.includes("Skipped")&&e("div",{className:"flex justify-between font-semibold pt-2 border-t",children:[e("span",{children:"Performance:"}),e("span",{className:"text-success",children:(()=>{var b,g;const t=parseFloat(((b=n.xlPerformance.match(/(\d+\.?\d*)/))==null?void 0:b[1])||"0"),N=parseFloat(((g=n.hotFormulaParserPerformance.match(/(\d+\.?\d*)/))==null?void 0:g[1])||"0")/t;return N>1?`${N.toFixed(1)}x faster`:`${(1/N).toFixed(1)}x slower`})()})]})]}),(((A=n.calcTest)==null?void 0:A.includes("failed"))||((v=n.hotFormulaParserPerformance)==null?void 0:v.includes("Skipped")))&&e("div",{className:"text-sm text-muted",children:"Invalid formula - benchmark skipped"})]})]})}function Ne(){const[a,f]=R("=SUM(1, 2, 3, 4, 5)"),[n,h]=R(""),[l,c]=R(""),[u,d]=R(!1),[o,i]=R([{name:"A1",value:"10"},{name:"B1",value:"20"},{name:"C1",value:"30"}]),[A,v]=R(""),[t,s]=R(""),[N,b]=R(null),[g,C]=R(null),[m,y]=R(!0),[S,T]=R([]),[W,H]=R(!1),[I,X]=R("");B(()=>{const r=localStorage.getItem("xl-formula-saved");if(r)try{const p=JSON.parse(r).map(E=>typeof E=="string"?{formula:E,name:null,variables:[],timestamp:new Date().toISOString()}:E);T(p)}catch(x){console.warn("Failed to parse saved formulas from localStorage",x)}else{const x=localStorage.getItem("xl-formula-history");if(x)try{const E=JSON.parse(x).map(w=>typeof w=="string"?{formula:w,name:null,variables:[],timestamp:new Date().toISOString()}:w);T(E),localStorage.setItem("xl-formula-saved",JSON.stringify(E)),localStorage.removeItem("xl-formula-history")}catch(p){console.warn("Failed to migrate formula history",p)}}},[]);const M=(r,x=null)=>{if(console.log("saveFormula called with:",{formula:r,name:x,variables:o}),!r||r.trim()===""){console.log("Formula is empty, not saving");return}const p={formula:r,name:x||null,variables:[...o],timestamp:new Date().toISOString()};console.log("Creating saved item:",p);const E=[p,...S.filter(w=>(typeof w=="string"?w:w.formula)!==r)].slice(0,20);console.log("New saved formulas array:",E),T(E),localStorage.setItem("xl-formula-saved",JSON.stringify(E)),console.log("Saved to localStorage:",localStorage.getItem("xl-formula-saved"))};B(()=>{O()},[]);const O=async()=>{try{const r=await G(()=>import("./formula-wrapper-B6H7nW3V.js"),__vite__mapDeps([0,1,2]));await r.default.init();const x=new r.default.FormulaEngine;o.forEach(({name:p,value:E})=>{x.setVariable(p,F(E))}),b(r.default),C(x),y(!1),q(a,x)}catch(r){throw console.error("Failed to initialize Velox:",r),y(!1),r}},F=r=>{const x=parseFloat(r);if(!isNaN(x)&&isFinite(x))return x;const p=r.toLowerCase();return p==="true"||p==="false"?p==="true":r},q=(r,x=g)=>{if(!x||!r.trim()){h(""),c("empty"),d(!1);return}try{const p=x.evaluate(r);if(p.isSuccess()){const E=p.getValue();h(D(E)),c(E.getTypeName()),d(!0)}else h(p.getErrorMessage()||"Unknown error"),c("error"),d(!1)}catch(p){h(`Error: ${p.message}`),c("error"),d(!1)}},D=r=>{if(r.isNumber()){const x=r.asNumber();return Number.isInteger(x)?x.toString():x.toFixed(6).replace(/\.?0+$/,"")}else{if(r.isBoolean())return r.asBoolean()?"TRUE":"FALSE";if(r.isError())return r.getErrorText()}return r.asText()},k=()=>{if(!A||!t)return;const r={name:A,value:t};i([...o,r]),g&&(g.setVariable(A,F(t)),q(a)),v(""),s("")},z=r=>{i(o.filter(x=>x.name!==r)),g&&(g.removeVariable(r),q(a))},$=r=>{console.log("Loading saved formula:",r);const x=typeof r=="string"?r:r.formula,p=typeof r=="object"?r.variables:[];console.log("Extracted formula:",x,"variables:",p),f(x),p&&p.length>0?(console.log("Restoring variables:",p),i(p),g&&(o.forEach(E=>{console.log("Removing variable:",E.name),g.removeVariable(E.name)}),p.forEach(({name:E,value:w})=>{console.log("Setting variable:",E,"=",w),g.setVariable(E,F(w))}))):console.log("No variables to restore"),q(x)},ae=r=>{f(r),q(r)};return m?e("div",{className:"container",style:{padding:"4rem 0",textAlign:"center"},children:e("div",{children:"Loading Velox engine..."})}):e("div",{className:"container",style:{padding:"2rem 0"},children:[e("h1",{className:"text-2xl font-bold mb-6",children:"Formula Playground"}),e("div",{className:"card mb-6",children:[e("label",{className:"label",children:"Formula"}),e("div",{className:"flex gap-2 mb-4",style:{flexWrap:"wrap"},children:[e("input",{type:"text",value:a,onChange:r=>{f(r.target.value),q(r.target.value)},className:"input monospace flex-1",placeholder:"Enter a formula like =SUM(1, 2, 3) or =A1 + B1",style:{minWidth:"180px",flex:1}}),e("button",{onClick:()=>{H(!0)},className:"btn btn-sm",disabled:!a.trim(),style:{minWidth:"100px"},children:"Save"})]}),e("div",{className:"p-4 rounded",style:{background:u?"var(--color-success-light)":"var(--color-error-light)",border:`1px solid ${u?"var(--color-success)":"var(--color-error)"}`,color:"var(--color-text)",fontFamily:"var(--font-mono)"},children:[e("div",{className:"flex justify-between items-center",style:{flexWrap:"wrap"},children:[e("strong",{children:"Result:"}),e("span",{className:"text-sm",children:l})]}),e("div",{className:"flex justify-between items-center",style:{marginTop:"0.5rem",flexWrap:"wrap"},children:[e("div",{style:{fontSize:"1.1rem"},children:n||"Enter a formula to see the result"}),n&&e("div",{style:{marginLeft:"1rem",minWidth:"120px"},children:e(ve,{formula:a,compact:!0})})]})]})]}),S.length>0&&e("div",{className:"card mb-6",children:[e("div",{className:"flex justify-between items-center mb-4",style:{flexWrap:"wrap"},children:[e("h3",{className:"font-semibold",children:["Saved Formulas (",S.length,")"]}),e("button",{onClick:()=>{T([]),localStorage.removeItem("xl-formula-saved")},className:"btn btn-sm",style:{fontSize:"0.75rem",minWidth:"100px"},children:"Clear All"})]}),e("div",{className:"grid gap-2",children:S.map((r,x)=>e("div",{onClick:()=>$(r),className:"p-3 rounded cursor-pointer flex justify-between items-center",style:{background:"var(--color-bg-secondary)",border:"1px solid var(--color-border)",cursor:"pointer",flexWrap:"wrap"},onMouseOver:p=>p.currentTarget.style.borderColor="var(--color-primary)",onMouseOut:p=>p.currentTarget.style.borderColor="var(--color-border)",children:[e("div",{className:"flex-1",children:[r.name&&e("div",{className:"text-sm font-medium text-primary mb-1",children:r.name}),e("div",{className:"font-mono text-sm",children:r.formula}),r.variables&&r.variables.length>0&&e("div",{className:"text-xs text-muted mt-1",children:["Variables: ",r.variables.map(p=>`${p.name}=${p.value}`).join(", ")]})]}),e("button",{onClick:p=>{p.stopPropagation();const E=S.filter((w,ne)=>ne!==x);T(E),localStorage.setItem("xl-formula-saved",JSON.stringify(E))},className:"text-xs text-muted hover:text-error ml-2",style:{padding:"4px 8px",minWidth:"32px"},title:"Delete saved formula",children:"Ã—"})]},x))})]}),e("div",{className:"grid grid-cols-2 gap-6",style:{gap:"1rem"},children:[e("div",{className:"card",children:[e("h3",{className:"font-semibold mb-4",children:"Variables"}),e("div",{className:"flex gap-2 mb-4",style:{flexWrap:"wrap"},children:[e("input",{type:"text",value:A,onChange:r=>v(r.target.value),placeholder:"Variable name",className:"input",style:{minWidth:"100px",flex:1}}),e("input",{type:"text",value:t,onChange:r=>s(r.target.value),placeholder:"Value",className:"input",style:{minWidth:"100px",flex:1}}),e("button",{onClick:k,className:"btn btn-primary",style:{minWidth:"80px"},children:"Add"})]}),e("div",{className:"grid gap-2",children:o.map(r=>e("div",{className:"flex justify-between items-center p-2 rounded",style:{background:"var(--color-bg-secondary)",flexWrap:"wrap"},children:[e("span",{className:"font-mono font-medium",children:r.name}),e("span",{className:"font-mono text-muted",children:r.value}),e("button",{onClick:()=>z(r.name),className:"btn btn-sm",style:{background:"var(--color-error)",color:"white",border:"none",minWidth:"60px"},children:"Remove"})]},r.name))})]}),e("div",{className:"card",children:[e("h3",{className:"font-semibold mb-4",children:"Examples"}),e("div",{className:"grid gap-3",children:[{formula:"=SUM(1, 2, 3, 4, 5)",description:"Basic sum function"},{formula:"=MAX(10, 20, 5, 30)",description:"Find maximum value"},{formula:"=ROUND(3.14159, 2)",description:"Round to 2 decimal places"},{formula:'=IF(5 > 3, "Yes", "No")',description:"Conditional logic"},{formula:'=CONCATENATE("Hello", " ", "World")',description:"Text concatenation"},{formula:"=A1 + B1 * C1",description:"Using variables"}].map((r,x)=>e("div",{onClick:()=>ae(r.formula),className:"p-3 rounded cursor-pointer",style:{background:"var(--color-bg-secondary)",border:"1px solid var(--color-border)",cursor:"pointer",flexWrap:"wrap"},onMouseOver:p=>p.currentTarget.style.borderColor="var(--color-primary)",onMouseOut:p=>p.currentTarget.style.borderColor="var(--color-border)",children:[e("div",{className:"font-mono font-medium text-sm",children:r.formula}),e("div",{className:"text-xs text-muted mt-1",children:r.description})]},x))})]})]}),W&&e("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},onClick:r=>{r.target===r.currentTarget&&H(!1)},children:e("div",{style:{backgroundColor:"white",borderRadius:"8px",padding:"24px",width:"90vw",maxWidth:"400px",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)"},onClick:r=>r.stopPropagation(),children:[e("h3",{style:{fontSize:"18px",fontWeight:"bold",marginBottom:"16px"},children:"Save Formula"}),e("div",{style:{marginBottom:"16px"},children:[e("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",marginBottom:"8px"},children:"Formula Name (optional)"}),e("input",{type:"text",value:I,onChange:r=>X(r.target.value),style:{width:"100%",padding:"8px 12px",border:"1px solid #ccc",borderRadius:"4px",fontSize:"14px"},placeholder:"e.g. 'Complex calculation', 'Tax formula'",autoFocus:!0})]}),e("div",{style:{marginBottom:"16px"},children:[e("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",marginBottom:"8px"},children:"Formula"}),e("div",{style:{padding:"8px 12px",backgroundColor:"#f5f5f5",borderRadius:"4px",fontFamily:"monospace",fontSize:"14px",overflowX:"auto"},children:a})]}),o.length>0&&e("div",{style:{marginBottom:"16px"},children:[e("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",marginBottom:"8px"},children:"Variables to Save"}),e("div",{style:{fontSize:"14px",color:"#666"},children:o.map(r=>`${r.name}=${r.value}`).join(", ")})]}),e("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:[e("button",{onClick:()=>H(!1),className:"btn btn-sm",style:{backgroundColor:"#eee"},children:"Cancel"}),e("button",{onClick:()=>{M(a,I),H(!1)},className:"btn btn-sm btn-primary",children:"Save"})]})]})})]})}function Se(){const a="/velox/";return e("div",{style:{minHeight:"100vh",display:"flex",flexDirection:"column"},children:[e(ue,{}),e("main",{style:{flex:1},children:e(le,{children:[e(Z,{path:a}),e(Z,{path:`${a}`}),e(pe,{path:`${a}formulas`}),e(j,{path:`${a}formulas/docs`}),e(j,{path:`${a}formulas/docs/:category?`}),e(j,{path:`${a}formulas/docs/:category/:function?`}),e(Ne,{path:`${a}formulas/playground`})]})})]})}de(e(Se,{}),document.getElementById("app"));export{G as _};
