import{_ as l}from"./index-Cc4k2yAK.js";import"./vendor-CCnpLwun.js";import"./formula-DkIGol2c.js";let i=null;async function h(){if(i)return!0;try{const r=(await l(async()=>{const{default:e}=await import("./xl-formula-BXu6fsFJ.js");return{default:e}},[])).default;return i=await r(),!0}catch(r){return console.error("Failed to initialize XL Formula library:",r),!1}}function a(){return i!==null}class n{constructor(e){this._value=e}static number(e){if(!a())throw new Error("XL Formula not initialized");return new n(i.Value.fromNumber(e))}static text(e){if(!a())throw new Error("XL Formula not initialized");return new n(i.Value.fromText(e))}static boolean(e){if(!a())throw new Error("XL Formula not initialized");return new n(i.Value.fromBoolean(e))}static empty(){if(!a())throw new Error("XL Formula not initialized");return new n(i.Value.empty())}static date(e){if(!a())throw new Error("XL Formula not initialized");return new n(i.Value.fromDate(e))}isNumber(){return this._value.isNumber()}isText(){return this._value.isText()}isBoolean(){return this._value.isBoolean()}isError(){return this._value.isError()}isEmpty(){return this._value.isEmpty()}isDate(){return this._value.isDate()}asNumber(){return this._value.asNumber()}asText(){return this._value.asText()}asBoolean(){return this._value.asBoolean()}asDate(){if(this.isDate()){const e=this._value.asDate();return new Date(e*1e3)}throw new Error("Value is not a date")}getErrorText(){return this._value.getErrorText()}getTypeName(){return this._value.getTypeName()}toString(){return this.asText()}valueOf(){return this.isNumber()?this.asNumber():this.isBoolean()?this.asBoolean():this.asText()}}class s{constructor(e){this._result=e}isSuccess(){return this._result.isSuccess()}hasError(){return this._result.hasError()}getValue(){return new n(this._result.getValue())}getErrorMessage(){return this._result.getErrorMessage()}getErrors(){return this._result.getErrors()}}class m{constructor(){if(!a())throw new Error("XL Formula not initialized");this._engine=new i.FormulaEngine}setVariable(e,t){if(t instanceof n)this._engine.setVariable(e,t._value);else if(typeof t=="number")this._engine.setNumberVariable(e,t);else if(typeof t=="string")this._engine.setTextVariable(e,t);else if(typeof t=="boolean")this._engine.setBooleanVariable(e,t);else throw new Error("Invalid value type");return this}setNumber(e,t){return this._engine.setNumberVariable(e,t),this}setText(e,t){return this._engine.setTextVariable(e,t),this}setBoolean(e,t){return this._engine.setBooleanVariable(e,t),this}getVariable(e){return new n(this._engine.getVariable(e))}hasVariable(e){return this._engine.hasVariable(e)}removeVariable(e){return this._engine.removeVariable(e),this}clearVariables(){return this._engine.clearVariables(),this}evaluate(e){return new s(this._engine.evaluate(o(e)))}}function o(r){return r.startsWith("=")?r.substring(1):r}function f(r){if(!a())throw new Error("XL Formula not initialized");return new s(i.evaluate(o(r)))}function _(){if(!a())throw new Error("XL Formula not initialized");return i.getVersion()}const u={init:h,isInitialized:a,Value:n,EvaluationResult:s,FormulaEngine:m,evaluate:f,getVersion:_};typeof module<"u"&&module.exports&&(module.exports=u);typeof window<"u"&&(window.XLFormula=u);export{u as default};
