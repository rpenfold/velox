var Kn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Vn(l){return l&&l.__esModule&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l}var mn={exports:{}};function In(){}In.prototype={on:function(l,c,g){var u=this.e||(this.e={});return(u[l]||(u[l]=[])).push({fn:c,ctx:g}),this},once:function(l,c,g){var u=this;function f(){u.off(l,f),c.apply(g,arguments)}return f._=c,this.on(l,f,g)},emit:function(l){var c=[].slice.call(arguments,1),g=((this.e||(this.e={}))[l]||[]).slice(),u=0,f=g.length;for(u;u<f;u++)g[u].fn.apply(g[u].ctx,c);return this},off:function(l,c){var g=this.e||(this.e={}),u=g[l],f=[];if(u&&c)for(var I=0,s=u.length;I<s;I++)u[I].fn!==c&&u[I].fn._!==c&&f.push(u[I]);return f.length?g[l]=f:delete g[l],this}};mn.exports=In;mn.exports.TinyEmitter=In;var Qn=mn.exports;const Wn=Vn(Qn);function ir(l){var c;return typeof l=="number"?c=l:typeof l=="string"&&(c=l.indexOf(".")>-1?parseFloat(l):parseInt(l,10)),c}function zn(l){return-1*ir(l)}var vr;function hr(l,c,g){return c in l?Object.defineProperty(l,c,{value:g,enumerable:!0,configurable:!0,writable:!0}):l[c]=g,l}var br="ERROR",Un="DIV/0",Hr="NAME",$n="N/A",Zn="NULL",Jn="NUM",_n="REF",Mr="VALUE",dr=(vr={},hr(vr,br,"#ERROR!"),hr(vr,Un,"#DIV/0!"),hr(vr,Hr,"#NAME?"),hr(vr,$n,"#N/A"),hr(vr,Zn,"#NULL!"),hr(vr,Jn,"#NUM!"),hr(vr,_n,"#REF!"),hr(vr,Mr,"#VALUE!"),vr);function Vr(l){var c;return l=(l+"").replace(/#|!|\?/g,""),dr[l]&&(c=dr[l]),c||null}function jn(l){var c=!1;for(var g in dr)if(Object.prototype.hasOwnProperty.call(dr,g)&&dr[g]===l){c=!0;break}return c}var xn="+";function nn(l){for(var c=arguments.length,g=new Array(c>1?c-1:0),u=1;u<c;u++)g[u-1]=arguments[u];var f=g.reduce(function(I,s){return I+ir(s)},ir(l));if(isNaN(f))throw Error(Mr);return f}nn.SYMBOL=xn;var re="&";function en(){for(var l=arguments.length,c=new Array(l),g=0;g<l;g++)c[g]=arguments[g];return c.reduce(function(u,f){return u+f.toString()},"")}en.SYMBOL=re;var ne="/";function tn(l){for(var c=arguments.length,g=new Array(c>1?c-1:0),u=1;u<c;u++)g[u-1]=arguments[u];var f=g.reduce(function(I,s){return I/ir(s)},ir(l));if(f===1/0)throw Error(Un);if(isNaN(f))throw Error(Mr);return f}tn.SYMBOL=ne;var ee="=";function un(l,c){return l===c}un.SYMBOL=ee;var Fn={},L={},Jr={},sr={},B={};B.nil=new Error("#NULL!");B.div0=new Error("#DIV/0!");B.value=new Error("#VALUE!");B.ref=new Error("#REF!");B.name=new Error("#NAME?");B.num=new Error("#NUM!");B.na=new Error("#N/A");B.error=new Error("#ERROR!");B.data=new Error("#GETTING_DATA");(function(l){var c=B;l.flattenShallow=function(u){return!u||!u.reduce?u:u.reduce(function(f,I){var s=Array.isArray(f),t=Array.isArray(I);return s&&t?f.concat(I):s?(f.push(I),f):t?[f].concat(I):[f,I]})},l.isFlat=function(u){if(!u)return!1;for(var f=0;f<u.length;++f)if(Array.isArray(u[f]))return!1;return!0},l.flatten=function(){for(var u=l.argsToArray.apply(null,arguments);!l.isFlat(u);)u=l.flattenShallow(u);return u},l.argsToArray=function(u){var f=[];return l.arrayEach(u,function(I){f.push(I)}),f},l.numbers=function(){var u=this.flatten.apply(null,arguments);return u.filter(function(f){return typeof f=="number"})},l.cleanFloat=function(u){var f=1e14;return Math.round(u*f)/f},l.parseBool=function(u){if(typeof u=="boolean"||u instanceof Error)return u;if(typeof u=="number")return u!==0;if(typeof u=="string"){var f=u.toUpperCase();if(f==="TRUE")return!0;if(f==="FALSE")return!1}return u instanceof Date&&!isNaN(u)?!0:c.value},l.parseNumber=function(u){return u===void 0||u===""||isNaN(u)?c.value:parseFloat(u)},l.parseNumberArray=function(u){var f;if(!u||(f=u.length)===0)return c.value;for(var I;f--;){if(I=l.parseNumber(u[f]),I===c.value)return I;u[f]=I}return u},l.parseMatrix=function(u){if(!u||u.length===0)return c.value;for(var f,I=0;I<u.length;I++)if(f=l.parseNumberArray(u[I]),u[I]=f,f instanceof Error)return f;return u};var g=new Date(Date.UTC(1900,0,1));l.parseDate=function(u){if(!isNaN(u)){if(u instanceof Date)return new Date(u);var f=parseInt(u,10);return f<0?c.num:f<=60?new Date(g.getTime()+(f-1)*864e5):new Date(g.getTime()+(f-2)*864e5)}return typeof u=="string"&&(u=new Date(u),!isNaN(u))?u:c.value},l.parseDateArray=function(u){for(var f=u.length,I;f--;){if(I=this.parseDate(u[f]),I===c.value)return I;u[f]=I}return u},l.anyIsError=function(){for(var u=arguments.length;u--;)if(arguments[u]instanceof Error)return!0;return!1},l.arrayValuesToNumbers=function(u){for(var f=u.length,I;f--;)if(I=u[f],typeof I!="number"){if(I===!0){u[f]=1;continue}if(I===!1){u[f]=0;continue}if(typeof I=="string"){var s=this.parseNumber(I);s instanceof Error?u[f]=0:u[f]=s}}return u},l.rest=function(u,f){return f=f||1,!u||typeof u.slice!="function"?u:u.slice(f)},l.initial=function(u,f){return f=f||1,!u||typeof u.slice!="function"?u:u.slice(0,u.length-f)},l.arrayEach=function(u,f){for(var I=-1,s=u.length;++I<s&&f(u[I],I,u)!==!1;);return u},l.transpose=function(u){return u?u[0].map(function(f,I){return u.map(function(s){return s[I]})}):c.value}})(sr);var _r={},Xr={};(function(l){var c=sr,g=B;l.ASC=function(){throw new Error("ASC is not implemented")},l.BAHTTEXT=function(){throw new Error("BAHTTEXT is not implemented")},l.CHAR=function(u){return u=c.parseNumber(u),u instanceof Error?u:String.fromCharCode(u)},l.CLEAN=function(u){u=u||"";var f=/[\0-\x1F]/g;return u.replace(f,"")},l.CODE=function(u){u=u||"";var f=u.charCodeAt(0);return isNaN(f)&&(f=g.na),f},l.CONCATENATE=function(){for(var u=c.flatten(arguments),f=0;(f=u.indexOf(!0))>-1;)u[f]="TRUE";for(var I=0;(I=u.indexOf(!1))>-1;)u[I]="FALSE";return u.join("")},l.DBCS=function(){throw new Error("DBCS is not implemented")},l.DOLLAR=function(){throw new Error("DOLLAR is not implemented")},l.EXACT=function(u,f){return arguments.length!==2?g.na:u===f},l.FIND=function(u,f,I){return arguments.length<2?g.na:(I=I===void 0?0:I,f?f.indexOf(u,I-1)+1:null)},l.FIXED=function(){throw new Error("FIXED is not implemented")},l.HTML2TEXT=function(u){var f="";return u&&(u instanceof Array?u.forEach(function(I){f!==""&&(f+=`
`),f+=I.replace(/<(?:.|\n)*?>/gm,"")}):f=u.replace(/<(?:.|\n)*?>/gm,"")),f},l.LEFT=function(u,f){return f=f===void 0?1:f,f=c.parseNumber(f),f instanceof Error||typeof u!="string"?g.value:u?u.substring(0,f):null},l.LEN=function(u){return arguments.length===0?g.error:typeof u=="string"?u?u.length:0:u.length?u.length:g.value},l.LOWER=function(u){return typeof u!="string"?g.value:u&&u.toLowerCase()},l.MID=function(u,f,I){if(f=c.parseNumber(f),I=c.parseNumber(I),c.anyIsError(f,I)||typeof u!="string")return I;var s=f-1,t=s+I;return u.substring(s,t)},l.NUMBERVALUE=function(u,f,I){return f=typeof f>"u"?".":f,I=typeof I>"u"?",":I,Number(u.replace(f,".").replace(I,""))},l.PRONETIC=function(){throw new Error("PRONETIC is not implemented")},l.PROPER=function(u){return u===void 0||u.length===0||(u===!0&&(u="TRUE"),u===!1&&(u="FALSE"),isNaN(u)&&typeof u=="number")?g.value:(typeof u=="number"&&(u=""+u),u.replace(/\w\S*/g,function(f){return f.charAt(0).toUpperCase()+f.substr(1).toLowerCase()}))},l.REGEXEXTRACT=function(u,f){if(arguments.length<2)return g.na;var I=u.match(new RegExp(f));return I?I[I.length>1?I.length-1:0]:null},l.REGEXMATCH=function(u,f,I){if(arguments.length<2)return g.na;var s=u.match(new RegExp(f));return I?s:!!s},l.REGEXREPLACE=function(u,f,I){return arguments.length<3?g.na:u.replace(new RegExp(f),I)},l.REPLACE=function(u,f,I,s){return f=c.parseNumber(f),I=c.parseNumber(I),c.anyIsError(f,I)||typeof u!="string"||typeof s!="string"?g.value:u.substr(0,f-1)+s+u.substr(f-1+I)},l.REPT=function(u,f){return f=c.parseNumber(f),f instanceof Error?f:new Array(f+1).join(u)},l.RIGHT=function(u,f){return f=f===void 0?1:f,f=c.parseNumber(f),f instanceof Error?f:u?u.substring(u.length-f):g.na},l.SEARCH=function(u,f,I){var s;return typeof u!="string"||typeof f!="string"?g.value:(I=I===void 0?0:I,s=f.toLowerCase().indexOf(u.toLowerCase(),I-1)+1,s===0?g.value:s)},l.SPLIT=function(u,f){return u.split(f)},l.SUBSTITUTE=function(u,f,I,s){if(arguments.length<2)return g.na;if(!u||!f||!I)return u;if(s===void 0)return u.replace(new RegExp(f,"g"),I);for(var t=0,a=0;u.indexOf(f,t)>0;)if(t=u.indexOf(f,t+1),a++,a===s)return u.substring(0,t)+I+u.substring(t+f.length)},l.T=function(u){return typeof u=="string"?u:""},l.TEXT=function(){throw new Error("TEXT is not implemented")},l.TRIM=function(u){return typeof u!="string"?g.value:u.replace(/ +/g," ").trim()},l.UNICHAR=l.CHAR,l.UNICODE=l.CODE,l.UPPER=function(u){return typeof u!="string"?g.value:u.toUpperCase()},l.VALUE=function(){throw new Error("VALUE is not implemented")}})(Xr);var Gn={exports:{}};(function(l,c){(function(g,u){l.exports=u()})(Kn,function(){var g=function(u,f){var I=Array.prototype.concat,s=Array.prototype.slice,t=Object.prototype.toString;function a(A,N){var T=A>N?A:N;return u.pow(10,17-~~(u.log(T>0?T:-T)*u.LOG10E))}var n=Array.isArray||function(N){return t.call(N)==="[object Array]"};function r(A){return t.call(A)==="[object Function]"}function e(A){return typeof A=="number"?A-A===0:!1}function i(A){return I.apply([],A)}function o(){return new o._init(arguments)}o.fn=o.prototype,o._init=function(N){if(n(N[0]))if(n(N[0][0])){r(N[1])&&(N[0]=o.map(N[0],N[1]));for(var T=0;T<N[0].length;T++)this[T]=N[0][T];this.length=N[0].length}else this[0]=r(N[1])?o.map(N[0],N[1]):N[0],this.length=1;else if(e(N[0]))this[0]=o.seq.apply(null,N),this.length=1;else{if(N[0]instanceof o)return o(N[0].toArray());this[0]=[],this.length=1}return this},o._init.prototype=o.prototype,o._init.constructor=o,o.utils={calcRdx:a,isArray:n,isFunction:r,isNumber:e,toVector:i},o._random_fn=u.random,o.setRandom=function(N){if(typeof N!="function")throw new TypeError("fn is not a function");o._random_fn=N},o.extend=function(N){var T,R;if(arguments.length===1){for(R in N)o[R]=N[R];return this}for(T=1;T<arguments.length;T++)for(R in arguments[T])N[R]=arguments[T][R];return N},o.rows=function(N){return N.length||1},o.cols=function(N){return N[0].length||1},o.dimensions=function(N){return{rows:o.rows(N),cols:o.cols(N)}},o.row=function(N,T){return n(T)?T.map(function(R){return o.row(N,R)}):N[T]},o.rowa=function(N,T){return o.row(N,T)},o.col=function(N,T){if(n(T)){var R=o.arange(N.length).map(function(){return new Array(T.length)});return T.forEach(function(p,C){o.arange(N.length).forEach(function(M){R[M][C]=N[M][p]})}),R}for(var O=new Array(N.length),y=0;y<N.length;y++)O[y]=[N[y][T]];return O},o.cola=function(N,T){return o.col(N,T).map(function(R){return R[0]})},o.diag=function(N){for(var T=o.rows(N),R=new Array(T),O=0;O<T;O++)R[O]=[N[O][O]];return R},o.antidiag=function(N){for(var T=o.rows(N)-1,R=new Array(T),O=0;T>=0;T--,O++)R[O]=[N[O][T]];return R},o.transpose=function(N){var T=[],R,O,y,p,C;for(n(N[0])||(N=[N]),O=N.length,y=N[0].length,C=0;C<y;C++){for(R=new Array(O),p=0;p<O;p++)R[p]=N[p][C];T.push(R)}return T.length===1?T[0]:T},o.map=function(N,T,R){var O,y,p,C,M;for(n(N[0])||(N=[N]),y=N.length,p=N[0].length,C=R?N:new Array(y),O=0;O<y;O++)for(C[O]||(C[O]=new Array(p)),M=0;M<p;M++)C[O][M]=T(N[O][M],O,M);return C.length===1?C[0]:C},o.cumreduce=function(N,T,R){var O,y,p,C,M;for(n(N[0])||(N=[N]),y=N.length,p=N[0].length,C=R?N:new Array(y),O=0;O<y;O++)for(C[O]||(C[O]=new Array(p)),p>0&&(C[O][0]=N[O][0]),M=1;M<p;M++)C[O][M]=T(C[O][M-1],N[O][M]);return C.length===1?C[0]:C},o.alter=function(N,T){return o.map(N,T,!0)},o.create=function(N,T,R){var O=new Array(N),y,p;for(r(T)&&(R=T,T=N),y=0;y<N;y++)for(O[y]=new Array(T),p=0;p<T;p++)O[y][p]=R(y,p);return O};function v(){return 0}o.zeros=function(N,T){return e(T)||(T=N),o.create(N,T,v)};function E(){return 1}o.ones=function(N,T){return e(T)||(T=N),o.create(N,T,E)},o.rand=function(N,T){return e(T)||(T=N),o.create(N,T,o._random_fn)};function h(A,N){return A===N?1:0}o.identity=function(N,T){return e(T)||(T=N),o.create(N,T,h)},o.symmetric=function(N){var T=N.length,R,O;if(N.length!==N[0].length)return!1;for(R=0;R<T;R++)for(O=0;O<T;O++)if(N[O][R]!==N[R][O])return!1;return!0},o.clear=function(N){return o.alter(N,v)},o.seq=function(N,T,R,O){r(O)||(O=!1);var y=[],p=a(N,T),C=(T*p-N*p)/((R-1)*p),M=N,d;for(d=0;M<=T&&d<R;d++,M=(N*p+C*p*d)/p)y.push(O?O(M,d):M);return y},o.arange=function(N,T,R){var O=[],y;if(R=R||1,T===f&&(T=N,N=0),N===T||R===0)return[];if(N<T&&R<0)return[];if(N>T&&R>0)return[];if(R>0)for(y=N;y<T;y+=R)O.push(y);else for(y=N;y>T;y+=R)O.push(y);return O},o.slice=function(){function A(T,R,O,y){var p,C=[],M=T.length;if(R===f&&O===f&&y===f)return o.copy(T);if(R=R||0,O=O||T.length,R=R>=0?R:M+R,O=O>=0?O:M+O,y=y||1,R===O||y===0)return[];if(R<O&&y<0)return[];if(R>O&&y>0)return[];if(y>0)for(p=R;p<O;p+=y)C.push(T[p]);else for(p=R;p>O;p+=y)C.push(T[p]);return C}function N(T,R){var O,y;if(R=R||{},e(R.row)){if(e(R.col))return T[R.row][R.col];var p=o.rowa(T,R.row);return O=R.col||{},A(p,O.start,O.end,O.step)}if(e(R.col)){var C=o.cola(T,R.col);return y=R.row||{},A(C,y.start,y.end,y.step)}y=R.row||{},O=R.col||{};var M=A(T,y.start,y.end,y.step);return M.map(function(d){return A(d,O.start,O.end,O.step)})}return N}(),o.sliceAssign=function(N,T,R){var O,y;if(e(T.row)){if(e(T.col))return N[T.row][T.col]=R;T.col=T.col||{},T.col.start=T.col.start||0,T.col.end=T.col.end||N[0].length,T.col.step=T.col.step||1,O=o.arange(T.col.start,u.min(N.length,T.col.end),T.col.step);var p=T.row;return O.forEach(function(M,d){N[p][M]=R[d]}),N}if(e(T.col)){T.row=T.row||{},T.row.start=T.row.start||0,T.row.end=T.row.end||N.length,T.row.step=T.row.step||1,y=o.arange(T.row.start,u.min(N[0].length,T.row.end),T.row.step);var C=T.col;return y.forEach(function(M,d){N[M][C]=R[d]}),N}return R[0].length===f&&(R=[R]),T.row.start=T.row.start||0,T.row.end=T.row.end||N.length,T.row.step=T.row.step||1,T.col.start=T.col.start||0,T.col.end=T.col.end||N[0].length,T.col.step=T.col.step||1,y=o.arange(T.row.start,u.min(N.length,T.row.end),T.row.step),O=o.arange(T.col.start,u.min(N[0].length,T.col.end),T.col.step),y.forEach(function(M,d){O.forEach(function(P,V){N[M][P]=R[d][V]})}),N},o.diagonal=function(N){var T=o.zeros(N.length,N.length);return N.forEach(function(R,O){T[O][O]=R}),T},o.copy=function(N){return N.map(function(T){return e(T)?T:T.map(function(R){return R})})};var m=o.prototype;return m.length=0,m.push=Array.prototype.push,m.sort=Array.prototype.sort,m.splice=Array.prototype.splice,m.slice=Array.prototype.slice,m.toArray=function(){return this.length>1?s.call(this):s.call(this)[0]},m.map=function(N,T){return o(o.map(this,N,T))},m.cumreduce=function(N,T){return o(o.cumreduce(this,N,T))},m.alter=function(N){return o.alter(this,N),this},function(A){for(var N=0;N<A.length;N++)(function(T){m[T]=function(R){var O=this,y;return R?(setTimeout(function(){R.call(O,m[T].call(O))}),this):(y=o[T](this),n(y)?o(y):y)}})(A[N])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(A){for(var N=0;N<A.length;N++)(function(T){m[T]=function(R,O){var y=this;return O?(setTimeout(function(){O.call(y,m[T].call(y,R))}),this):o(o[T](this,R))}})(A[N])}("row col".split(" ")),function(A){for(var N=0;N<A.length;N++)(function(T){m[T]=function(){return o(o[T].apply(null,arguments))}})(A[N])}("create zeros ones rand identity".split(" ")),o}(Math);return function(u,f){var I=u.utils.isFunction;function s(n,r){return n-r}function t(n,r,e){return f.max(r,f.min(n,e))}u.sum=function(r){for(var e=0,i=r.length;--i>=0;)e+=r[i];return e},u.sumsqrd=function(r){for(var e=0,i=r.length;--i>=0;)e+=r[i]*r[i];return e},u.sumsqerr=function(r){for(var e=u.mean(r),i=0,o=r.length,v;--o>=0;)v=r[o]-e,i+=v*v;return i},u.sumrow=function(r){for(var e=0,i=r.length;--i>=0;)e+=r[i];return e},u.product=function(r){for(var e=1,i=r.length;--i>=0;)e*=r[i];return e},u.min=function(r){for(var e=r[0],i=0;++i<r.length;)r[i]<e&&(e=r[i]);return e},u.max=function(r){for(var e=r[0],i=0;++i<r.length;)r[i]>e&&(e=r[i]);return e},u.unique=function(r){for(var e={},i=[],o=0;o<r.length;o++)e[r[o]]||(e[r[o]]=!0,i.push(r[o]));return i},u.mean=function(r){return u.sum(r)/r.length},u.meansqerr=function(r){return u.sumsqerr(r)/r.length},u.geomean=function(r){var e=r.map(f.log),i=u.mean(e);return f.exp(i)},u.median=function(r){var e=r.length,i=r.slice().sort(s);return e&1?i[e/2|0]:(i[e/2-1]+i[e/2])/2},u.cumsum=function(r){return u.cumreduce(r,function(e,i){return e+i})},u.cumprod=function(r){return u.cumreduce(r,function(e,i){return e*i})},u.diff=function(r){var e=[],i=r.length,o;for(o=1;o<i;o++)e.push(r[o]-r[o-1]);return e},u.rank=function(n){var r,e=[],i={};for(r=0;r<n.length;r++){var o=n[r];i[o]?i[o]++:(i[o]=1,e.push(o))}var v=e.sort(s),E={},h=1;for(r=0;r<v.length;r++){var o=v[r],m=i[o],A=h,N=h+m-1,T=(A+N)/2;E[o]=T,h+=m}return n.map(function(R){return E[R]})},u.mode=function(r){var e=r.length,i=r.slice().sort(s),o=1,v=0,E=0,h=[],m;for(m=0;m<e;m++)i[m]===i[m+1]?o++:(o>v?(h=[i[m]],v=o,E=0):o===v&&(h.push(i[m]),E++),o=1);return E===0?h[0]:h},u.range=function(r){return u.max(r)-u.min(r)},u.variance=function(r,e){return u.sumsqerr(r)/(r.length-(e?1:0))},u.pooledvariance=function(r){var e=r.reduce(function(o,v){return o+u.sumsqerr(v)},0),i=r.reduce(function(o,v){return o+v.length},0);return e/(i-r.length)},u.deviation=function(n){for(var r=u.mean(n),e=n.length,i=new Array(e),o=0;o<e;o++)i[o]=n[o]-r;return i},u.stdev=function(r,e){return f.sqrt(u.variance(r,e))},u.pooledstdev=function(r){return f.sqrt(u.pooledvariance(r))},u.meandev=function(r){for(var e=u.mean(r),i=[],o=r.length-1;o>=0;o--)i.push(f.abs(r[o]-e));return u.mean(i)},u.meddev=function(r){for(var e=u.median(r),i=[],o=r.length-1;o>=0;o--)i.push(f.abs(r[o]-e));return u.median(i)},u.coeffvar=function(r){return u.stdev(r)/u.mean(r)},u.quartiles=function(r){var e=r.length,i=r.slice().sort(s);return[i[f.round(e/4)-1],i[f.round(e/2)-1],i[f.round(e*3/4)-1]]},u.quantiles=function(r,e,i,o){var v=r.slice().sort(s),E=[e.length],h=r.length,m,A,N,T,R,O;for(typeof i>"u"&&(i=3/8),typeof o>"u"&&(o=3/8),m=0;m<e.length;m++)A=e[m],N=i+A*(1-i-o),T=h*A+N,R=f.floor(t(T,1,h-1)),O=t(T-R,0,1),E[m]=(1-O)*v[R-1]+O*v[R];return E},u.percentile=function(r,e,i){var o=r.slice().sort(s),v=e*(o.length+(i?1:-1))+(i?0:1),E=parseInt(v),h=v-E;return E+1<o.length?o[E-1]+h*(o[E]-o[E-1]):o[E-1]},u.percentileOfScore=function(r,e,i){var o=0,v=r.length,E=!1,h,m;for(i==="strict"&&(E=!0),m=0;m<v;m++)h=r[m],(E&&h<e||!E&&h<=e)&&o++;return o/v},u.histogram=function(r,e){e=e||4;var i=u.min(r),o=(u.max(r)-i)/e,v=r.length,E=[],h;for(h=0;h<e;h++)E[h]=0;for(h=0;h<v;h++)E[f.min(f.floor((r[h]-i)/o),e-1)]+=1;return E},u.covariance=function(r,e){var i=u.mean(r),o=u.mean(e),v=r.length,E=new Array(v),h;for(h=0;h<v;h++)E[h]=(r[h]-i)*(e[h]-o);return u.sum(E)/(v-1)},u.corrcoeff=function(r,e){return u.covariance(r,e)/u.stdev(r,1)/u.stdev(e,1)},u.spearmancoeff=function(n,r){return n=u.rank(n),r=u.rank(r),u.corrcoeff(n,r)},u.stanMoment=function(r,e){for(var i=u.mean(r),o=u.stdev(r),v=r.length,E=0,h=0;h<v;h++)E+=f.pow((r[h]-i)/o,e);return E/r.length},u.skewness=function(r){return u.stanMoment(r,3)},u.kurtosis=function(r){return u.stanMoment(r,4)-3};var a=u.prototype;(function(n){for(var r=0;r<n.length;r++)(function(e){a[e]=function(i,o){var v=[],E=0,h=this;if(I(i)&&(o=i,i=!1),o)return setTimeout(function(){o.call(h,a[e].call(h,i))}),this;if(this.length>1){for(h=i===!0?this:this.transpose();E<h.length;E++)v[E]=u[e](h[E]);return v}return u[e](this[0],i)}})(n[r])})("cumsum cumprod".split(" ")),function(n){for(var r=0;r<n.length;r++)(function(e){a[e]=function(i,o){var v=[],E=0,h=this;if(I(i)&&(o=i,i=!1),o)return setTimeout(function(){o.call(h,a[e].call(h,i))}),this;if(this.length>1){for(e!=="sumrow"&&(h=i===!0?this:this.transpose());E<h.length;E++)v[E]=u[e](h[E]);return i===!0?u[e](u.utils.toVector(v)):v}return u[e](this[0],i)}})(n[r])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(n){for(var r=0;r<n.length;r++)(function(e){a[e]=function(){var i=[],o=0,v=this,E=Array.prototype.slice.call(arguments),h;if(I(E[E.length-1])){h=E[E.length-1];var m=E.slice(0,E.length-1);return setTimeout(function(){h.call(v,a[e].apply(v,m))}),this}else{h=void 0;var A=function(T){return u[e].apply(v,[T].concat(E))}}if(this.length>1){for(v=v.transpose();o<v.length;o++)i[o]=A(v[o]);return i}return A(this[0])}})(n[r])}("quantiles percentileOfScore".split(" "))}(g,Math),function(u,f){u.gammaln=function(s){var t=0,a=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],n=1.000000000190015,r,e,i;for(i=(e=r=s)+5.5,i-=(r+.5)*f.log(i);t<6;t++)n+=a[t]/++e;return f.log(2.5066282746310007*n/r)-i},u.loggam=function(s){var t,a,n,r,e,i,o,v=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059];if(t=s,o=0,s==1||s==2)return 0;for(s<=7&&(o=f.floor(7-s),t=s+o),a=1/(t*t),n=2*f.PI,e=v[9],i=8;i>=0;i--)e*=a,e+=v[i];if(r=e/t+.5*f.log(n)+(t-.5)*f.log(t)-t,s<=7)for(i=1;i<=o;i++)r-=f.log(t-1),t-=1;return r},u.gammafn=function(s){var t=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],a=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],n=!1,r=0,e=0,i=0,o=s,v,E,h,m;if(s>171.6243769536076)return 1/0;if(o<=0)if(m=o%1+36e-17,m)n=(o&1?-1:1)*f.PI/f.sin(f.PI*m),o=1-o;else return 1/0;for(h=o,o<1?E=o++:E=(o-=r=(o|0)-1)-1,v=0;v<8;++v)i=(i+t[v])*E,e=e*E+a[v];if(m=i/e+1,h<o)m/=h;else if(h>o)for(v=0;v<r;++v)m*=o,o++;return n&&(m=n/m),m},u.gammap=function(s,t){return u.lowRegGamma(s,t)*u.gammafn(s)},u.lowRegGamma=function(s,t){var a=u.gammaln(s),n=s,r=1/s,e=r,i=t+1-s,o=1/1e-30,v=1/i,E=v,h=1,m=-~(f.log(s>=1?s:1/s)*8.5+s*.4+17),A;if(t<0||s<=0)return NaN;if(t<s+1){for(;h<=m;h++)r+=e*=t/++n;return r*f.exp(-t+s*f.log(t)-a)}for(;h<=m;h++)A=-h*(h-s),i+=2,v=A*v+i,o=i+A/o,v=1/v,E*=v*o;return 1-E*f.exp(-t+s*f.log(t)-a)},u.factorialln=function(s){return s<0?NaN:u.gammaln(s+1)},u.factorial=function(s){return s<0?NaN:u.gammafn(s+1)},u.combination=function(s,t){return s>170||t>170?f.exp(u.combinationln(s,t)):u.factorial(s)/u.factorial(t)/u.factorial(s-t)},u.combinationln=function(s,t){return u.factorialln(s)-u.factorialln(t)-u.factorialln(s-t)},u.permutation=function(s,t){return u.factorial(s)/u.factorial(s-t)},u.betafn=function(s,t){if(!(s<=0||t<=0))return s+t>170?f.exp(u.betaln(s,t)):u.gammafn(s)*u.gammafn(t)/u.gammafn(s+t)},u.betaln=function(s,t){return u.gammaln(s)+u.gammaln(t)-u.gammaln(s+t)},u.betacf=function(s,t,a){var n=1e-30,r=1,e=t+a,i=t+1,o=t-1,v=1,E=1-e*s/i,h,m,A,N;for(f.abs(E)<n&&(E=n),E=1/E,N=E;r<=100&&(h=2*r,m=r*(a-r)*s/((o+h)*(t+h)),E=1+m*E,f.abs(E)<n&&(E=n),v=1+m/v,f.abs(v)<n&&(v=n),E=1/E,N*=E*v,m=-(t+r)*(e+r)*s/((t+h)*(i+h)),E=1+m*E,f.abs(E)<n&&(E=n),v=1+m/v,f.abs(v)<n&&(v=n),E=1/E,A=E*v,N*=A,!(f.abs(A-1)<3e-7));r++);return N},u.gammapinv=function(s,t){var a=0,n=t-1,r=1e-8,e=u.gammaln(t),i,o,v,E,h,m,A;if(s>=1)return f.max(100,t+100*f.sqrt(t));if(s<=0)return 0;for(t>1?(m=f.log(n),A=f.exp(n*(m-1)-e),h=s<.5?s:1-s,v=f.sqrt(-2*f.log(h)),i=(2.30753+v*.27061)/(1+v*(.99229+v*.04481))-v,s<.5&&(i=-i),i=f.max(.001,t*f.pow(1-1/(9*t)-i/(3*f.sqrt(t)),3))):(v=1-t*(.253+t*.12),s<v?i=f.pow(s/v,1/t):i=1-f.log(1-(s-v)/(1-v)));a<12;a++){if(i<=0)return 0;if(o=u.lowRegGamma(t,i)-s,t>1?v=A*f.exp(-(i-n)+n*(f.log(i)-m)):v=f.exp(-i+n*f.log(i)-e),E=o/v,i-=v=E/(1-.5*f.min(1,E*((t-1)/i-1))),i<=0&&(i=.5*(i+v)),f.abs(v)<r*i)break}return i},u.erf=function(s){var t=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,15626441722e-18,-85238095915e-18,6529054439e-18,5059343495e-18,-991364156e-18,-227365122e-18,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],a=t.length-1,n=!1,r=0,e=0,i,o,v,E;for(s<0&&(s=-s,n=!0),i=2/(2+s),o=4*i-2;a>0;a--)v=r,r=o*r-e+t[a],e=v;return E=i*f.exp(-s*s+.5*(t[0]+o*r)-e),n?E-1:1-E},u.erfc=function(s){return 1-u.erf(s)},u.erfcinv=function(s){var t=0,a,n,r,e;if(s>=2)return-100;if(s<=0)return 100;for(e=s<1?s:2-s,r=f.sqrt(-2*f.log(e/2)),a=-.70711*((2.30753+r*.27061)/(1+r*(.99229+r*.04481))-r);t<2;t++)n=u.erfc(a)-e,a+=n/(1.1283791670955126*f.exp(-a*a)-a*n);return s<1?a:-a},u.ibetainv=function(s,t,a){var n=1e-8,r=t-1,e=a-1,i=0,o,v,E,h,m,A,N,T,R,O,y;if(s<=0)return 0;if(s>=1)return 1;for(t>=1&&a>=1?(E=s<.5?s:1-s,h=f.sqrt(-2*f.log(E)),N=(2.30753+h*.27061)/(1+h*(.99229+h*.04481))-h,s<.5&&(N=-N),T=(N*N-3)/6,R=2/(1/(2*t-1)+1/(2*a-1)),O=N*f.sqrt(T+R)/R-(1/(2*a-1)-1/(2*t-1))*(T+5/6-2/(3*R)),N=t/(t+a*f.exp(2*O))):(o=f.log(t/(t+a)),v=f.log(a/(t+a)),h=f.exp(t*o)/t,m=f.exp(a*v)/a,O=h+m,s<h/O?N=f.pow(t*O*s,1/t):N=1-f.pow(a*O*(1-s),1/a)),y=-u.gammaln(t)-u.gammaln(a)+u.gammaln(t+a);i<10;i++){if(N===0||N===1)return N;if(A=u.ibeta(N,t,a)-s,h=f.exp(r*f.log(N)+e*f.log(1-N)+y),m=A/h,N-=h=m/(1-.5*f.min(1,m*(r/N-e/(1-N)))),N<=0&&(N=.5*(N+h)),N>=1&&(N=.5*(N+h+1)),f.abs(h)<n*N&&i>0)break}return N},u.ibeta=function(s,t,a){var n=s===0||s===1?0:f.exp(u.gammaln(t+a)-u.gammaln(t)-u.gammaln(a)+t*f.log(s)+a*f.log(1-s));return s<0||s>1?!1:s<(t+1)/(t+a+2)?n*u.betacf(s,t,a)/t:1-n*u.betacf(1-s,a,t)/a},u.randn=function(s,t){var a,n,r,e,i;if(t||(t=s),s)return u.create(s,t,function(){return u.randn()});do a=u._random_fn(),n=1.7156*(u._random_fn()-.5),r=a-.449871,e=f.abs(n)+.386595,i=r*r+e*(.196*e-.25472*r);while(i>.27597&&(i>.27846||n*n>-4*f.log(a)*a*a));return n/a},u.randg=function(s,t,a){var n=s,r,e,i,o,v,E;if(a||(a=t),s||(s=1),t)return E=u.zeros(t,a),E.alter(function(){return u.randg(s)}),E;s<1&&(s+=1),r=s-1/3,e=1/f.sqrt(9*r);do{do v=u.randn(),o=1+e*v;while(o<=0);o=o*o*o,i=u._random_fn()}while(i>1-.331*f.pow(v,4)&&f.log(i)>.5*v*v+r*(1-o+f.log(o)));if(s==n)return r*o;do i=u._random_fn();while(i===0);return f.pow(i,1/n)*r*o},function(I){for(var s=0;s<I.length;s++)(function(t){u.fn[t]=function(){return u(u.map(this,function(a){return u[t](a)}))}})(I[s])}("gammaln gammafn factorial factorialln".split(" ")),function(I){for(var s=0;s<I.length;s++)(function(t){u.fn[t]=function(){return u(u[t].apply(null,arguments))}})(I[s])}("randn".split(" "))}(g,Math),function(u,f){(function(n){for(var r=0;r<n.length;r++)(function(e){u[e]=function i(o,v,E){return this instanceof i?(this._a=o,this._b=v,this._c=E,this):new i(o,v,E)},u.fn[e]=function(i,o,v){var E=u[e](i,o,v);return E.data=this,E},u[e].prototype.sample=function(i){var o=this._a,v=this._b,E=this._c;return i?u.alter(i,function(){return u[e].sample(o,v,E)}):u[e].sample(o,v,E)},function(i){for(var o=0;o<i.length;o++)(function(v){u[e].prototype[v]=function(E){var h=this._a,m=this._b,A=this._c;return!E&&E!==0&&(E=this.data),typeof E!="number"?u.fn.map.call(E,function(N){return u[e][v](N,h,m,A)}):u[e][v](E,h,m,A)}})(i[o])}("pdf cdf inv".split(" ")),function(i){for(var o=0;o<i.length;o++)(function(v){u[e].prototype[v]=function(){return u[e][v](this._a,this._b,this._c)}})(i[o])}("mean median mode variance".split(" "))})(n[r])})("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" ")),u.extend(u.beta,{pdf:function(r,e,i){return r>1||r<0?0:e==1&&i==1?1:e<512&&i<512?f.pow(r,e-1)*f.pow(1-r,i-1)/u.betafn(e,i):f.exp((e-1)*f.log(r)+(i-1)*f.log(1-r)-u.betaln(e,i))},cdf:function(r,e,i){return r>1||r<0?(r>1)*1:u.ibeta(r,e,i)},inv:function(r,e,i){return u.ibetainv(r,e,i)},mean:function(r,e){return r/(r+e)},median:function(r,e){return u.ibetainv(.5,r,e)},mode:function(r,e){return(r-1)/(r+e-2)},sample:function(r,e){var i=u.randg(r);return i/(i+u.randg(e))},variance:function(r,e){return r*e/(f.pow(r+e,2)*(r+e+1))}}),u.extend(u.centralF,{pdf:function(r,e,i){var o,v,E;return r<0?0:e<=2?r===0&&e<2?1/0:r===0&&e===2?1:1/u.betafn(e/2,i/2)*f.pow(e/i,e/2)*f.pow(r,e/2-1)*f.pow(1+e/i*r,-(e+i)/2):(o=e*r/(i+r*e),v=i/(i+r*e),E=e*v/2,E*u.binomial.pdf((e-2)/2,(e+i-2)/2,o))},cdf:function(r,e,i){return r<0?0:u.ibeta(e*r/(e*r+i),e/2,i/2)},inv:function(r,e,i){return i/(e*(1/u.ibetainv(r,e/2,i/2)-1))},mean:function(r,e){return e>2?e/(e-2):void 0},mode:function(r,e){return r>2?e*(r-2)/(r*(e+2)):void 0},sample:function(r,e){var i=u.randg(r/2)*2,o=u.randg(e/2)*2;return i/r/(o/e)},variance:function(r,e){if(!(e<=4))return 2*e*e*(r+e-2)/(r*(e-2)*(e-2)*(e-4))}}),u.extend(u.cauchy,{pdf:function(r,e,i){return i<0?0:i/(f.pow(r-e,2)+f.pow(i,2))/f.PI},cdf:function(r,e,i){return f.atan((r-e)/i)/f.PI+.5},inv:function(n,r,e){return r+e*f.tan(f.PI*(n-.5))},median:function(r){return r},mode:function(r){return r},sample:function(r,e){return u.randn()*f.sqrt(1/(2*u.randg(.5)))*e+r}}),u.extend(u.chisquare,{pdf:function(r,e){return r<0?0:r===0&&e===2?.5:f.exp((e/2-1)*f.log(r)-r/2-e/2*f.log(2)-u.gammaln(e/2))},cdf:function(r,e){return r<0?0:u.lowRegGamma(e/2,r/2)},inv:function(n,r){return 2*u.gammapinv(n,.5*r)},mean:function(n){return n},median:function(r){return r*f.pow(1-2/(9*r),3)},mode:function(r){return r-2>0?r-2:0},sample:function(r){return u.randg(r/2)*2},variance:function(r){return 2*r}}),u.extend(u.exponential,{pdf:function(r,e){return r<0?0:e*f.exp(-e*r)},cdf:function(r,e){return r<0?0:1-f.exp(-e*r)},inv:function(n,r){return-f.log(1-n)/r},mean:function(n){return 1/n},median:function(n){return 1/n*f.log(2)},mode:function(){return 0},sample:function(r){return-1/r*f.log(u._random_fn())},variance:function(n){return f.pow(n,-2)}}),u.extend(u.gamma,{pdf:function(r,e,i){return r<0?0:r===0&&e===1?1/i:f.exp((e-1)*f.log(r)-r/i-u.gammaln(e)-e*f.log(i))},cdf:function(r,e,i){return r<0?0:u.lowRegGamma(e,r/i)},inv:function(n,r,e){return u.gammapinv(n,r)*e},mean:function(n,r){return n*r},mode:function(r,e){if(r>1)return(r-1)*e},sample:function(r,e){return u.randg(r)*e},variance:function(r,e){return r*e*e}}),u.extend(u.invgamma,{pdf:function(r,e,i){return r<=0?0:f.exp(-(e+1)*f.log(r)-i/r-u.gammaln(e)+e*f.log(i))},cdf:function(r,e,i){return r<=0?0:1-u.lowRegGamma(e,i/r)},inv:function(n,r,e){return e/u.gammapinv(1-n,r)},mean:function(n,r){return n>1?r/(n-1):void 0},mode:function(r,e){return e/(r+1)},sample:function(r,e){return e/u.randg(r)},variance:function(r,e){if(!(r<=2))return e*e/((r-1)*(r-1)*(r-2))}}),u.extend(u.kumaraswamy,{pdf:function(r,e,i){return r===0&&e===1?i:r===1&&i===1?e:f.exp(f.log(e)+f.log(i)+(e-1)*f.log(r)+(i-1)*f.log(1-f.pow(r,e)))},cdf:function(r,e,i){return r<0?0:r>1?1:1-f.pow(1-f.pow(r,e),i)},inv:function(r,e,i){return f.pow(1-f.pow(1-r,1/i),1/e)},mean:function(n,r){return r*u.gammafn(1+1/n)*u.gammafn(r)/u.gammafn(1+1/n+r)},median:function(r,e){return f.pow(1-f.pow(2,-1/e),1/r)},mode:function(r,e){if(r>=1&&e>=1&&r!==1&&e!==1)return f.pow((r-1)/(r*e-1),1/r)},variance:function(){throw new Error("variance not yet implemented")}}),u.extend(u.lognormal,{pdf:function(r,e,i){return r<=0?0:f.exp(-f.log(r)-.5*f.log(2*f.PI)-f.log(i)-f.pow(f.log(r)-e,2)/(2*i*i))},cdf:function(r,e,i){return r<0?0:.5+.5*u.erf((f.log(r)-e)/f.sqrt(2*i*i))},inv:function(n,r,e){return f.exp(-1.4142135623730951*e*u.erfcinv(2*n)+r)},mean:function(r,e){return f.exp(r+e*e/2)},median:function(r){return f.exp(r)},mode:function(r,e){return f.exp(r-e*e)},sample:function(r,e){return f.exp(u.randn()*e+r)},variance:function(r,e){return(f.exp(e*e)-1)*f.exp(2*r+e*e)}}),u.extend(u.noncentralt,{pdf:function(r,e,i){var o=1e-14;return f.abs(i)<o?u.studentt.pdf(r,e):f.abs(r)<o?f.exp(u.gammaln((e+1)/2)-i*i/2-.5*f.log(f.PI*e)-u.gammaln(e/2)):e/r*(u.noncentralt.cdf(r*f.sqrt(1+2/e),e+2,i)-u.noncentralt.cdf(r,e,i))},cdf:function(r,e,i){var o=1e-14,v=200;if(f.abs(i)<o)return u.studentt.cdf(r,e);var E=!1;r<0&&(E=!0,i=-i);for(var h=u.normal.cdf(-i,0,1),m=o+1,A=m,N=r*r/(r*r+e),T=0,R=f.exp(-i*i/2),O=f.exp(-i*i/2-.5*f.log(2)-u.gammaln(3/2))*i;T<v||A>o||m>o;)A=m,T>0&&(R*=i*i/(2*T),O*=i*i/(2*(T+1/2))),m=R*u.beta.cdf(N,T+.5,e/2)+O*u.beta.cdf(N,T+1,e/2),h+=.5*m,T++;return E?1-h:h}}),u.extend(u.normal,{pdf:function(r,e,i){return f.exp(-.5*f.log(2*f.PI)-f.log(i)-f.pow(r-e,2)/(2*i*i))},cdf:function(r,e,i){return .5*(1+u.erf((r-e)/f.sqrt(2*i*i)))},inv:function(n,r,e){return-1.4142135623730951*e*u.erfcinv(2*n)+r},mean:function(n){return n},median:function(r){return r},mode:function(n){return n},sample:function(r,e){return u.randn()*e+r},variance:function(n,r){return r*r}}),u.extend(u.pareto,{pdf:function(r,e,i){return r<e?0:i*f.pow(e,i)/f.pow(r,i+1)},cdf:function(r,e,i){return r<e?0:1-f.pow(e/r,i)},inv:function(r,e,i){return e/f.pow(1-r,1/i)},mean:function(r,e){if(!(e<=1))return e*f.pow(r,e)/(e-1)},median:function(r,e){return r*(e*f.SQRT2)},mode:function(r){return r},variance:function(n,r){if(!(r<=2))return n*n*r/(f.pow(r-1,2)*(r-2))}}),u.extend(u.studentt,{pdf:function(r,e){return e=e>1e100?1e100:e,1/(f.sqrt(e)*u.betafn(.5,e/2))*f.pow(1+r*r/e,-((e+1)/2))},cdf:function(r,e){var i=e/2;return u.ibeta((r+f.sqrt(r*r+e))/(2*f.sqrt(r*r+e)),i,i)},inv:function(n,r){var e=u.ibetainv(2*f.min(n,1-n),.5*r,.5);return e=f.sqrt(r*(1-e)/e),n>.5?e:-e},mean:function(r){return r>1?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(r){return u.randn()*f.sqrt(r/(2*u.randg(r/2)))},variance:function(r){return r>2?r/(r-2):r>1?1/0:void 0}}),u.extend(u.weibull,{pdf:function(r,e,i){return r<0||e<0||i<0?0:i/e*f.pow(r/e,i-1)*f.exp(-f.pow(r/e,i))},cdf:function(r,e,i){return r<0?0:1-f.exp(-f.pow(r/e,i))},inv:function(n,r,e){return r*f.pow(-f.log(1-n),1/e)},mean:function(n,r){return n*u.gammafn(1+1/r)},median:function(r,e){return r*f.pow(f.log(2),1/e)},mode:function(r,e){return e<=1?0:r*f.pow((e-1)/e,1/e)},sample:function(r,e){return r*f.pow(-f.log(u._random_fn()),1/e)},variance:function(r,e){return r*r*u.gammafn(1+2/e)-f.pow(u.weibull.mean(r,e),2)}}),u.extend(u.uniform,{pdf:function(r,e,i){return r<e||r>i?0:1/(i-e)},cdf:function(r,e,i){return r<e?0:r<i?(r-e)/(i-e):1},inv:function(n,r,e){return r+n*(e-r)},mean:function(r,e){return .5*(r+e)},median:function(r,e){return u.mean(r,e)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(r,e){return r/2+e/2+(e/2-r/2)*(2*u._random_fn()-1)},variance:function(r,e){return f.pow(e-r,2)/12}});function I(n,r,e,i){for(var o=0,v=1,E=1,h=1,m=0,A=0,N;f.abs((E-A)/E)>i;)A=E,N=-(r+m)*(r+e+m)*n/(r+2*m)/(r+2*m+1),o=E+N*o,v=h+N*v,m=m+1,N=m*(e-m)*n/(r+2*m-1)/(r+2*m),E=o+N*E,h=v+N*h,o=o/h,v=v/h,E=E/h,h=1;return E/r}u.extend(u.binomial,{pdf:function(r,e,i){return i===0||i===1?e*i===r?1:0:u.combination(e,r)*f.pow(i,r)*f.pow(1-i,e-r)},cdf:function(r,e,i){var o,v=1e-10;if(r<0)return 0;if(r>=e)return 1;if(i<0||i>1||e<=0)return NaN;r=f.floor(r);var E=i,h=r+1,m=e-r,A=h+m,N=f.exp(u.gammaln(A)-u.gammaln(m)-u.gammaln(h)+h*f.log(E)+m*f.log(1-E));return E<(h+1)/(A+2)?o=N*I(E,h,m,v):o=1-N*I(1-E,m,h,v),f.round((1-o)*(1/v))/(1/v)}}),u.extend(u.negbin,{pdf:function(r,e,i){return r!==r>>>0?!1:r<0?0:u.combination(r+e-1,e-1)*f.pow(1-i,r)*f.pow(i,e)},cdf:function(r,e,i){var o=0,v=0;if(r<0)return 0;for(;v<=r;v++)o+=u.negbin.pdf(v,e,i);return o}}),u.extend(u.hypgeom,{pdf:function(r,e,i,o){if(r!==r|0)return!1;if(r<0||r<i-(e-o))return 0;if(r>o||r>i)return 0;if(i*2>e)return o*2>e?u.hypgeom.pdf(e-i-o+r,e,e-i,e-o):u.hypgeom.pdf(o-r,e,e-i,o);if(o*2>e)return u.hypgeom.pdf(i-r,e,i,e-o);if(i<o)return u.hypgeom.pdf(r,e,o,i);for(var v=1,E=0,h=0;h<r;h++){for(;v>1&&E<o;)v*=1-i/(e-E),E++;v*=(o-h)*(i-h)/((h+1)*(e-i-o+h+1))}for(;E<o;E++)v*=1-i/(e-E);return f.min(1,f.max(0,v))},cdf:function(r,e,i,o){if(r<0||r<i-(e-o))return 0;if(r>=o||r>=i)return 1;if(i*2>e)return o*2>e?u.hypgeom.cdf(e-i-o+r,e,e-i,e-o):1-u.hypgeom.cdf(o-r-1,e,e-i,o);if(o*2>e)return 1-u.hypgeom.cdf(i-r-1,e,i,e-o);if(i<o)return u.hypgeom.cdf(r,e,o,i);for(var v=1,E=1,h=0,m=0;m<r;m++){for(;v>1&&h<o;){var A=1-i/(e-h);E*=A,v*=A,h++}E*=(o-m)*(i-m)/((m+1)*(e-i-o+m+1)),v+=E}for(;h<o;h++)v*=1-i/(e-h);return f.min(1,f.max(0,v))}}),u.extend(u.poisson,{pdf:function(r,e){return e<0||r%1!==0||r<0?0:f.pow(e,r)*f.exp(-e)/u.factorial(r)},cdf:function(r,e){var i=[],o=0;if(r<0)return 0;for(;o<=r;o++)i.push(u.poisson.pdf(o,e));return u.sum(i)},mean:function(n){return n},variance:function(n){return n},sampleSmall:function(r){var e=1,i=0,o=f.exp(-r);do i++,e*=u._random_fn();while(e>o);return i-1},sampleLarge:function(r){var e=r,i,o,v,E,h,m,A,N,T,R;for(E=f.sqrt(e),h=f.log(e),A=.931+2.53*E,m=-.059+.02483*A,N=1.1239+1.1328/(A-3.4),T=.9277-3.6224/(A-2);;){if(o=f.random()-.5,v=f.random(),R=.5-f.abs(o),i=f.floor((2*m/R+A)*o+e+.43),R>=.07&&v<=T)return i;if(!(i<0||R<.013&&v>R)&&f.log(v)+f.log(N)-f.log(m/(R*R)+A)<=-e+i*h-u.loggam(i+1))return i}},sample:function(r){return r<10?this.sampleSmall(r):this.sampleLarge(r)}}),u.extend(u.triangular,{pdf:function(r,e,i,o){return i<=e||o<e||o>i?NaN:r<e||r>i?0:r<o?2*(r-e)/((i-e)*(o-e)):r===o?2/(i-e):2*(i-r)/((i-e)*(i-o))},cdf:function(r,e,i,o){return i<=e||o<e||o>i?NaN:r<=e?0:r>=i?1:r<=o?f.pow(r-e,2)/((i-e)*(o-e)):1-f.pow(i-r,2)/((i-e)*(i-o))},inv:function(r,e,i,o){return i<=e||o<e||o>i?NaN:r<=(o-e)/(i-e)?e+(i-e)*f.sqrt(r*((o-e)/(i-e))):e+(i-e)*(1-f.sqrt((1-r)*(1-(o-e)/(i-e))))},mean:function(r,e,i){return(r+e+i)/3},median:function(r,e,i){if(i<=(r+e)/2)return e-f.sqrt((e-r)*(e-i))/f.sqrt(2);if(i>(r+e)/2)return r+f.sqrt((e-r)*(i-r))/f.sqrt(2)},mode:function(r,e,i){return i},sample:function(r,e,i){var o=u._random_fn();return o<(i-r)/(e-r)?r+f.sqrt(o*(e-r)*(i-r)):e-f.sqrt((1-o)*(e-r)*(e-i))},variance:function(r,e,i){return(r*r+e*e+i*i-r*e-r*i-e*i)/18}}),u.extend(u.arcsine,{pdf:function(r,e,i){return i<=e?NaN:r<=e||r>=i?0:2/f.PI*f.pow(f.pow(i-e,2)-f.pow(2*r-e-i,2),-.5)},cdf:function(r,e,i){return r<e?0:r<i?2/f.PI*f.asin(f.sqrt((r-e)/(i-e))):1},inv:function(n,r,e){return r+(.5-.5*f.cos(f.PI*n))*(e-r)},mean:function(r,e){return e<=r?NaN:(r+e)/2},median:function(r,e){return e<=r?NaN:(r+e)/2},mode:function(){throw new Error("mode is not yet implemented")},sample:function(r,e){return(r+e)/2+(e-r)/2*f.sin(2*f.PI*u.uniform.sample(0,1))},variance:function(r,e){return e<=r?NaN:f.pow(e-r,2)/8}});function s(n){return n/f.abs(n)}u.extend(u.laplace,{pdf:function(r,e,i){return i<=0?0:f.exp(-f.abs(r-e)/i)/(2*i)},cdf:function(r,e,i){return i<=0?0:r<e?.5*f.exp((r-e)/i):1-.5*f.exp(-(r-e)/i)},mean:function(n){return n},median:function(n){return n},mode:function(n){return n},variance:function(n,r){return 2*r*r},sample:function(r,e){var i=u._random_fn()-.5;return r-e*s(i)*f.log(1-2*f.abs(i))}});function t(n,r,e){var i=12,o=6,v=-30,E=-50,h=60,m=8,A=3,N=2,T=3,R=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],O=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],y=n*.5;if(y>=m)return 1;var p=2*u.normal.cdf(y,0,1,1,0)-1;p>=f.exp(E/e)?p=f.pow(p,e):p=0;var C;n>A?C=N:C=T;for(var M=y,d=(m-y)/C,P=M+d,V=0,J=e-1,cr=1;cr<=C;cr++){for(var _=0,F=.5*(P+M),er=.5*(P-M),G=1;G<=i;G++){var rr,tr;o<G?(rr=i-G+1,tr=R[rr-1]):(rr=G,tr=-R[rr-1]);var gr=er*tr,nr=F+gr,Ar=nr*nr;if(Ar>h)break;var Lr=2*u.normal.cdf(nr,0,1,1,0),Zr=2*u.normal.cdf(nr,n,1,1,0),Or=Lr*.5-Zr*.5;Or>=f.exp(v/J)&&(Or=O[rr-1]*f.exp(-(.5*Ar))*f.pow(Or,J),_+=Or)}_*=2*er*e/f.sqrt(2*f.PI),V+=_,M=P,P+=d}return p+=V,p<=f.exp(v/r)?0:(p=f.pow(p,r),p>=1?1:p)}function a(n,r,e){var i=.322232421088,o=.099348462606,v=-1,E=.588581570495,h=-.342242088547,m=.531103462366,A=-.204231210125,N=.10353775285,T=-453642210148e-16,R=.0038560700634,O=.8832,y=.2368,p=1.208,C=1.4142,M=120,d=.5-.5*n,P=f.sqrt(f.log(1/(d*d))),V=P+((((P*T+A)*P+h)*P+v)*P+i)/((((P*R+N)*P+m)*P+E)*P+o);e<M&&(V+=(V*V*V+V)/e/4);var J=O-y*V;return e<M&&(J+=-1.214/e+p*V/e),V*(J*f.log(r-1)+C)}u.extend(u.tukey,{cdf:function(r,e,i){var o=1,v=e,E=16,h=8,m=-30,A=1e-14,N=100,T=800,R=5e3,O=25e3,y=1,p=.5,C=.25,M=.125,d=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],P=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(r<=0)return 0;if(i<2||o<1||v<2)return NaN;if(!Number.isFinite(r))return 1;if(i>O)return t(r,o,v);var V=i*.5,J=V*f.log(i)-i*f.log(2)-u.gammaln(V),cr=V-1,_=i*.25,F;i<=N?F=y:i<=T?F=p:i<=R?F=C:F=M,J+=f.log(F);for(var er=0,G=1;G<=50;G++){for(var rr=0,tr=(2*G-1)*F,gr=1;gr<=E;gr++){var nr,Ar;h<gr?(nr=gr-h-1,Ar=J+cr*f.log(tr+d[nr]*F)-(d[nr]*F+tr)*_):(nr=gr-1,Ar=J+cr*f.log(tr-d[nr]*F)+(d[nr]*F-tr)*_);var Lr;if(Ar>=m){h<gr?Lr=r*f.sqrt((d[nr]*F+tr)*.5):Lr=r*f.sqrt((-(d[nr]*F)+tr)*.5);var Zr=t(Lr,o,v),Or=Zr*P[nr]*f.exp(Ar);rr+=Or}}if(G*F>=1&&rr<=A)break;er+=rr}if(rr>A)throw new Error("tukey.cdf failed to converge");return er>1&&(er=1),er},inv:function(n,r,e){var i=1,o=r,v=1e-4,E=50;if(e<2||i<1||o<2)return NaN;if(n<0||n>1)return NaN;if(n===0)return 0;if(n===1)return 1/0;var h=a(n,o,e),m=u.tukey.cdf(h,r,e)-n,A;m>0?A=f.max(0,h-1):A=h+1;for(var N=u.tukey.cdf(A,r,e)-n,T,R=1;R<E;R++){T=A-N*(A-h)/(N-m),m=N,h=A,T<0&&(T=0,N=-n),N=u.tukey.cdf(T,r,e)-n,A=T;var O=f.abs(A-h);if(O<v)return T}throw new Error("tukey.inv failed to converge")}})}(g,Math),function(u,f){var I=Array.prototype.push,s=u.utils.isArray;function t(a){return s(a)||a instanceof u}u.extend({add:function(n,r){return t(r)?(t(r[0])||(r=[r]),u.map(n,function(e,i,o){return e+r[i][o]})):u.map(n,function(e){return e+r})},subtract:function(n,r){return t(r)?(t(r[0])||(r=[r]),u.map(n,function(e,i,o){return e-r[i][o]||0})):u.map(n,function(e){return e-r})},divide:function(n,r){return t(r)?(t(r[0])||(r=[r]),u.multiply(n,u.inv(r))):u.map(n,function(e){return e/r})},multiply:function(n,r){var e,i,o,v,E,h,m,A;if(n.length===void 0&&r.length===void 0)return n*r;if(E=n.length,h=n[0].length,m=u.zeros(E,o=t(r)?r[0].length:h),A=0,t(r)){for(;A<o;A++)for(e=0;e<E;e++){for(v=0,i=0;i<h;i++)v+=n[e][i]*r[i][A];m[e][A]=v}return E===1&&A===1?m[0][0]:m}return u.map(n,function(N){return N*r})},outer:function(n,r){return u.multiply(n.map(function(e){return[e]}),[r])},dot:function(n,r){t(n[0])||(n=[n]),t(r[0])||(r=[r]);for(var e=n[0].length===1&&n.length!==1?u.transpose(n):n,i=r[0].length===1&&r.length!==1?u.transpose(r):r,o=[],v=0,E=e.length,h=e[0].length,m,A;v<E;v++){for(o[v]=[],m=0,A=0;A<h;A++)m+=e[v][A]*i[v][A];o[v]=m}return o.length===1?o[0]:o},pow:function(n,r){return u.map(n,function(e){return f.pow(e,r)})},exp:function(n){return u.map(n,function(r){return f.exp(r)})},log:function(n){return u.map(n,function(r){return f.log(r)})},abs:function(n){return u.map(n,function(r){return f.abs(r)})},norm:function(n,r){var e=0,i=0;for(isNaN(r)&&(r=2),t(n[0])&&(n=n[0]);i<n.length;i++)e+=f.pow(f.abs(n[i]),r);return f.pow(e,1/r)},angle:function(n,r){return f.acos(u.dot(n,r)/(u.norm(n)*u.norm(r)))},aug:function(n,r){var e=[],i;for(i=0;i<n.length;i++)e.push(n[i].slice());for(i=0;i<e.length;i++)I.apply(e[i],r[i]);return e},inv:function(n){for(var r=n.length,e=n[0].length,i=u.identity(r,e),o=u.gauss_jordan(n,i),v=[],E=0,h;E<r;E++)for(v[E]=[],h=e;h<o[0].length;h++)v[E][h-e]=o[E][h];return v},det:function a(n){if(n.length===2)return n[0][0]*n[1][1]-n[0][1]*n[1][0];for(var r=0,e=0;e<n.length;e++){for(var i=[],o=1;o<n.length;o++){i[o-1]=[];for(var v=0;v<n.length;v++)v<e?i[o-1][v]=n[o][v]:v>e&&(i[o-1][v-1]=n[o][v])}var E=e%2?-1:1;r+=a(i)*n[0][e]*E}return r},gauss_elimination:function(n,r){var e=0,i=0,o=n.length,v=n[0].length,E=1,h=0,m=[],A,N,T,R;for(n=u.aug(n,r),A=n[0].length,e=0;e<o;e++){for(N=n[e][e],i=e,R=e+1;R<v;R++)N<f.abs(n[R][e])&&(N=n[R][e],i=R);if(i!=e)for(R=0;R<A;R++)T=n[e][R],n[e][R]=n[i][R],n[i][R]=T;for(i=e+1;i<o;i++)for(E=n[i][e]/n[e][e],R=e;R<A;R++)n[i][R]=n[i][R]-E*n[e][R]}for(e=o-1;e>=0;e--){for(h=0,i=e+1;i<=o-1;i++)h=h+m[i]*n[e][i];m[e]=(n[e][A-1]-h)/n[e][e]}return m},gauss_jordan:function(n,r){var e=u.aug(n,r),i=e.length,o=e[0].length,v=0,E,h,m;for(h=0;h<i;h++){var A=h;for(m=h+1;m<i;m++)f.abs(e[m][h])>f.abs(e[A][h])&&(A=m);var N=e[h];for(e[h]=e[A],e[A]=N,m=h+1;m<i;m++)for(v=e[m][h]/e[h][h],E=h;E<o;E++)e[m][E]-=e[h][E]*v}for(h=i-1;h>=0;h--){for(v=e[h][h],m=0;m<h;m++)for(E=o-1;E>h-1;E--)e[m][E]-=e[h][E]*e[m][h]/v;for(e[h][h]/=v,E=i;E<o;E++)e[h][E]/=v}return e},triaUpSolve:function(n,r){var e=n[0].length,i=u.zeros(1,e)[0],o,v=!1;return r[0].length!=null&&(r=r.map(function(E){return E[0]}),v=!0),u.arange(e-1,-1,-1).forEach(function(E){o=u.arange(E+1,e).map(function(h){return i[h]*n[E][h]}),i[E]=(r[E]-u.sum(o))/n[E][E]}),v?i.map(function(E){return[E]}):i},triaLowSolve:function(n,r){var e=n[0].length,i=u.zeros(1,e)[0],o,v=!1;return r[0].length!=null&&(r=r.map(function(E){return E[0]}),v=!0),u.arange(e).forEach(function(E){o=u.arange(E).map(function(h){return n[E][h]*i[h]}),i[E]=(r[E]-u.sum(o))/n[E][E]}),v?i.map(function(E){return[E]}):i},lu:function(n){var r=n.length,e=u.identity(r),i=u.zeros(n.length,n[0].length),o;return u.arange(r).forEach(function(v){i[0][v]=n[0][v]}),u.arange(1,r).forEach(function(v){u.arange(v).forEach(function(E){o=u.arange(E).map(function(h){return e[v][h]*i[h][E]}),e[v][E]=(n[v][E]-u.sum(o))/i[E][E]}),u.arange(v,r).forEach(function(E){o=u.arange(v).map(function(h){return e[v][h]*i[h][E]}),i[v][E]=n[o.length][E]-u.sum(o)})}),[e,i]},cholesky:function(n){var r=n.length,e=u.zeros(n.length,n[0].length),i;return u.arange(r).forEach(function(o){i=u.arange(o).map(function(v){return f.pow(e[o][v],2)}),e[o][o]=f.sqrt(n[o][o]-u.sum(i)),u.arange(o+1,r).forEach(function(v){i=u.arange(o).map(function(E){return e[o][E]*e[v][E]}),e[v][o]=(n[o][v]-u.sum(i))/e[o][o]})}),e},gauss_jacobi:function(n,r,e,i){for(var o=0,v=0,E=n.length,h=[],m=[],A=[],N,T,R,O;o<E;o++)for(h[o]=[],m[o]=[],A[o]=[],v=0;v<E;v++)o>v?(h[o][v]=n[o][v],m[o][v]=A[o][v]=0):o<v?(m[o][v]=n[o][v],h[o][v]=A[o][v]=0):(A[o][v]=n[o][v],h[o][v]=m[o][v]=0);for(R=u.multiply(u.multiply(u.inv(A),u.add(h,m)),-1),T=u.multiply(u.inv(A),r),N=e,O=u.add(u.multiply(R,e),T),o=2;f.abs(u.norm(u.subtract(O,N)))>i;)N=O,O=u.add(u.multiply(R,N),T),o++;return O},gauss_seidel:function(n,r,e,i){for(var o=0,v=n.length,E=[],h=[],m=[],A,N,T,R,O;o<v;o++)for(E[o]=[],h[o]=[],m[o]=[],A=0;A<v;A++)o>A?(E[o][A]=n[o][A],h[o][A]=m[o][A]=0):o<A?(h[o][A]=n[o][A],E[o][A]=m[o][A]=0):(m[o][A]=n[o][A],E[o][A]=h[o][A]=0);for(R=u.multiply(u.multiply(u.inv(u.add(m,E)),h),-1),T=u.multiply(u.inv(u.add(m,E)),r),N=e,O=u.add(u.multiply(R,e),T),o=2;f.abs(u.norm(u.subtract(O,N)))>i;)N=O,O=u.add(u.multiply(R,N),T),o=o+1;return O},SOR:function(n,r,e,i,o){for(var v=0,E=n.length,h=[],m=[],A=[],N,T,R,O,y;v<E;v++)for(h[v]=[],m[v]=[],A[v]=[],N=0;N<E;N++)v>N?(h[v][N]=n[v][N],m[v][N]=A[v][N]=0):v<N?(m[v][N]=n[v][N],h[v][N]=A[v][N]=0):(A[v][N]=n[v][N],h[v][N]=m[v][N]=0);for(O=u.multiply(u.inv(u.add(A,u.multiply(h,o))),u.subtract(u.multiply(A,1-o),u.multiply(m,o))),R=u.multiply(u.multiply(u.inv(u.add(A,u.multiply(h,o))),r),o),T=e,y=u.add(u.multiply(O,e),R),v=2;f.abs(u.norm(u.subtract(y,T)))>i;)T=y,y=u.add(u.multiply(O,T),R),v++;return y},householder:function(n){for(var r=n.length,e=n[0].length,i=0,o=[],v=[],E,h,m,A,N;i<r-1;i++){for(E=0,A=i+1;A<e;A++)E+=n[A][i]*n[A][i];for(N=n[i+1][i]>0?-1:1,E=N*f.sqrt(E),h=f.sqrt((E*E-n[i+1][i]*E)/2),o=u.zeros(r,1),o[i+1][0]=(n[i+1][i]-E)/(2*h),m=i+2;m<r;m++)o[m][0]=n[m][i]/(2*h);v=u.subtract(u.identity(r,e),u.multiply(u.multiply(o,u.transpose(o)),2)),n=u.multiply(v,u.multiply(n,v))}return n},QR:function(){var a=u.sum,n=u.arange;function r(e){var i=e.length,o=e[0].length,v=u.zeros(o,o);e=u.copy(e);var E,h,m;for(h=0;h<o;h++){for(v[h][h]=f.sqrt(a(n(i).map(function(A){return e[A][h]*e[A][h]}))),E=0;E<i;E++)e[E][h]=e[E][h]/v[h][h];for(m=h+1;m<o;m++)for(v[h][m]=a(n(i).map(function(A){return e[A][h]*e[A][m]})),E=0;E<i;E++)e[E][m]=e[E][m]-e[E][h]*v[h][m]}return[e,v]}return r}(),lstsq:function(){function a(r){r=u.copy(r);var e=r.length,i=u.identity(e);return u.arange(e-1,-1,-1).forEach(function(o){u.sliceAssign(i,{row:o},u.divide(u.slice(i,{row:o}),r[o][o])),u.sliceAssign(r,{row:o},u.divide(u.slice(r,{row:o}),r[o][o])),u.arange(o).forEach(function(v){var E=u.multiply(r[v][o],-1),h=u.slice(r,{row:v}),m=u.multiply(u.slice(r,{row:o}),E);u.sliceAssign(r,{row:v},u.add(h,m));var A=u.slice(i,{row:v}),N=u.multiply(u.slice(i,{row:o}),E);u.sliceAssign(i,{row:v},u.add(A,N))})}),i}function n(r,e){var i=!1;e[0].length===void 0&&(e=e.map(function(O){return[O]}),i=!0);var o=u.QR(r),v=o[0],E=o[1],h=r[0].length,m=u.slice(v,{col:{end:h}}),A=u.slice(E,{row:{end:h}}),N=a(A),T=u.transpose(m);T[0].length===void 0&&(T=[T]);var R=u.multiply(u.multiply(N,T),e);return R.length===void 0&&(R=[[R]]),i?R.map(function(O){return O[0]}):R}return n}(),jacobi:function(n){for(var r=1,e=n.length,i=u.identity(e,e),o=[],v,E,h,m,A,N,T,R;r===1;){for(N=n[0][1],m=0,A=1,E=0;E<e;E++)for(h=0;h<e;h++)E!=h&&N<f.abs(n[E][h])&&(N=f.abs(n[E][h]),m=E,A=h);for(n[m][m]===n[A][A]?T=n[m][A]>0?f.PI/4:-f.PI/4:T=f.atan(2*n[m][A]/(n[m][m]-n[A][A]))/2,R=u.identity(e,e),R[m][m]=f.cos(T),R[m][A]=-f.sin(T),R[A][m]=f.sin(T),R[A][A]=f.cos(T),i=u.multiply(i,R),v=u.multiply(u.multiply(u.inv(R),n),R),n=v,r=0,E=1;E<e;E++)for(h=1;h<e;h++)E!=h&&f.abs(n[E][h])>.001&&(r=1)}for(E=0;E<e;E++)o.push(n[E][E]);return[i,o]},rungekutta:function(n,r,e,i,o,v){var E,h,m,A,N;if(v===2)for(;i<=e;)E=r*n(i,o),h=r*n(i+r,o+E),m=o+(E+h)/2,o=m,i=i+r;if(v===4)for(;i<=e;)E=r*n(i,o),h=r*n(i+r/2,o+E/2),A=r*n(i+r/2,o+h/2),N=r*n(i+r,o+A),m=o+(E+2*h+2*A+N)/6,o=m,i=i+r;return o},romberg:function(n,r,e,i){for(var o=0,v=(e-r)/2,E=[],h=[],m=[],A,N,T,R,O;o<i/2;){for(O=n(r),T=r,R=0;T<=e;T=T+v,R++)E[R]=T;for(A=E.length,T=1;T<A-1;T++)O+=(T%2!==0?4:2)*n(E[T]);O=v/3*(O+n(e)),m[o]=O,v/=2,o++}for(N=m.length,A=1;N!==1;){for(T=0;T<N-1;T++)h[T]=(f.pow(4,A)*m[T+1]-m[T])/(f.pow(4,A)-1);N=h.length,m=h,h=[],A++}return m},richardson:function(n,r,e,i){function o(y,p){for(var C=0,M=y.length,d;C<M;C++)y[C]===p&&(d=C);return d}for(var v=f.abs(e-n[o(n,e)+1]),E=0,h=[],m=[],A,N,T,R,O;i>=v;)A=o(n,e+i),N=o(n,e),h[E]=(r[A]-2*r[N]+r[2*N-A])/(i*i),i/=2,E++;for(R=h.length,T=1;R!=1;){for(O=0;O<R-1;O++)m[O]=(f.pow(4,T)*h[O+1]-h[O])/(f.pow(4,T)-1);R=m.length,h=m,m=[],T++}return h},simpson:function(n,r,e,i){for(var o=(e-r)/i,v=n(r),E=[],h=r,m=0,A=1,N;h<=e;h=h+o,m++)E[m]=h;for(N=E.length;A<N-1;A++)v+=(A%2!==0?4:2)*n(E[A]);return o/3*(v+n(e))},hermite:function(n,r,e,i){for(var o=n.length,v=0,E=0,h=[],m=[],A=[],N=[],T;E<o;E++){for(h[E]=1,T=0;T<o;T++)E!=T&&(h[E]*=(i-n[T])/(n[E]-n[T]));for(m[E]=0,T=0;T<o;T++)E!=T&&(m[E]+=1/(n[E]-n[T]));A[E]=(1-2*(i-n[E])*m[E])*(h[E]*h[E]),N[E]=(i-n[E])*(h[E]*h[E]),v+=A[E]*r[E]+N[E]*e[E]}return v},lagrange:function(n,r,e){for(var i=0,o=0,v,E,h=n.length;o<h;o++){for(E=r[o],v=0;v<h;v++)o!=v&&(E*=(e-n[v])/(n[o]-n[v]));i+=E}return i},cubic_spline:function(n,r,e){for(var i=n.length,o=0,v,E=[],h=[],m=[],A=[],N=[],T=[],R=[];o<i-1;o++)N[o]=n[o+1]-n[o];for(m[0]=0,o=1;o<i-1;o++)m[o]=3/N[o]*(r[o+1]-r[o])-3/N[o-1]*(r[o]-r[o-1]);for(o=1;o<i-1;o++)E[o]=[],h[o]=[],E[o][o-1]=N[o-1],E[o][o]=2*(N[o-1]+N[o]),E[o][o+1]=N[o],h[o][0]=m[o];for(A=u.multiply(u.inv(E),h),v=0;v<i-1;v++)T[v]=(r[v+1]-r[v])/N[v]-N[v]*(A[v+1][0]+2*A[v][0])/3,R[v]=(A[v+1][0]-A[v][0])/(3*N[v]);for(v=0;v<i&&!(n[v]>e);v++);return v-=1,r[v]+(e-n[v])*T[v]+u.sq(e-n[v])*A[v]+(e-n[v])*u.sq(e-n[v])*R[v]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(n){var r=n.length,e=n[0].length,i=0,o,v,E=[],h=[],m=[],A=[],N=[],T=[],R=[],O=[],y=[],p=[];for(i=0;i<r;i++)E[i]=u.sum(n[i])/e;for(i=0;i<e;i++)for(R[i]=[],o=0;o<r;o++)R[i][o]=n[o][i]-E[o];for(R=u.transpose(R),i=0;i<r;i++)for(O[i]=[],o=0;o<r;o++)O[i][o]=u.dot([R[i]],[R[o]])/(e-1);for(m=u.jacobi(O),y=m[0],h=m[1],p=u.transpose(y),i=0;i<h.length;i++)for(o=i;o<h.length;o++)h[i]<h[o]&&(v=h[i],h[i]=h[o],h[o]=v,A=p[i],p[i]=p[o],p[o]=A);for(T=u.transpose(R),i=0;i<r;i++)for(N[i]=[],o=0;o<T.length;o++)N[i][o]=u.dot([p[i]],[T[o]]);return[n,h,p,N]}}),function(a){for(var n=0;n<a.length;n++)(function(r){u.fn[r]=function(e,i){var o=this;return i?(setTimeout(function(){i.call(o,u.fn[r].call(o,e))},15),this):typeof u[r](this,e)=="number"?u[r](this,e):u(u[r](this,e))}})(a[n])}("add divide multiply subtract dot pow exp log abs norm angle".split(" "))}(g,Math),function(u,f){var I=[].slice,s=u.utils.isNumber,t=u.utils.isArray;u.extend({zscore:function(){var r=I.call(arguments);return s(r[1])?(r[0]-r[1])/r[2]:(r[0]-u.mean(r[1]))/u.stdev(r[1],r[2])},ztest:function(){var r=I.call(arguments),e;return t(r[1])?(e=u.zscore(r[0],r[1],r[3]),r[2]===1?u.normal.cdf(-f.abs(e),0,1):u.normal.cdf(-f.abs(e),0,1)*2):r.length>2?(e=u.zscore(r[0],r[1],r[2]),r[3]===1?u.normal.cdf(-f.abs(e),0,1):u.normal.cdf(-f.abs(e),0,1)*2):(e=r[0],r[1]===1?u.normal.cdf(-f.abs(e),0,1):u.normal.cdf(-f.abs(e),0,1)*2)}}),u.extend(u.fn,{zscore:function(r,e){return(r-this.mean())/this.stdev(e)},ztest:function(r,e,i){var o=f.abs(this.zscore(r,i));return e===1?u.normal.cdf(-o,0,1):u.normal.cdf(-o,0,1)*2}}),u.extend({tscore:function(){var r=I.call(arguments);return r.length===4?(r[0]-r[1])/(r[2]/f.sqrt(r[3])):(r[0]-u.mean(r[1]))/(u.stdev(r[1],!0)/f.sqrt(r[1].length))},ttest:function(){var r=I.call(arguments),e;return r.length===5?(e=f.abs(u.tscore(r[0],r[1],r[2],r[3])),r[4]===1?u.studentt.cdf(-e,r[3]-1):u.studentt.cdf(-e,r[3]-1)*2):s(r[1])?(e=f.abs(r[0]),r[2]==1?u.studentt.cdf(-e,r[1]-1):u.studentt.cdf(-e,r[1]-1)*2):(e=f.abs(u.tscore(r[0],r[1])),r[2]==1?u.studentt.cdf(-e,r[1].length-1):u.studentt.cdf(-e,r[1].length-1)*2)}}),u.extend(u.fn,{tscore:function(r){return(r-this.mean())/(this.stdev(!0)/f.sqrt(this.cols()))},ttest:function(r,e){return e===1?1-u.studentt.cdf(f.abs(this.tscore(r)),this.cols()-1):u.studentt.cdf(-f.abs(this.tscore(r)),this.cols()-1)*2}}),u.extend({anovafscore:function(){var r=I.call(arguments),e,i,o,v,E,h,m,A;if(r.length===1){for(E=new Array(r[0].length),m=0;m<r[0].length;m++)E[m]=r[0][m];r=E}for(i=new Array,m=0;m<r.length;m++)i=i.concat(r[m]);for(o=u.mean(i),e=0,m=0;m<r.length;m++)e=e+r[m].length*f.pow(u.mean(r[m])-o,2);for(e/=r.length-1,h=0,m=0;m<r.length;m++)for(v=u.mean(r[m]),A=0;A<r[m].length;A++)h+=f.pow(r[m][A]-v,2);return h/=i.length-r.length,e/h},anovaftest:function(){var r=I.call(arguments),e,i,o,v;if(s(r[0]))return 1-u.centralF.cdf(r[0],r[1],r[2]);var E=u.anovafscore(r);for(e=r.length-1,o=0,v=0;v<r.length;v++)o=o+r[v].length;return i=o-e-1,1-u.centralF.cdf(E,e,i)},ftest:function(r,e,i){return 1-u.centralF.cdf(r,e,i)}}),u.extend(u.fn,{anovafscore:function(){return u.anovafscore(this.toArray())},anovaftes:function(){var r=0,e;for(e=0;e<this.length;e++)r=r+this[e].length;return u.ftest(this.anovafscore(),this.length-1,r-this.length)}}),u.extend({qscore:function(){var r=I.call(arguments),e,i,o,v,E;return s(r[0])?(e=r[0],i=r[1],o=r[2],v=r[3],E=r[4]):(e=u.mean(r[0]),i=u.mean(r[1]),o=r[0].length,v=r[1].length,E=r[2]),f.abs(e-i)/(E*f.sqrt((1/o+1/v)/2))},qtest:function(){var r=I.call(arguments),e;r.length===3?(e=r[0],r=r.slice(1)):r.length===7?(e=u.qscore(r[0],r[1],r[2],r[3],r[4]),r=r.slice(5)):(e=u.qscore(r[0],r[1],r[2]),r=r.slice(3));var i=r[0],o=r[1];return 1-u.tukey.cdf(e,o,i-o)},tukeyhsd:function(r){for(var e=u.pooledstdev(r),i=r.map(function(A){return u.mean(A)}),o=r.reduce(function(A,N){return A+N.length},0),v=[],E=0;E<r.length;++E)for(var h=E+1;h<r.length;++h){var m=u.qtest(i[E],i[h],r[E].length,r[h].length,e,o,r.length);v.push([[E,h],m])}return v}}),u.extend({normalci:function(){var r=I.call(arguments),e=new Array(2),i;return r.length===4?i=f.abs(u.normal.inv(r[1]/2,0,1)*r[2]/f.sqrt(r[3])):i=f.abs(u.normal.inv(r[1]/2,0,1)*u.stdev(r[2])/f.sqrt(r[2].length)),e[0]=r[0]-i,e[1]=r[0]+i,e},tci:function(){var r=I.call(arguments),e=new Array(2),i;return r.length===4?i=f.abs(u.studentt.inv(r[1]/2,r[3]-1)*r[2]/f.sqrt(r[3])):i=f.abs(u.studentt.inv(r[1]/2,r[2].length-1)*u.stdev(r[2],!0)/f.sqrt(r[2].length)),e[0]=r[0]-i,e[1]=r[0]+i,e},significant:function(r,e){return r<e}}),u.extend(u.fn,{normalci:function(r,e){return u.normalci(r,e,this.toArray())},tci:function(r,e){return u.tci(r,e,this.toArray())}});function a(n,r,e,i){if(n>1||e>1||n<=0||e<=0)throw new Error("Proportions should be greater than 0 and less than 1");var o=(n*r+e*i)/(r+i),v=f.sqrt(o*(1-o)*(1/r+1/i));return(n-e)/v}u.extend(u.fn,{oneSidedDifferenceOfProportions:function(r,e,i,o){var v=a(r,e,i,o);return u.ztest(v,1)},twoSidedDifferenceOfProportions:function(r,e,i,o){var v=a(r,e,i,o);return u.ztest(v,2)}})}(g,Math),g.models=function(){function u(a){var n=a[0].length,r=g.arange(n).map(function(e){var i=g.arange(n).filter(function(o){return o!==e});return f(g.col(a,e).map(function(o){return o[0]}),g.col(a,i))});return r}function f(a,n){var r=a.length,e=n[0].length-1,i=r-e-1,o=g.lstsq(n,a),v=g.multiply(n,o.map(function(R){return[R]})).map(function(R){return R[0]}),E=g.subtract(a,v),h=g.mean(a),m=g.sum(v.map(function(R){return Math.pow(R-h,2)})),A=g.sum(a.map(function(R,O){return Math.pow(R-v[O],2)})),N=m+A,T=m/N;return{exog:n,endog:a,nobs:r,df_model:e,df_resid:i,coef:o,predict:v,resid:E,ybar:h,SST:N,SSE:m,SSR:A,R2:T}}function I(a){var n=u(a.exog),r=Math.sqrt(a.SSR/a.df_resid),e=n.map(function(h){var m=h.SST,A=h.R2;return r/Math.sqrt(m*(1-A))}),i=a.coef.map(function(h,m){return(h-0)/e[m]}),o=i.map(function(h){var m=g.studentt.cdf(h,a.df_resid);return(m>.5?1-m:m)*2}),v=g.studentt.inv(.975,a.df_resid),E=a.coef.map(function(h,m){var A=v*e[m];return[h-A,h+A]});return{se:e,t:i,p:o,sigmaHat:r,interval95:E}}function s(a){var n=a.R2/a.df_model/((1-a.R2)/a.df_resid),r=function(i,o,v){return g.beta.cdf(i/(v/o+i),o/2,v/2)},e=1-r(n,a.df_model,a.df_resid);return{F_statistic:n,pvalue:e}}function t(a,n){var r=f(a,n),e=I(r),i=s(r),o=1-(1-r.R2)*((r.nobs-1)/r.df_resid);return r.t=e,r.f=i,r.adjust_R2=o,r}return{ols:t}}(),g.extend({buildxmatrix:function(){for(var f=new Array(arguments.length),I=0;I<arguments.length;I++){var s=[1];f[I]=s.concat(arguments[I])}return g(f)},builddxmatrix:function(){for(var f=new Array(arguments[0].length),I=0;I<arguments[0].length;I++){var s=[1];f[I]=s.concat(arguments[0][I])}return g(f)},buildjxmatrix:function(f){for(var I=new Array(f.length),s=0;s<f.length;s++)I[s]=f[s];return g.builddxmatrix(I)},buildymatrix:function(f){return g(f).transpose()},buildjymatrix:function(f){return f.transpose()},matrixmult:function(f,I){var s,t,a,n,r;if(f.cols()==I.rows()){if(I.rows()>1){for(n=[],s=0;s<f.rows();s++)for(n[s]=[],t=0;t<I.cols();t++){for(r=0,a=0;a<f.cols();a++)r+=f.toArray()[s][a]*I.toArray()[a][t];n[s][t]=r}return g(n)}for(n=[],s=0;s<f.rows();s++)for(n[s]=[],t=0;t<I.cols();t++){for(r=0,a=0;a<f.cols();a++)r+=f.toArray()[s][a]*I.toArray()[t];n[s][t]=r}return g(n)}},regress:function(f,I){var s=g.xtranspxinv(f),t=f.transpose(),a=g.matrixmult(g(s),t);return g.matrixmult(a,I)},regresst:function(f,I,s){var t=g.regress(f,I),a={};a.anova={};var n=g.jMatYBar(f,t);a.yBar=n;var r=I.mean();a.anova.residuals=g.residuals(I,n),a.anova.ssr=g.ssr(n,r),a.anova.msr=a.anova.ssr/(f[0].length-1),a.anova.sse=g.sse(I,n),a.anova.mse=a.anova.sse/(I.length-(f[0].length-1)-1),a.anova.sst=g.sst(I,r),a.anova.mst=a.anova.sst/(I.length-1),a.anova.r2=1-a.anova.sse/a.anova.sst,a.anova.r2<0&&(a.anova.r2=0),a.anova.fratio=a.anova.msr/a.anova.mse,a.anova.pvalue=g.anovaftest(a.anova.fratio,f[0].length-1,I.length-(f[0].length-1)-1),a.anova.rmse=Math.sqrt(a.anova.mse),a.anova.r2adj=1-a.anova.mse/a.anova.mst,a.anova.r2adj<0&&(a.anova.r2adj=0),a.stats=new Array(f[0].length);for(var e=g.xtranspxinv(f),i,o,v,E=0;E<t.length;E++)i=Math.sqrt(a.anova.mse*Math.abs(e[E][E])),o=Math.abs(t[E]/i),v=g.ttest(o,I.length-f[0].length-1,s),a.stats[E]=[t[E],i,o,v];return a.regress=t,a},xtranspx:function(f){return g.matrixmult(f.transpose(),f)},xtranspxinv:function(f){var I=g.matrixmult(f.transpose(),f),s=g.inv(I);return s},jMatYBar:function(f,I){var s=g.matrixmult(f,I);return new g(s)},residuals:function(f,I){return g.matrixsubtract(f,I)},ssr:function(f,I){for(var s=0,t=0;t<f.length;t++)s+=Math.pow(f[t]-I,2);return s},sse:function(f,I){for(var s=0,t=0;t<f.length;t++)s+=Math.pow(f[t]-I[t],2);return s},sst:function(f,I){for(var s=0,t=0;t<f.length;t++)s+=Math.pow(f[t]-I,2);return s},matrixsubtract:function(f,I){for(var s=new Array(f.length),t=0;t<f.length;t++){s[t]=new Array(f[t].length);for(var a=0;a<f[t].length;a++)s[t][a]=f[t][a]-I[t][a]}return g(s)}}),g.jStat=g,g})})(Gn);var bn=Gn.exports,mr={},te="=",ue=[">",">=","<","<=","=","<>"],pr="operator",kr="literal",ae=[pr,kr];mr.TOKEN_TYPE_OPERATOR=pr;mr.TOKEN_TYPE_LITERAL=kr;function Br(l,c){if(ae.indexOf(c)===-1)throw new Error("Unsupported token type: "+c);return{value:l,type:c}}function fe(l){return typeof l!="string"||/^\d+(\.\d+)?$/.test(l)&&(l=l.indexOf(".")===-1?parseInt(l,10):parseFloat(l)),l}function ie(l){for(var c=l.length,g=[],u=0,f="",I="";u<c;){var s=l.charAt(u);switch(s){case">":case"<":case"=":I=I+s,f.length>0&&(g.push(f),f="");break;default:I.length>0&&(g.push(I),I=""),f=f+s;break}u++}return f.length>0&&g.push(f),I.length>0&&g.push(I),g}function oe(l){for(var c="",g=[],u=0;u<l.length;u++){var f=l[u];u===0&&ue.indexOf(f)>=0?g.push(Br(f,pr)):c+=f}return c.length>0&&g.push(Br(fe(c),kr)),g.length>0&&g[0].type!==pr&&g.unshift(Br(te,pr)),g}function le(l){for(var c=[],g,u=0;u<l.length;u++){var f=l[u];switch(f.type){case pr:g=f.value;break;case kr:c.push(f.value);break}}return se(c,g)}function se(l,c){var g=!1;switch(c){case">":g=l[0]>l[1];break;case">=":g=l[0]>=l[1];break;case"<":g=l[0]<l[1];break;case"<=":g=l[0]<=l[1];break;case"=":g=l[0]==l[1];break;case"<>":g=l[0]!=l[1];break}return g}mr.parse=function(l){return oe(ie(l))};mr.createToken=Br;mr.compute=le;var Ir={},Bn=sr,ce=B;Ir.UNIQUE=function(){for(var l=[],c=0;c<arguments.length;++c){for(var g=!1,u=arguments[c],f=0;f<l.length&&(g=l[f]===u,!g);++f);g||l.push(u)}return l};Ir.FLATTEN=Bn.flatten;Ir.ARGS2ARRAY=function(){return Array.prototype.slice.call(arguments,0)};Ir.REFERENCE=function(l,c){if(!arguments.length)return ce.error;try{for(var g=c.split("."),u=l,f=0;f<g.length;++f){var I=g[f];if(I[I.length-1]==="]"){var s=I.indexOf("["),t=I.substring(s+1,I.length-1);u=u[I.substring(0,s)][t]}else u=u[I]}return u}catch{}};Ir.JOIN=function(l,c){return l.join(c)};Ir.NUMBERS=function(){var l=Bn.flatten(arguments);return l.filter(function(c){return typeof c=="number"})};var yn;function Kr(){return yn||(yn=1,function(l){var c=Wr(),g=Xr,u=bn,f=sr,I=mr,s=B,t=Ir,a=2.5066282746310002;l.AVEDEV=function(){var n=f.parseNumberArray(f.flatten(arguments));return n instanceof Error?n:u.sum(u(n).subtract(u.mean(n)).abs()[0])/n.length},l.AVERAGE=function(){for(var n=f.numbers(f.flatten(arguments)),r=n.length,e=0,i=0,o,v=0;v<r;v++)e+=n[v],i+=1;return o=e/i,isNaN(o)&&(o=s.num),o},l.AVERAGEA=function(){for(var n=f.flatten(arguments),r=n.length,e=0,i=0,o,v=0;v<r;v++){var E=n[v];typeof E=="number"&&(e+=E),E===!0&&e++,E!==null&&i++}return o=e/i,isNaN(o)&&(o=s.num),o},l.AVERAGEIF=function(n,r,e){if(arguments.length<=1)return s.na;if(e=e||n,n=f.flatten(n),e=f.parseNumberArray(f.flatten(e)),e instanceof Error)return e;for(var i=0,o=0,v=r===void 0||r==="*",E=v?null:I.parse(r+""),h=0;h<n.length;h++){var m=n[h];if(v)o+=e[h],i++;else{var A=[I.createToken(m,I.TOKEN_TYPE_LITERAL)].concat(E);I.compute(A)&&(o+=e[h],i++)}}return o/i},l.AVERAGEIFS=function(){for(var n=f.argsToArray(arguments),r=(n.length-1)/2,e=f.flatten(n[0]),i=0,o=0,v=0;v<e.length;v++){for(var E=!1,h=0;h<r;h++){var m=n[2*h+1][v],A=n[2*h+2],N=A===void 0||A==="*",T=!1;if(N)T=!0;else{var R=I.parse(A+""),O=[I.createToken(m,I.TOKEN_TYPE_LITERAL)].concat(R);T=I.compute(O)}if(!T){E=!1;break}E=!0}E&&(o+=e[v],i++)}var y=o/i;return isNaN(y)?0:y},l.BETA={},l.BETA.DIST=function(n,r,e,i,o,v){return arguments.length<4||(o=o===void 0?0:o,v=v===void 0?1:v,n=f.parseNumber(n),r=f.parseNumber(r),e=f.parseNumber(e),o=f.parseNumber(o),v=f.parseNumber(v),f.anyIsError(n,r,e,o,v))?s.value:(n=(n-o)/(v-o),i?u.beta.cdf(n,r,e):u.beta.pdf(n,r,e))},l.BETA.INV=function(n,r,e,i,o){return i=i===void 0?0:i,o=o===void 0?1:o,n=f.parseNumber(n),r=f.parseNumber(r),e=f.parseNumber(e),i=f.parseNumber(i),o=f.parseNumber(o),f.anyIsError(n,r,e,i,o)?s.value:u.beta.inv(n,r,e)*(o-i)+i},l.BINOM={},l.BINOM.DIST=function(n,r,e,i){return n=f.parseNumber(n),r=f.parseNumber(r),e=f.parseNumber(e),i=f.parseNumber(i),f.anyIsError(n,r,e,i)?s.value:i?u.binomial.cdf(n,r,e):u.binomial.pdf(n,r,e)},l.BINOM.DIST.RANGE=function(n,r,e,i){if(i=i===void 0?e:i,n=f.parseNumber(n),r=f.parseNumber(r),e=f.parseNumber(e),i=f.parseNumber(i),f.anyIsError(n,r,e,i))return s.value;for(var o=0,v=e;v<=i;v++)o+=c.COMBIN(n,v)*Math.pow(r,v)*Math.pow(1-r,n-v);return o},l.BINOM.INV=function(n,r,e){if(n=f.parseNumber(n),r=f.parseNumber(r),e=f.parseNumber(e),f.anyIsError(n,r,e))return s.value;for(var i=0;i<=n;){if(u.binomial.cdf(i,n,r)>=e)return i;i++}},l.CHISQ={},l.CHISQ.DIST=function(n,r,e){return n=f.parseNumber(n),r=f.parseNumber(r),f.anyIsError(n,r)?s.value:e?u.chisquare.cdf(n,r):u.chisquare.pdf(n,r)},l.CHISQ.DIST.RT=function(n,r){return!n|!r?s.na:n<1||r>Math.pow(10,10)?s.num:typeof n!="number"||typeof r!="number"?s.value:1-u.chisquare.cdf(n,r)},l.CHISQ.INV=function(n,r){return n=f.parseNumber(n),r=f.parseNumber(r),f.anyIsError(n,r)?s.value:u.chisquare.inv(n,r)},l.CHISQ.INV.RT=function(n,r){return!n|!r?s.na:n<0||n>1||r<1||r>Math.pow(10,10)?s.num:typeof n!="number"||typeof r!="number"?s.value:u.chisquare.inv(1-n,r)},l.CHISQ.TEST=function(n,r){if(arguments.length!==2)return s.na;if(!(n instanceof Array)||!(r instanceof Array)||n.length!==r.length||n[0]&&r[0]&&n[0].length!==r[0].length)return s.value;var e=n.length,i,o,v;for(o=0;o<e;o++)n[o]instanceof Array||(i=n[o],n[o]=[],n[o].push(i)),r[o]instanceof Array||(i=r[o],r[o]=[],r[o].push(i));var E=n[0].length,h=E===1?e-1:(e-1)*(E-1),m=0,A=Math.PI;for(o=0;o<e;o++)for(v=0;v<E;v++)m+=Math.pow(n[o][v]-r[o][v],2)/r[o][v];function N(T,R){var O=Math.exp(-.5*T);R%2===1&&(O=O*Math.sqrt(2*T/A));for(var y=R;y>=2;)O=O*T/y,y=y-2;for(var p=O,C=R;p>1e-10*O;)C=C+2,p=p*T/C,O=O+p;return 1-O}return Math.round(N(m,h)*1e6)/1e6},l.COLUMN=function(n,r){if(arguments.length!==2)return s.na;if(r<0)return s.num;if(!(n instanceof Array)||typeof r!="number")return s.value;if(n.length!==0)return u.col(n,r)},l.COLUMNS=function(n){return arguments.length!==1?s.na:n instanceof Array?n.length===0?0:u.cols(n):s.value},l.CONFIDENCE={},l.CONFIDENCE.NORM=function(n,r,e){return n=f.parseNumber(n),r=f.parseNumber(r),e=f.parseNumber(e),f.anyIsError(n,r,e)?s.value:u.normalci(1,n,r,e)[1]-1},l.CONFIDENCE.T=function(n,r,e){return n=f.parseNumber(n),r=f.parseNumber(r),e=f.parseNumber(e),f.anyIsError(n,r,e)?s.value:u.tci(1,n,r,e)[1]-1},l.CORREL=function(n,r){return n=f.parseNumberArray(f.flatten(n)),r=f.parseNumberArray(f.flatten(r)),f.anyIsError(n,r)?s.value:u.corrcoeff(n,r)},l.COUNT=function(){return f.numbers(f.flatten(arguments)).length},l.COUNTA=function(){var n=f.flatten(arguments);return n.length-l.COUNTBLANK(n)},l.COUNTIN=function(n,r){var e=0;n=f.flatten(n);for(var i=0;i<n.length;i++)n[i]===r&&e++;return e},l.COUNTBLANK=function(){for(var n=f.flatten(arguments),r=0,e,i=0;i<n.length;i++)e=n[i],(e===null||e==="")&&r++;return r},l.COUNTIF=function(n,r){n=f.flatten(n);var e=r===void 0||r==="*";if(e)return n.length;for(var i=0,o=I.parse(r+""),v=0;v<n.length;v++){var E=n[v],h=[I.createToken(E,I.TOKEN_TYPE_LITERAL)].concat(o);I.compute(h)&&i++}return i},l.COUNTIFS=function(){for(var n=f.argsToArray(arguments),r=new Array(f.flatten(n[0]).length),e=0;e<r.length;e++)r[e]=!0;for(e=0;e<n.length;e+=2){var i=f.flatten(n[e]),o=n[e+1],v=o===void 0||o==="*";if(!v)for(var E=I.parse(o+""),h=0;h<i.length;h++){var m=i[h],A=[I.createToken(m,I.TOKEN_TYPE_LITERAL)].concat(E);r[h]=r[h]&&I.compute(A)}}var N=0;for(e=0;e<r.length;e++)r[e]&&N++;return N},l.COUNTUNIQUE=function(){return t.UNIQUE.apply(null,f.flatten(arguments)).length},l.COVARIANCE={},l.COVARIANCE.P=function(n,r){if(n=f.parseNumberArray(f.flatten(n)),r=f.parseNumberArray(f.flatten(r)),f.anyIsError(n,r))return s.value;for(var e=u.mean(n),i=u.mean(r),o=0,v=n.length,E=0;E<v;E++)o+=(n[E]-e)*(r[E]-i);return o/v},l.COVARIANCE.S=function(n,r){return n=f.parseNumberArray(f.flatten(n)),r=f.parseNumberArray(f.flatten(r)),f.anyIsError(n,r)?s.value:u.covariance(n,r)},l.DEVSQ=function(){var n=f.parseNumberArray(f.flatten(arguments));if(n instanceof Error)return n;for(var r=u.mean(n),e=0,i=0;i<n.length;i++)e+=Math.pow(n[i]-r,2);return e},l.EXPON={},l.EXPON.DIST=function(n,r,e){return n=f.parseNumber(n),r=f.parseNumber(r),f.anyIsError(n,r)?s.value:e?u.exponential.cdf(n,r):u.exponential.pdf(n,r)},l.F={},l.F.DIST=function(n,r,e,i){return n=f.parseNumber(n),r=f.parseNumber(r),e=f.parseNumber(e),f.anyIsError(n,r,e)?s.value:i?u.centralF.cdf(n,r,e):u.centralF.pdf(n,r,e)},l.F.DIST.RT=function(n,r,e){return arguments.length!==3?s.na:n<0||r<1||e<1?s.num:typeof n!="number"||typeof r!="number"||typeof e!="number"?s.value:1-u.centralF.cdf(n,r,e)},l.F.INV=function(n,r,e){return n=f.parseNumber(n),r=f.parseNumber(r),e=f.parseNumber(e),f.anyIsError(n,r,e)?s.value:n<=0||n>1?s.num:u.centralF.inv(n,r,e)},l.F.INV.RT=function(n,r,e){return arguments.length!==3?s.na:n<0||n>1||r<1||r>Math.pow(10,10)||e<1||e>Math.pow(10,10)?s.num:typeof n!="number"||typeof r!="number"||typeof e!="number"?s.value:u.centralF.inv(1-n,r,e)},l.F.TEST=function(n,r){if(!n||!r||!(n instanceof Array)||!(r instanceof Array))return s.na;if(n.length<2||r.length<2)return s.div0;var e=function(h,m){for(var A=0,N=0;N<h.length;N++)A+=Math.pow(h[N]-m,2);return A},i=c.SUM(n)/n.length,o=c.SUM(r)/r.length,v=e(n,i)/(n.length-1),E=e(r,o)/(r.length-1);return v/E},l.FISHER=function(n){return n=f.parseNumber(n),n instanceof Error?n:Math.log((1+n)/(1-n))/2},l.FISHERINV=function(n){if(n=f.parseNumber(n),n instanceof Error)return n;var r=Math.exp(2*n);return(r-1)/(r+1)},l.FORECAST=function(n,r,e){if(n=f.parseNumber(n),r=f.parseNumberArray(f.flatten(r)),e=f.parseNumberArray(f.flatten(e)),f.anyIsError(n,r,e))return s.value;for(var i=u.mean(e),o=u.mean(r),v=e.length,E=0,h=0,m=0;m<v;m++)E+=(e[m]-i)*(r[m]-o),h+=Math.pow(e[m]-i,2);var A=E/h,N=o-A*i;return N+A*n},l.FREQUENCY=function(n,r){if(n=f.parseNumberArray(f.flatten(n)),r=f.parseNumberArray(f.flatten(r)),f.anyIsError(n,r))return s.value;for(var e=n.length,i=r.length,o=[],v=0;v<=i;v++){o[v]=0;for(var E=0;E<e;E++)v===0?n[E]<=r[0]&&(o[0]+=1):v<i?n[E]>r[v-1]&&n[E]<=r[v]&&(o[v]+=1):v===i&&n[E]>r[i-1]&&(o[i]+=1)}return o},l.GAMMA=function(n){return n=f.parseNumber(n),n instanceof Error?n:n===0||parseInt(n,10)===n&&n<0?s.num:u.gammafn(n)},l.GAMMA.DIST=function(n,r,e,i){return arguments.length!==4?s.na:n<0||r<=0||e<=0||typeof n!="number"||typeof r!="number"||typeof e!="number"?s.value:i?u.gamma.cdf(n,r,e,!0):u.gamma.pdf(n,r,e,!1)},l.GAMMA.INV=function(n,r,e){return arguments.length!==3?s.na:n<0||n>1||r<=0||e<=0?s.num:typeof n!="number"||typeof r!="number"||typeof e!="number"?s.value:u.gamma.inv(n,r,e)},l.GAMMALN=function(n){return n=f.parseNumber(n),n instanceof Error?n:u.gammaln(n)},l.GAMMALN.PRECISE=function(n){return arguments.length!==1?s.na:n<=0?s.num:typeof n!="number"?s.value:u.gammaln(n)},l.GAUSS=function(n){return n=f.parseNumber(n),n instanceof Error?n:u.normal.cdf(n,0,1)-.5},l.GEOMEAN=function(){var n=f.parseNumberArray(f.flatten(arguments));return n instanceof Error?n:u.geomean(n)},l.GROWTH=function(n,r,e,i){if(n=f.parseNumberArray(n),n instanceof Error)return n;var o;if(r===void 0)for(r=[],o=1;o<=n.length;o++)r.push(o);if(e===void 0)for(e=[],o=1;o<=n.length;o++)e.push(o);if(r=f.parseNumberArray(r),e=f.parseNumberArray(e),f.anyIsError(r,e))return s.value;i===void 0&&(i=!0);var v=n.length,E=0,h=0,m=0,A=0;for(o=0;o<v;o++){var N=r[o],T=Math.log(n[o]);E+=N,h+=T,m+=N*T,A+=N*N}E/=v,h/=v,m/=v,A/=v;var R,O;i?(R=(m-E*h)/(A-E*E),O=h-R*E):(R=m/A,O=0);var y=[];for(o=0;o<e.length;o++)y.push(Math.exp(O+R*e[o]));return y},l.HARMEAN=function(){var n=f.parseNumberArray(f.flatten(arguments));if(n instanceof Error)return n;for(var r=n.length,e=0,i=0;i<r;i++)e+=1/n[i];return r/e},l.HYPGEOM={},l.HYPGEOM.DIST=function(n,r,e,i,o){if(n=f.parseNumber(n),r=f.parseNumber(r),e=f.parseNumber(e),i=f.parseNumber(i),f.anyIsError(n,r,e,i))return s.value;function v(h,m,A,N){return c.COMBIN(A,h)*c.COMBIN(N-A,m-h)/c.COMBIN(N,m)}function E(h,m,A,N){for(var T=0,R=0;R<=h;R++)T+=v(R,m,A,N);return T}return o?E(n,r,e,i):v(n,r,e,i)},l.INTERCEPT=function(n,r){return n=f.parseNumberArray(n),r=f.parseNumberArray(r),f.anyIsError(n,r)?s.value:n.length!==r.length?s.na:l.FORECAST(0,n,r)},l.KURT=function(){var n=f.parseNumberArray(f.flatten(arguments));if(n instanceof Error)return n;for(var r=u.mean(n),e=n.length,i=0,o=0;o<e;o++)i+=Math.pow(n[o]-r,4);return i=i/Math.pow(u.stdev(n,!0),4),e*(e+1)/((e-1)*(e-2)*(e-3))*i-3*(e-1)*(e-1)/((e-2)*(e-3))},l.LARGE=function(n,r){return n=f.parseNumberArray(f.flatten(n)),r=f.parseNumber(r),f.anyIsError(n,r)?n:n.sort(function(e,i){return i-e})[r-1]},l.LINEST=function(n,r){if(n=f.parseNumberArray(f.flatten(n)),r=f.parseNumberArray(f.flatten(r)),f.anyIsError(n,r))return s.value;for(var e=u.mean(n),i=u.mean(r),o=r.length,v=0,E=0,h=0;h<o;h++)v+=(r[h]-i)*(n[h]-e),E+=Math.pow(r[h]-i,2);var m=v/E,A=e-m*i;return[m,A]},l.LOGEST=function(n,r){if(n=f.parseNumberArray(f.flatten(n)),r=f.parseNumberArray(f.flatten(r)),f.anyIsError(n,r))return s.value;for(var e=0;e<n.length;e++)n[e]=Math.log(n[e]);var i=l.LINEST(n,r);return i[0]=Math.round(Math.exp(i[0])*1e6)/1e6,i[1]=Math.round(Math.exp(i[1])*1e6)/1e6,i},l.LOGNORM={},l.LOGNORM.DIST=function(n,r,e,i){return n=f.parseNumber(n),r=f.parseNumber(r),e=f.parseNumber(e),f.anyIsError(n,r,e)?s.value:i?u.lognormal.cdf(n,r,e):u.lognormal.pdf(n,r,e)},l.LOGNORM.INV=function(n,r,e){return n=f.parseNumber(n),r=f.parseNumber(r),e=f.parseNumber(e),f.anyIsError(n,r,e)?s.value:u.lognormal.inv(n,r,e)},l.MAX=function(){var n=f.numbers(f.flatten(arguments));return n.length===0?0:Math.max.apply(Math,n)},l.MAXA=function(){var n=f.arrayValuesToNumbers(f.flatten(arguments));return n.length===0?0:Math.max.apply(Math,n)},l.MEDIAN=function(){var n=f.arrayValuesToNumbers(f.flatten(arguments)),r=u.median(n);return isNaN(r)&&(r=s.num),r},l.MIN=function(){var n=f.numbers(f.flatten(arguments));return n.length===0?0:Math.min.apply(Math,n)},l.MINA=function(){var n=f.arrayValuesToNumbers(f.flatten(arguments));return n.length===0?0:Math.min.apply(Math,n)},l.MODE={},l.MODE.MULT=function(){var n=f.parseNumberArray(f.flatten(arguments));if(n instanceof Error)return n;for(var r=n.length,e={},i=[],o=0,v,E=0;E<r;E++)v=n[E],e[v]=e[v]?e[v]+1:1,e[v]>o&&(o=e[v],i=[]),e[v]===o&&(i[i.length]=v);return i},l.MODE.SNGL=function(){var n=f.parseNumberArray(f.flatten(arguments));return n instanceof Error?n:l.MODE.MULT(n).sort(function(r,e){return r-e})[0]},l.NEGBINOM={},l.NEGBINOM.DIST=function(n,r,e,i){return n=f.parseNumber(n),r=f.parseNumber(r),e=f.parseNumber(e),f.anyIsError(n,r,e)?s.value:i?u.negbin.cdf(n,r,e):u.negbin.pdf(n,r,e)},l.NORM={},l.NORM.DIST=function(n,r,e,i){return n=f.parseNumber(n),r=f.parseNumber(r),e=f.parseNumber(e),f.anyIsError(n,r,e)?s.value:e<=0?s.num:i?u.normal.cdf(n,r,e):u.normal.pdf(n,r,e)},l.NORM.INV=function(n,r,e){return n=f.parseNumber(n),r=f.parseNumber(r),e=f.parseNumber(e),f.anyIsError(n,r,e)?s.value:u.normal.inv(n,r,e)},l.NORM.S={},l.NORM.S.DIST=function(n,r){return n=f.parseNumber(n),n instanceof Error?s.value:r?u.normal.cdf(n,0,1):u.normal.pdf(n,0,1)},l.NORM.S.INV=function(n){return n=f.parseNumber(n),n instanceof Error?s.value:u.normal.inv(n,0,1)},l.PEARSON=function(n,r){if(r=f.parseNumberArray(f.flatten(r)),n=f.parseNumberArray(f.flatten(n)),f.anyIsError(r,n))return s.value;for(var e=u.mean(n),i=u.mean(r),o=n.length,v=0,E=0,h=0,m=0;m<o;m++)v+=(n[m]-e)*(r[m]-i),E+=Math.pow(n[m]-e,2),h+=Math.pow(r[m]-i,2);return v/Math.sqrt(E*h)},l.PERCENTILE={},l.PERCENTILE.EXC=function(n,r){if(n=f.parseNumberArray(f.flatten(n)),r=f.parseNumber(r),f.anyIsError(n,r))return s.value;n=n.sort(function(v,E){return v-E});var e=n.length;if(r<1/(e+1)||r>1-1/(e+1))return s.num;var i=r*(e+1)-1,o=Math.floor(i);return f.cleanFloat(i===o?n[i]:n[o]+(i-o)*(n[o+1]-n[o]))},l.PERCENTILE.INC=function(n,r){if(n=f.parseNumberArray(f.flatten(n)),r=f.parseNumber(r),f.anyIsError(n,r))return s.value;n=n.sort(function(v,E){return v-E});var e=n.length,i=r*(e-1),o=Math.floor(i);return f.cleanFloat(i===o?n[i]:n[o]+(i-o)*(n[o+1]-n[o]))},l.PERCENTRANK={},l.PERCENTRANK.EXC=function(n,r,e){if(e=e===void 0?3:e,n=f.parseNumberArray(f.flatten(n)),r=f.parseNumber(r),e=f.parseNumber(e),f.anyIsError(n,r,e))return s.value;n=n.sort(function(N,T){return N-T});for(var i=t.UNIQUE.apply(null,n),o=n.length,v=i.length,E=Math.pow(10,e),h=0,m=!1,A=0;!m&&A<v;)r===i[A]?(h=(n.indexOf(i[A])+1)/(o+1),m=!0):r>=i[A]&&(r<i[A+1]||A===v-1)&&(h=(n.indexOf(i[A])+1+(r-i[A])/(i[A+1]-i[A]))/(o+1),m=!0),A++;return Math.floor(h*E)/E},l.PERCENTRANK.INC=function(n,r,e){if(e=e===void 0?3:e,n=f.parseNumberArray(f.flatten(n)),r=f.parseNumber(r),e=f.parseNumber(e),f.anyIsError(n,r,e))return s.value;n=n.sort(function(N,T){return N-T});for(var i=t.UNIQUE.apply(null,n),o=n.length,v=i.length,E=Math.pow(10,e),h=0,m=!1,A=0;!m&&A<v;)r===i[A]?(h=n.indexOf(i[A])/(o-1),m=!0):r>=i[A]&&(r<i[A+1]||A===v-1)&&(h=(n.indexOf(i[A])+(r-i[A])/(i[A+1]-i[A]))/(o-1),m=!0),A++;return Math.floor(h*E)/E},l.PERMUT=function(n,r){return n=f.parseNumber(n),r=f.parseNumber(r),f.anyIsError(n,r)?s.value:c.FACT(n)/c.FACT(n-r)},l.PERMUTATIONA=function(n,r){return n=f.parseNumber(n),r=f.parseNumber(r),f.anyIsError(n,r)?s.value:Math.pow(n,r)},l.PHI=function(n){return n=f.parseNumber(n),n instanceof Error?s.value:Math.exp(-.5*n*n)/a},l.POISSON={},l.POISSON.DIST=function(n,r,e){return n=f.parseNumber(n),r=f.parseNumber(r),f.anyIsError(n,r)?s.value:e?u.poisson.cdf(n,r):u.poisson.pdf(n,r)},l.PROB=function(n,r,e,i){if(e===void 0)return 0;if(i=i===void 0?e:i,n=f.parseNumberArray(f.flatten(n)),r=f.parseNumberArray(f.flatten(r)),e=f.parseNumber(e),i=f.parseNumber(i),f.anyIsError(n,r,e,i))return s.value;if(e===i)return n.indexOf(e)>=0?r[n.indexOf(e)]:0;for(var o=n.sort(function(m,A){return m-A}),v=o.length,E=0,h=0;h<v;h++)o[h]>=e&&o[h]<=i&&(E+=r[n.indexOf(o[h])]);return E},l.QUARTILE={},l.QUARTILE.EXC=function(n,r){if(n=f.parseNumberArray(f.flatten(n)),r=f.parseNumber(r),f.anyIsError(n,r))return s.value;switch(r){case 1:return l.PERCENTILE.EXC(n,.25);case 2:return l.PERCENTILE.EXC(n,.5);case 3:return l.PERCENTILE.EXC(n,.75);default:return s.num}},l.QUARTILE.INC=function(n,r){if(n=f.parseNumberArray(f.flatten(n)),r=f.parseNumber(r),f.anyIsError(n,r))return s.value;switch(r){case 1:return l.PERCENTILE.INC(n,.25);case 2:return l.PERCENTILE.INC(n,.5);case 3:return l.PERCENTILE.INC(n,.75);default:return s.num}},l.RANK={},l.RANK.AVG=function(n,r,e){if(n=f.parseNumber(n),r=f.parseNumberArray(f.flatten(r)),f.anyIsError(n,r))return s.value;r=f.flatten(r),e=e||!1;var i=e?function(h,m){return h-m}:function(h,m){return m-h};r=r.sort(i);for(var o=r.length,v=0,E=0;E<o;E++)r[E]===n&&v++;return v>1?(2*r.indexOf(n)+v+1)/2:r.indexOf(n)+1},l.RANK.EQ=function(n,r,e){if(n=f.parseNumber(n),r=f.parseNumberArray(f.flatten(r)),f.anyIsError(n,r))return s.value;e=e||!1;var i=e?function(o,v){return o-v}:function(o,v){return v-o};return r=r.sort(i),r.indexOf(n)+1},l.ROW=function(n,r){if(arguments.length!==2)return s.na;if(r<0)return s.num;if(!(n instanceof Array)||typeof r!="number")return s.value;if(n.length!==0)return u.row(n,r)},l.ROWS=function(n){return arguments.length!==1?s.na:n instanceof Array?n.length===0?0:u.rows(n):s.value},l.RSQ=function(n,r){return n=f.parseNumberArray(f.flatten(n)),r=f.parseNumberArray(f.flatten(r)),f.anyIsError(n,r)?s.value:Math.pow(l.PEARSON(n,r),2)},l.SKEW=function(){var n=f.parseNumberArray(f.flatten(arguments));if(n instanceof Error)return n;for(var r=u.mean(n),e=n.length,i=0,o=0;o<e;o++)i+=Math.pow(n[o]-r,3);return e*i/((e-1)*(e-2)*Math.pow(u.stdev(n,!0),3))},l.SKEW.P=function(){var n=f.parseNumberArray(f.flatten(arguments));if(n instanceof Error)return n;for(var r=u.mean(n),e=n.length,i=0,o=0,v=0;v<e;v++)o+=Math.pow(n[v]-r,3),i+=Math.pow(n[v]-r,2);return o=o/e,i=i/e,o/Math.pow(i,3/2)},l.SLOPE=function(n,r){if(n=f.parseNumberArray(f.flatten(n)),r=f.parseNumberArray(f.flatten(r)),f.anyIsError(n,r))return s.value;for(var e=u.mean(r),i=u.mean(n),o=r.length,v=0,E=0,h=0;h<o;h++)v+=(r[h]-e)*(n[h]-i),E+=Math.pow(r[h]-e,2);return v/E},l.SMALL=function(n,r){return n=f.parseNumberArray(f.flatten(n)),r=f.parseNumber(r),f.anyIsError(n,r)?n:n.sort(function(e,i){return e-i})[r-1]},l.STANDARDIZE=function(n,r,e){return n=f.parseNumber(n),r=f.parseNumber(r),e=f.parseNumber(e),f.anyIsError(n,r,e)?s.value:(n-r)/e},l.STDEV={},l.STDEV.P=function(){var n=l.VAR.P.apply(this,arguments),r=Math.sqrt(n);return isNaN(r)&&(r=s.num),r},l.STDEV.S=function(){var n=l.VAR.S.apply(this,arguments),r=Math.sqrt(n);return r},l.STDEVA=function(){var n=l.VARA.apply(this,arguments),r=Math.sqrt(n);return r},l.STDEVPA=function(){var n=l.VARPA.apply(this,arguments),r=Math.sqrt(n);return isNaN(r)&&(r=s.num),r},l.STEYX=function(n,r){if(n=f.parseNumberArray(f.flatten(n)),r=f.parseNumberArray(f.flatten(r)),f.anyIsError(n,r))return s.value;for(var e=u.mean(r),i=u.mean(n),o=r.length,v=0,E=0,h=0,m=0;m<o;m++)v+=Math.pow(n[m]-i,2),E+=(r[m]-e)*(n[m]-i),h+=Math.pow(r[m]-e,2);return Math.sqrt((v-E*E/h)/(o-2))},l.TRANSPOSE=function(n){return n?u.transpose(n):s.na},l.T=g.T,l.T.DIST=function(n,r,e){return n=f.parseNumber(n),r=f.parseNumber(r),f.anyIsError(n,r)?s.value:e?u.studentt.cdf(n,r):u.studentt.pdf(n,r)},l.T.DIST["2T"]=function(n,r){return arguments.length!==2?s.na:n<0||r<1?s.num:typeof n!="number"||typeof r!="number"?s.value:(1-u.studentt.cdf(n,r))*2},l.T.DIST.RT=function(n,r){return arguments.length!==2?s.na:n<0||r<1?s.num:typeof n!="number"||typeof r!="number"?s.value:1-u.studentt.cdf(n,r)},l.T.INV=function(n,r){return n=f.parseNumber(n),r=f.parseNumber(r),f.anyIsError(n,r)?s.value:u.studentt.inv(n,r)},l.T.INV["2T"]=function(n,r){return n=f.parseNumber(n),r=f.parseNumber(r),n<=0||n>1||r<1?s.num:f.anyIsError(n,r)?s.value:Math.abs(u.studentt.inv(n/2,r))},l.T.TEST=function(n,r){if(n=f.parseNumberArray(f.flatten(n)),r=f.parseNumberArray(f.flatten(r)),f.anyIsError(n,r))return s.value;var e=u.mean(n),i=u.mean(r),o=0,v=0,E;for(E=0;E<n.length;E++)o+=Math.pow(n[E]-e,2);for(E=0;E<r.length;E++)v+=Math.pow(r[E]-i,2);o=o/(n.length-1),v=v/(r.length-1);var h=Math.abs(e-i)/Math.sqrt(o/n.length+v/r.length);return l.T.DIST["2T"](h,n.length+r.length-2)},l.TREND=function(n,r,e){if(n=f.parseNumberArray(f.flatten(n)),r=f.parseNumberArray(f.flatten(r)),e=f.parseNumberArray(f.flatten(e)),f.anyIsError(n,r,e))return s.value;var i=l.LINEST(n,r),o=i[0],v=i[1],E=[];return e.forEach(function(h){E.push(o*h+v)}),E},l.TRIMMEAN=function(n,r){if(n=f.parseNumberArray(f.flatten(n)),r=f.parseNumber(r),f.anyIsError(n,r))return s.value;var e=c.FLOOR(n.length*r,2)/2;return u.mean(f.initial(f.rest(n.sort(function(i,o){return i-o}),e),e))},l.VAR={},l.VAR.P=function(){for(var n=f.numbers(f.flatten(arguments)),r=n.length,e=0,i=l.AVERAGE(n),o,v=0;v<r;v++)e+=Math.pow(n[v]-i,2);return o=e/r,isNaN(o)&&(o=s.num),o},l.VAR.S=function(){for(var n=f.numbers(f.flatten(arguments)),r=n.length,e=0,i=l.AVERAGE(n),o=0;o<r;o++)e+=Math.pow(n[o]-i,2);return e/(r-1)},l.VARA=function(){for(var n=f.flatten(arguments),r=n.length,e=0,i=0,o=l.AVERAGEA(n),v=0;v<r;v++){var E=n[v];typeof E=="number"?e+=Math.pow(E-o,2):E===!0?e+=Math.pow(1-o,2):e+=Math.pow(0-o,2),E!==null&&i++}return e/(i-1)},l.VARPA=function(){for(var n=f.flatten(arguments),r=n.length,e=0,i=0,o=l.AVERAGEA(n),v,E=0;E<r;E++){var h=n[E];typeof h=="number"?e+=Math.pow(h-o,2):h===!0?e+=Math.pow(1-o,2):e+=Math.pow(0-o,2),h!==null&&i++}return v=e/i,isNaN(v)&&(v=s.num),v},l.WEIBULL={},l.WEIBULL.DIST=function(n,r,e,i){return n=f.parseNumber(n),r=f.parseNumber(r),e=f.parseNumber(e),f.anyIsError(n,r,e)?s.value:i?1-Math.exp(-Math.pow(n/e,r)):Math.pow(n,r-1)*Math.exp(-Math.pow(n/e,r))*r/Math.pow(e,r)},l.Z={},l.Z.TEST=function(n,r,e){if(n=f.parseNumberArray(f.flatten(n)),r=f.parseNumber(r),f.anyIsError(n,r))return s.value;e=e||l.STDEV.S(n);var i=n.length;return 1-l.NORM.S.DIST((l.AVERAGE(n)-r)/(e/Math.sqrt(i)),!0)}}(_r)),_r}var Qr={};(function(l){var c=B;l.CELL=function(){throw new Error("CELL is not implemented")},l.ERROR={},l.ERROR.TYPE=function(g){switch(g){case c.nil:return 1;case c.div0:return 2;case c.value:return 3;case c.ref:return 4;case c.name:return 5;case c.num:return 6;case c.na:return 7;case c.data:return 8}return c.na},l.INFO=function(){throw new Error("INFO is not implemented")},l.ISBLANK=function(g){return g===null},l.ISBINARY=function(g){return/^[01]{1,10}$/.test(g)},l.ISERR=function(g){return[c.value,c.ref,c.div0,c.num,c.name,c.nil].indexOf(g)>=0||typeof g=="number"&&(isNaN(g)||!isFinite(g))},l.ISERROR=function(g){return l.ISERR(g)||g===c.na},l.ISEVEN=function(g){return!(Math.floor(Math.abs(g))&1)},l.ISFORMULA=function(){throw new Error("ISFORMULA is not implemented")},l.ISLOGICAL=function(g){return g===!0||g===!1},l.ISNA=function(g){return g===c.na},l.ISNONTEXT=function(g){return typeof g!="string"},l.ISNUMBER=function(g){return typeof g=="number"&&!isNaN(g)&&isFinite(g)},l.ISODD=function(g){return!!(Math.floor(Math.abs(g))&1)},l.ISREF=function(){throw new Error("ISREF is not implemented")},l.ISTEXT=function(g){return typeof g=="string"},l.N=function(g){return this.ISNUMBER(g)?g:g instanceof Date?g.getTime():g===!0?1:g===!1?0:this.ISERROR(g)?g:0},l.NA=function(){return c.na},l.SHEET=function(){throw new Error("SHEET is not implemented")},l.SHEETS=function(){throw new Error("SHEETS is not implemented")},l.TYPE=function(g){if(this.ISNUMBER(g))return 1;if(this.ISTEXT(g))return 2;if(this.ISLOGICAL(g))return 4;if(this.ISERROR(g))return 16;if(Array.isArray(g))return 64}})(Qr);var pn;function Wr(){return pn||(pn=1,function(l){var c=sr,g=B,u=Kr(),f=Qr,I=mr;l.ABS=function(t){if(t=c.parseNumber(t),t instanceof Error)return t;var a=Math.abs(t);return a},l.ACOS=function(t){if(t=c.parseNumber(t),t instanceof Error)return t;var a=Math.acos(t);return isNaN(a)&&(a=g.num),a},l.ACOSH=function(t){if(t=c.parseNumber(t),t instanceof Error)return t;var a=Math.log(t+Math.sqrt(t*t-1));return isNaN(a)&&(a=g.num),a},l.ACOT=function(t){if(t=c.parseNumber(t),t instanceof Error)return t;var a=Math.atan(1/t);return a},l.ACOTH=function(t){if(t=c.parseNumber(t),t instanceof Error)return t;var a=.5*Math.log((t+1)/(t-1));return isNaN(a)&&(a=g.num),a},l.AGGREGATE=function(t,a,n,r){if(t=c.parseNumber(t),a=c.parseNumber(t),c.anyIsError(t,a))return g.value;switch(t){case 1:return u.AVERAGE(n);case 2:return u.COUNT(n);case 3:return u.COUNTA(n);case 4:return u.MAX(n);case 5:return u.MIN(n);case 6:return l.PRODUCT(n);case 7:return u.STDEV.S(n);case 8:return u.STDEV.P(n);case 9:return l.SUM(n);case 10:return u.VAR.S(n);case 11:return u.VAR.P(n);case 12:return u.MEDIAN(n);case 13:return u.MODE.SNGL(n);case 14:return u.LARGE(n,r);case 15:return u.SMALL(n,r);case 16:return u.PERCENTILE.INC(n,r);case 17:return u.QUARTILE.INC(n,r);case 18:return u.PERCENTILE.EXC(n,r);case 19:return u.QUARTILE.EXC(n,r)}},l.ARABIC=function(t){if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(t))return g.value;var a=0;return t.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,function(n){a+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[n]}),a},l.ASIN=function(t){if(t=c.parseNumber(t),t instanceof Error)return t;var a=Math.asin(t);return isNaN(a)&&(a=g.num),a},l.ASINH=function(t){return t=c.parseNumber(t),t instanceof Error?t:Math.log(t+Math.sqrt(t*t+1))},l.ATAN=function(t){return t=c.parseNumber(t),t instanceof Error?t:Math.atan(t)},l.ATAN2=function(t,a){return t=c.parseNumber(t),a=c.parseNumber(a),c.anyIsError(t,a)?g.value:Math.atan2(t,a)},l.ATANH=function(t){if(t=c.parseNumber(t),t instanceof Error)return t;var a=Math.log((1+t)/(1-t))/2;return isNaN(a)&&(a=g.num),a},l.BASE=function(t,a,n){if(n=n||0,t=c.parseNumber(t),a=c.parseNumber(a),n=c.parseNumber(n),c.anyIsError(t,a,n))return g.value;n=n===void 0?0:n;var r=t.toString(a);return new Array(Math.max(n+1-r.length,0)).join("0")+r},l.CEILING=function(t,a,n){if(a=a===void 0?1:Math.abs(a),n=n||0,t=c.parseNumber(t),a=c.parseNumber(a),n=c.parseNumber(n),c.anyIsError(t,a,n))return g.value;if(a===0)return 0;var r=-Math.floor(Math.log(a)/Math.log(10));return t>=0?l.ROUND(Math.ceil(t/a)*a,r):n===0?-l.ROUND(Math.floor(Math.abs(t)/a)*a,r):-l.ROUND(Math.ceil(Math.abs(t)/a)*a,r)},l.CEILING.MATH=l.CEILING,l.CEILING.PRECISE=l.CEILING,l.COMBIN=function(t,a){return t=c.parseNumber(t),a=c.parseNumber(a),c.anyIsError(t,a)?g.value:l.FACT(t)/(l.FACT(a)*l.FACT(t-a))},l.COMBINA=function(t,a){return t=c.parseNumber(t),a=c.parseNumber(a),c.anyIsError(t,a)?g.value:t===0&&a===0?1:l.COMBIN(t+a-1,t-1)},l.COS=function(t){return t=c.parseNumber(t),t instanceof Error?t:Math.cos(t)},l.COSH=function(t){return t=c.parseNumber(t),t instanceof Error?t:(Math.exp(t)+Math.exp(-t))/2},l.COT=function(t){return t=c.parseNumber(t),t instanceof Error?t:1/Math.tan(t)},l.COTH=function(t){if(t=c.parseNumber(t),t instanceof Error)return t;var a=Math.exp(2*t);return(a+1)/(a-1)},l.CSC=function(t){return t=c.parseNumber(t),t instanceof Error?t:1/Math.sin(t)},l.CSCH=function(t){return t=c.parseNumber(t),t instanceof Error?t:2/(Math.exp(t)-Math.exp(-t))},l.DECIMAL=function(t,a){return arguments.length<1?g.value:parseInt(t,a)},l.DEGREES=function(t){return t=c.parseNumber(t),t instanceof Error?t:t*180/Math.PI},l.EVEN=function(t){return t=c.parseNumber(t),t instanceof Error?t:l.CEILING(t,-2,-1)},l.EXP=function(t){return arguments.length<1?g.na:typeof t!="number"||arguments.length>1?g.error:(t=Math.exp(t),t)};var s=[];l.FACT=function(t){if(t=c.parseNumber(t),t instanceof Error)return t;var a=Math.floor(t);return a===0||a===1?1:(s[a]>0||(s[a]=l.FACT(a-1)*a),s[a])},l.FACTDOUBLE=function(t){if(t=c.parseNumber(t),t instanceof Error)return t;var a=Math.floor(t);return a<=0?1:a*l.FACTDOUBLE(a-2)},l.FLOOR=function(t,a){if(t=c.parseNumber(t),a=c.parseNumber(a),c.anyIsError(t,a))return g.value;if(a===0)return 0;if(!(t>0&&a>0)&&!(t<0&&a<0))return g.num;a=Math.abs(a);var n=-Math.floor(Math.log(a)/Math.log(10));return t>=0?l.ROUND(Math.floor(t/a)*a,n):-l.ROUND(Math.ceil(Math.abs(t)/a),n)},l.FLOOR.MATH=function(t,a,n){if(a=a===void 0?1:a,n=n===void 0?0:n,t=c.parseNumber(t),a=c.parseNumber(a),n=c.parseNumber(n),c.anyIsError(t,a,n))return g.value;if(a===0)return 0;a=a?Math.abs(a):1;var r=-Math.floor(Math.log(a)/Math.log(10));return t>=0?l.ROUND(Math.floor(t/a)*a,r):n===0||n===void 0?-l.ROUND(Math.ceil(Math.abs(t)/a)*a,r):-l.ROUND(Math.floor(Math.abs(t)/a)*a,r)},l.FLOOR.PRECISE=l.FLOOR.MATH,l.GCD=function(){var t=c.parseNumberArray(c.flatten(arguments));if(t instanceof Error)return t;for(var a=t.length,n=t[0],r=n<0?-n:n,e=1;e<a;e++){for(var i=t[e],o=i<0?-i:i;r&&o;)r>o?r%=o:o%=r;r+=o}return r},l.INT=function(t){return t=c.parseNumber(t),t instanceof Error?t:Math.floor(t)},l.ISO={CEILING:l.CEILING},l.LCM=function(){var t=c.parseNumberArray(c.flatten(arguments));if(t instanceof Error)return t;for(var a,n,r,e,i=1;(r=t.pop())!==void 0;)for(;r>1;){if(r%2){for(a=3,n=Math.floor(Math.sqrt(r));a<=n&&r%a;a+=2);e=a<=n?a:r}else e=2;for(r/=e,i*=e,a=t.length;a;t[--a]%e===0&&(t[a]/=e)===1&&t.splice(a,1));}return i},l.LN=function(t){return t=c.parseNumber(t),t instanceof Error?t:Math.log(t)},l.LN10=function(){return Math.log(10)},l.LN2=function(){return Math.log(2)},l.LOG10E=function(){return Math.LOG10E},l.LOG2E=function(){return Math.LOG2E},l.LOG=function(t,a){return t=c.parseNumber(t),a=c.parseNumber(a),c.anyIsError(t,a)?g.value:(a=a===void 0?10:a,Math.log(t)/Math.log(a))},l.LOG10=function(t){return t=c.parseNumber(t),t instanceof Error?t:Math.log(t)/Math.log(10)},l.MOD=function(t,a){if(t=c.parseNumber(t),a=c.parseNumber(a),c.anyIsError(t,a))return g.value;if(a===0)return g.div0;var n=Math.abs(t%a);return a>0?n:-n},l.MROUND=function(t,a){return t=c.parseNumber(t),a=c.parseNumber(a),c.anyIsError(t,a)?g.value:t*a<0?g.num:Math.round(t/a)*a},l.MULTINOMIAL=function(){var t=c.parseNumberArray(c.flatten(arguments));if(t instanceof Error)return t;for(var a=0,n=1,r=0;r<t.length;r++)a+=t[r],n*=l.FACT(t[r]);return l.FACT(a)/n},l.ODD=function(t){if(t=c.parseNumber(t),t instanceof Error)return t;var a=Math.ceil(Math.abs(t));return a=a&1?a:a+1,t>0?a:-a},l.PI=function(){return Math.PI},l.E=function(){return Math.E},l.POWER=function(t,a){if(t=c.parseNumber(t),a=c.parseNumber(a),c.anyIsError(t,a))return g.value;var n=Math.pow(t,a);return isNaN(n)?g.num:n},l.PRODUCT=function(){var t=c.parseNumberArray(c.flatten(arguments));if(t instanceof Error)return t;for(var a=1,n=0;n<t.length;n++)a*=t[n];return a},l.QUOTIENT=function(t,a){return t=c.parseNumber(t),a=c.parseNumber(a),c.anyIsError(t,a)?g.value:parseInt(t/a,10)},l.RADIANS=function(t){return t=c.parseNumber(t),t instanceof Error?t:t*Math.PI/180},l.RAND=function(){return Math.random()},l.RANDBETWEEN=function(t,a){return t=c.parseNumber(t),a=c.parseNumber(a),c.anyIsError(t,a)?g.value:t+Math.ceil((a-t+1)*Math.random())-1},l.ROMAN=function(t){if(t=c.parseNumber(t),t instanceof Error)return t;for(var a=String(t).split(""),n=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"],r="",e=3;e--;)r=(n[+a.pop()+e*10]||"")+r;return new Array(+a.join("")+1).join("M")+r},l.ROUND=function(t,a){return t=c.parseNumber(t),a=c.parseNumber(a),c.anyIsError(t,a)?g.value:Math.round(t*Math.pow(10,a))/Math.pow(10,a)},l.ROUNDDOWN=function(t,a){if(t=c.parseNumber(t),a=c.parseNumber(a),c.anyIsError(t,a))return g.value;var n=t>0?1:-1;return n*Math.floor(Math.abs(t)*Math.pow(10,a))/Math.pow(10,a)},l.ROUNDUP=function(t,a){if(t=c.parseNumber(t),a=c.parseNumber(a),c.anyIsError(t,a))return g.value;var n=t>0?1:-1;return n*Math.ceil(Math.abs(t)*Math.pow(10,a))/Math.pow(10,a)},l.SEC=function(t){return t=c.parseNumber(t),t instanceof Error?t:1/Math.cos(t)},l.SECH=function(t){return t=c.parseNumber(t),t instanceof Error?t:2/(Math.exp(t)+Math.exp(-t))},l.SERIESSUM=function(t,a,n,r){if(t=c.parseNumber(t),a=c.parseNumber(a),n=c.parseNumber(n),r=c.parseNumberArray(r),c.anyIsError(t,a,n,r))return g.value;for(var e=r[0]*Math.pow(t,a),i=1;i<r.length;i++)e+=r[i]*Math.pow(t,a+i*n);return e},l.SIGN=function(t){return t=c.parseNumber(t),t instanceof Error?t:t<0?-1:t===0?0:1},l.SIN=function(t){return t=c.parseNumber(t),t instanceof Error?t:Math.sin(t)},l.SINH=function(t){return t=c.parseNumber(t),t instanceof Error?t:(Math.exp(t)-Math.exp(-t))/2},l.SQRT=function(t){return t=c.parseNumber(t),t instanceof Error?t:t<0?g.num:Math.sqrt(t)},l.SQRTPI=function(t){return t=c.parseNumber(t),t instanceof Error?t:Math.sqrt(t*Math.PI)},l.SQRT1_2=function(){return 1/Math.sqrt(2)},l.SQRT2=function(){return Math.sqrt(2)},l.SUBTOTAL=function(t,a){if(t=c.parseNumber(t),t instanceof Error)return t;switch(t){case 1:return u.AVERAGE(a);case 2:return u.COUNT(a);case 3:return u.COUNTA(a);case 4:return u.MAX(a);case 5:return u.MIN(a);case 6:return l.PRODUCT(a);case 7:return u.STDEV.S(a);case 8:return u.STDEV.P(a);case 9:return l.SUM(a);case 10:return u.VAR.S(a);case 11:return u.VAR.P(a);case 101:return u.AVERAGE(a);case 102:return u.COUNT(a);case 103:return u.COUNTA(a);case 104:return u.MAX(a);case 105:return u.MIN(a);case 106:return l.PRODUCT(a);case 107:return u.STDEV.S(a);case 108:return u.STDEV.P(a);case 109:return l.SUM(a);case 110:return u.VAR.S(a);case 111:return u.VAR.P(a)}},l.ADD=function(t,a){return arguments.length!==2?g.na:(t=c.parseNumber(t),a=c.parseNumber(a),c.anyIsError(t,a)?g.value:t+a)},l.MINUS=function(t,a){return arguments.length!==2?g.na:(t=c.parseNumber(t),a=c.parseNumber(a),c.anyIsError(t,a)?g.value:t-a)},l.DIVIDE=function(t,a){return arguments.length!==2?g.na:(t=c.parseNumber(t),a=c.parseNumber(a),c.anyIsError(t,a)?g.value:a===0?g.div0:t/a)},l.MULTIPLY=function(t,a){return arguments.length!==2?g.na:(t=c.parseNumber(t),a=c.parseNumber(a),c.anyIsError(t,a)?g.value:t*a)},l.GTE=function(t,a){return arguments.length!==2?g.na:(t=c.parseNumber(t),a=c.parseNumber(a),c.anyIsError(t,a)?g.error:t>=a)},l.LT=function(t,a){return arguments.length!==2?g.na:(t=c.parseNumber(t),a=c.parseNumber(a),c.anyIsError(t,a)?g.error:t<a)},l.LTE=function(t,a){return arguments.length!==2?g.na:(t=c.parseNumber(t),a=c.parseNumber(a),c.anyIsError(t,a)?g.error:t<=a)},l.EQ=function(t,a){return arguments.length!==2?g.na:t===a},l.NE=function(t,a){return arguments.length!==2?g.na:t!==a},l.POW=function(t,a){return arguments.length!==2?g.na:(t=c.parseNumber(t),a=c.parseNumber(a),c.anyIsError(t,a)?g.error:l.POWER(t,a))},l.SUM=function(){var t=0;return c.arrayEach(c.argsToArray(arguments),function(a){if(typeof a=="number")t+=a;else if(typeof a=="string"){var n=parseFloat(a);!isNaN(n)&&(t+=n)}else Array.isArray(a)&&(t+=l.SUM.apply(null,a))}),t},l.SUMIF=function(t,a){if(t=c.parseNumberArray(c.flatten(t)),t instanceof Error)return t;for(var n=0,r=a===void 0||a==="*",e=r?null:I.parse(a+""),i=0;i<t.length;i++){var o=t[i];if(r)n+=o;else{var v=[I.createToken(o,I.TOKEN_TYPE_LITERAL)].concat(e);n+=I.compute(v)?o:0}}return n},l.SUMIFS=function(){var t=c.argsToArray(arguments),a=c.parseNumberArray(c.flatten(t.shift()));if(a instanceof Error)return a;for(var n=t,r=a.length,e=n.length,i=0,o=0;o<r;o++){for(var v=a[o],E=!1,h=0;h<e;h++){var m=n[h],A=m===void 0||m==="*",N=!1;if(A)N=!0;else{var T=I.parse(m+""),R=[I.createToken(v,I.TOKEN_TYPE_LITERAL)].concat(T);N=I.compute(R)}if(!N){E=!1;break}E=!0}E&&(i+=v)}return i},l.SUMPRODUCT=function(){if(!arguments||arguments.length===0)return g.value;for(var t=arguments.length+1,a=0,n,r,e,i,o=0;o<arguments[0].length;o++)if(arguments[0][o]instanceof Array)for(var v=0;v<arguments[0][o].length;v++){for(n=1,r=1;r<t;r++){if(i=c.parseNumber(arguments[r-1][o][v]),i instanceof Error)return i;n*=i}a+=n}else{for(n=1,r=1;r<t;r++){if(e=c.parseNumber(arguments[r-1][o]),e instanceof Error)return e;n*=e}a+=n}return a},l.SUMSQ=function(){var t=c.parseNumberArray(c.flatten(arguments));if(t instanceof Error)return t;for(var a=0,n=t.length,r=0;r<n;r++)a+=f.ISNUMBER(t[r])?t[r]*t[r]:0;return a},l.SUMX2MY2=function(t,a){if(t=c.parseNumberArray(c.flatten(t)),a=c.parseNumberArray(c.flatten(a)),c.anyIsError(t,a))return g.value;for(var n=0,r=0;r<t.length;r++)n+=t[r]*t[r]-a[r]*a[r];return n},l.SUMX2PY2=function(t,a){if(t=c.parseNumberArray(c.flatten(t)),a=c.parseNumberArray(c.flatten(a)),c.anyIsError(t,a))return g.value;var n=0;t=c.parseNumberArray(c.flatten(t)),a=c.parseNumberArray(c.flatten(a));for(var r=0;r<t.length;r++)n+=t[r]*t[r]+a[r]*a[r];return n},l.SUMXMY2=function(t,a){if(t=c.parseNumberArray(c.flatten(t)),a=c.parseNumberArray(c.flatten(a)),c.anyIsError(t,a))return g.value;var n=0;t=c.flatten(t),a=c.flatten(a);for(var r=0;r<t.length;r++)n+=Math.pow(t[r]-a[r],2);return n},l.TAN=function(t){return t=c.parseNumber(t),t instanceof Error?t:Math.tan(t)},l.TANH=function(t){if(t=c.parseNumber(t),t instanceof Error)return t;var a=Math.exp(2*t);return(a-1)/(a+1)},l.TRUNC=function(t,a){if(a=a===void 0?0:a,t=c.parseNumber(t),a=c.parseNumber(a),c.anyIsError(t,a))return g.value;var n=t>0?1:-1;return n*Math.floor(Math.abs(t)*Math.pow(10,a))/Math.pow(10,a)}}(Jr)),Jr}var An={},Yn={};(function(l){(function(c){c(typeof DO_NOT_EXPORT_BESSEL>"u"?l:{})})(function(c){c.version="1.0.2";var g=Math;function u(r,e){for(var i=0,o=0;i<r.length;++i)o=e*o+r[i];return o}function f(r,e,i,o,v){if(e===0)return i;if(e===1)return o;for(var E=2/r,h=o,m=1;m<e;++m)h=o*m*E+v*i,i=o,o=h;return h}function I(r,e,i,o,v){return function(h,m){if(o){if(h===0)return o==1?-1/0:1/0;if(h<0)return NaN}if(m===0)return r(h);if(m===1)return e(h);if(m<0)return NaN;m|=0;var A=r(h),N=e(h);return f(h,m,A,N,v)}}var s=function(){var r=.636619772,e=[57568490574,-13362590354,6516196407e-1,-1121442418e-2,77392.33017,-184.9052456].reverse(),i=[57568490411,1029532985,9494680718e-3,59272.64853,267.8532712,1].reverse(),o=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),v=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934935152e-16].reverse();function E(R){var O=0,y=0,p=0,C=R*R;if(R<8)y=u(e,C),p=u(i,C),O=y/p;else{var M=R-.785398164;C=64/C,y=u(o,C),p=u(v,C),O=g.sqrt(r/R)*(g.cos(M)*y-g.sin(M)*p*8/R)}return O}var h=[72362614232,-7895059235,2423968531e-1,-2972611439e-3,15704.4826,-30.16036606].reverse(),m=[144725228442,2300535178,1858330474e-2,99447.43394,376.9991397,1].reverse(),A=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),N=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function T(R){var O=0,y=0,p=0,C=R*R,M=g.abs(R)-2.356194491;return Math.abs(R)<8?(y=R*u(h,C),p=u(m,C),O=y/p):(C=64/C,y=u(A,C),p=u(N,C),O=g.sqrt(r/g.abs(R))*(g.cos(M)*y-g.sin(M)*p*8/g.abs(R)),R<0&&(O=-O)),O}return function R(O,y){if(y=Math.round(y),!isFinite(O))return isNaN(O)?O:0;if(y<0)return(y%2?-1:1)*R(O,-y);if(O<0)return(y%2?-1:1)*R(-O,y);if(y===0)return E(O);if(y===1)return T(O);if(O===0)return 0;var p=0;if(O>y)p=f(O,y,E(O),T(O),-1);else{for(var C=2*g.floor((y+g.floor(g.sqrt(40*y)))/2),M=!1,d=0,P=0,V=1,J=0,cr=2/O,_=C;_>0;_--)J=_*cr*V-d,d=V,V=J,g.abs(V)>1e10&&(V*=1e-10,d*=1e-10,p*=1e-10,P*=1e-10),M&&(P+=V),M=!M,_==y&&(p=d);P=2*P-V,p/=P}return p}}(),t=function(){var r=.636619772,e=[-2957821389,7062834065,-5123598036e-1,1087988129e-2,-86327.92757,228.4622733].reverse(),i=[40076544269,7452499648e-1,7189466438e-3,47447.2647,226.1030244,1].reverse(),o=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),v=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934945152e-16].reverse();function E(R){var O=0,y=0,p=0,C=R*R,M=R-.785398164;return R<8?(y=u(e,C),p=u(i,C),O=y/p+r*s(R,0)*g.log(R)):(C=64/C,y=u(o,C),p=u(v,C),O=g.sqrt(r/R)*(g.sin(M)*y+g.cos(M)*p*8/R)),O}var h=[-4900604943e3,127527439e4,-51534381390,7349264551e-1,-4237922726e-3,8511.937935].reverse(),m=[249958057e5,424441966400,3733650367,2245904002e-2,102042.605,354.9632885,1].reverse(),A=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),N=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function T(R){var O=0,y=0,p=0,C=R*R,M=R-2.356194491;return R<8?(y=R*u(h,C),p=u(m,C),O=y/p+r*(s(R,1)*g.log(R)-1/R)):(C=64/C,y=u(A,C),p=u(N,C),O=g.sqrt(r/R)*(g.sin(M)*y+g.cos(M)*p*8/R)),O}return I(E,T,"BESSELY",1,-1)}(),a=function(){var r=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),e=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse();function i(h){return h<=3.75?u(r,h*h/(3.75*3.75)):g.exp(g.abs(h))/g.sqrt(g.abs(h))*u(e,3.75/g.abs(h))}var o=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),v=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse();function E(h){return h<3.75?h*u(o,h*h/(3.75*3.75)):(h<0?-1:1)*g.exp(g.abs(h))/g.sqrt(g.abs(h))*u(v,3.75/g.abs(h))}return function h(m,A){if(A=Math.round(A),A===0)return i(m);if(A===1)return E(m);if(A<0)return NaN;if(g.abs(m)===0)return 0;if(m==1/0)return 1/0;var N=0,T,R=2/g.abs(m),O=0,y=1,p=0,C=2*g.round((A+g.round(g.sqrt(40*A)))/2);for(T=C;T>0;T--)p=T*R*y+O,O=y,y=p,g.abs(y)>1e10&&(y*=1e-10,O*=1e-10,N*=1e-10),T==A&&(N=O);return N*=h(m,0)/y,m<0&&A%2?-N:N}}(),n=function(){var r=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),e=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse();function i(h){return h<=2?-g.log(h/2)*a(h,0)+u(r,h*h/4):g.exp(-h)/g.sqrt(h)*u(e,2/h)}var o=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),v=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();function E(h){return h<=2?g.log(h/2)*a(h,1)+1/h*u(o,h*h/4):g.exp(-h)/g.sqrt(h)*u(v,2/h)}return I(i,E,"BESSELK",2,1)}();c.besselj=s,c.bessely=t,c.besseli=a,c.besselk=n})})(Yn);(function(l){var c=B,g=bn,u=Xr,f=sr,I=Yn;function s(t){return/^[01]{1,10}$/.test(t)}l.BESSELI=function(t,a){return t=f.parseNumber(t),a=f.parseNumber(a),f.anyIsError(t,a)?c.value:I.besseli(t,a)},l.BESSELJ=function(t,a){return t=f.parseNumber(t),a=f.parseNumber(a),f.anyIsError(t,a)?c.value:I.besselj(t,a)},l.BESSELK=function(t,a){return t=f.parseNumber(t),a=f.parseNumber(a),f.anyIsError(t,a)?c.value:I.besselk(t,a)},l.BESSELY=function(t,a){return t=f.parseNumber(t),a=f.parseNumber(a),f.anyIsError(t,a)?c.value:I.bessely(t,a)},l.BIN2DEC=function(t){if(!s(t))return c.num;var a=parseInt(t,2),n=t.toString();return n.length===10&&n.substring(0,1)==="1"?parseInt(n.substring(1),2)-512:a},l.BIN2HEX=function(t,a){if(!s(t))return c.num;var n=t.toString();if(n.length===10&&n.substring(0,1)==="1")return(0xfffffffe00+parseInt(n.substring(1),2)).toString(16);var r=parseInt(t,2).toString(16);return a===void 0?r:isNaN(a)?c.value:a<0?c.num:(a=Math.floor(a),a>=r.length?u.REPT("0",a-r.length)+r:c.num)},l.BIN2OCT=function(t,a){if(!s(t))return c.num;var n=t.toString();if(n.length===10&&n.substring(0,1)==="1")return(1073741312+parseInt(n.substring(1),2)).toString(8);var r=parseInt(t,2).toString(8);return a===void 0?r:isNaN(a)?c.value:a<0?c.num:(a=Math.floor(a),a>=r.length?u.REPT("0",a-r.length)+r:c.num)},l.BITAND=function(t,a){return t=f.parseNumber(t),a=f.parseNumber(a),f.anyIsError(t,a)?c.value:t<0||a<0||Math.floor(t)!==t||Math.floor(a)!==a||t>0xffffffffffff||a>0xffffffffffff?c.num:t&a},l.BITLSHIFT=function(t,a){return t=f.parseNumber(t),a=f.parseNumber(a),f.anyIsError(t,a)?c.value:t<0||Math.floor(t)!==t||t>0xffffffffffff||Math.abs(a)>53?c.num:a>=0?t<<a:t>>-a},l.BITOR=function(t,a){return t=f.parseNumber(t),a=f.parseNumber(a),f.anyIsError(t,a)?c.value:t<0||a<0||Math.floor(t)!==t||Math.floor(a)!==a||t>0xffffffffffff||a>0xffffffffffff?c.num:t|a},l.BITRSHIFT=function(t,a){return t=f.parseNumber(t),a=f.parseNumber(a),f.anyIsError(t,a)?c.value:t<0||Math.floor(t)!==t||t>0xffffffffffff||Math.abs(a)>53?c.num:a>=0?t>>a:t<<-a},l.BITXOR=function(t,a){return t=f.parseNumber(t),a=f.parseNumber(a),f.anyIsError(t,a)?c.value:t<0||a<0||Math.floor(t)!==t||Math.floor(a)!==a||t>0xffffffffffff||a>0xffffffffffff?c.num:t^a},l.COMPLEX=function(t,a,n){if(t=f.parseNumber(t),a=f.parseNumber(a),f.anyIsError(t,a))return t;if(n=n===void 0?"i":n,n!=="i"&&n!=="j")return c.value;if(t===0&&a===0)return 0;if(t===0)return a===1?n:a.toString()+n;if(a===0)return t.toString();var r=a>0?"+":"";return t.toString()+r+(a===1?n:a.toString()+n)},l.CONVERT=function(t,a,n){if(t=f.parseNumber(t),t instanceof Error)return t;for(var r=[["a.u. of action","?",null,"action",!1,!1,105457168181818e-48],["a.u. of charge","e",null,"electric_charge",!1,!1,160217653141414e-33],["a.u. of energy","Eh",null,"energy",!1,!1,435974417757576e-32],["a.u. of length","a?",null,"length",!1,!1,529177210818182e-25],["a.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["a.u. of time","?/Eh",null,"time",!1,!1,241888432650516e-31],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["ngstrm","",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,149597870691667e-25],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic ngstrm","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,846786664623715e-61],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,416818182544058e-5],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,758660370370369e-22],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,166053886282828e-41],["day","d",["day"],"time",!1,!0,86400],["degree","",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519538e-3],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,105457168181818e-48],["n.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,128808866778687e-35],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["rsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdestrke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1e-4],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square ngstrm","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,64516e-8],["square light-year","ly2",["ly^2"],"area",!1,!0,895054210748189e17],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988110336e-6],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1e-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1e-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],e={Yi:["yobi",80,12089258196146292e8,"Yi","yotta"],Zi:["zebi",70,11805916207174113e5,"Zi","zetta"],Ei:["exbi",60,1152921504606847e3,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},i={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]},o=null,v=null,E=a,h=n,m=1,A=1,N,T=0;T<r.length;T++)N=r[T][2]===null?[]:r[T][2],(r[T][1]===E||N.indexOf(E)>=0)&&(o=r[T]),(r[T][1]===h||N.indexOf(h)>=0)&&(v=r[T]);if(o===null){var R=e[a.substring(0,2)],O=i[a.substring(0,1)];a.substring(0,2)==="da"&&(O=["dekao",10,"da"]),R?(m=R[2],E=a.substring(2)):O&&(m=O[1],E=a.substring(O[2].length));for(var y=0;y<r.length;y++)N=r[y][2]===null?[]:r[y][2],(r[y][1]===E||N.indexOf(E)>=0)&&(o=r[y])}if(v===null){var p=e[n.substring(0,2)],C=i[n.substring(0,1)];n.substring(0,2)==="da"&&(C=["dekao",10,"da"]),p?(A=p[2],h=n.substring(2)):C&&(A=C[1],h=n.substring(C[2].length));for(var M=0;M<r.length;M++)N=r[M][2]===null?[]:r[M][2],(r[M][1]===h||N.indexOf(h)>=0)&&(v=r[M])}return o===null||v===null||o[3]!==v[3]?c.na:t*o[6]*m/(v[6]*A)},l.DEC2BIN=function(t,a){if(t=f.parseNumber(t),t instanceof Error)return t;if(!/^-?[0-9]{1,3}$/.test(t)||t<-512||t>511)return c.num;if(t<0)return"1"+u.REPT("0",9-(512+t).toString(2).length)+(512+t).toString(2);var n=parseInt(t,10).toString(2);return typeof a>"u"?n:isNaN(a)?c.value:a<0?c.num:(a=Math.floor(a),a>=n.length?u.REPT("0",a-n.length)+n:c.num)},l.DEC2HEX=function(t,a){if(t=f.parseNumber(t),t instanceof Error)return t;if(!/^-?[0-9]{1,12}$/.test(t)||t<-549755813888||t>549755813887)return c.num;if(t<0)return(1099511627776+t).toString(16);var n=parseInt(t,10).toString(16);return typeof a>"u"?n:isNaN(a)?c.value:a<0?c.num:(a=Math.floor(a),a>=n.length?u.REPT("0",a-n.length)+n:c.num)},l.DEC2OCT=function(t,a){if(t=f.parseNumber(t),t instanceof Error)return t;if(!/^-?[0-9]{1,9}$/.test(t)||t<-536870912||t>536870911)return c.num;if(t<0)return(1073741824+t).toString(8);var n=parseInt(t,10).toString(8);return typeof a>"u"?n:isNaN(a)?c.value:a<0?c.num:(a=Math.floor(a),a>=n.length?u.REPT("0",a-n.length)+n:c.num)},l.DELTA=function(t,a){return a=a===void 0?0:a,t=f.parseNumber(t),a=f.parseNumber(a),f.anyIsError(t,a)?c.value:t===a?1:0},l.ERF=function(t,a){return a=a===void 0?0:a,t=f.parseNumber(t),a=f.parseNumber(a),f.anyIsError(t,a)?c.value:g.erf(t)},l.ERF.PRECISE=function(){throw new Error("ERF.PRECISE is not implemented")},l.ERFC=function(t){return isNaN(t)?c.value:g.erfc(t)},l.ERFC.PRECISE=function(){throw new Error("ERFC.PRECISE is not implemented")},l.GESTEP=function(t,a){return a=a||0,t=f.parseNumber(t),f.anyIsError(a,t)?t:t>=a?1:0},l.HEX2BIN=function(t,a){if(!/^[0-9A-Fa-f]{1,10}$/.test(t))return c.num;var n=t.length===10&&t.substring(0,1).toLowerCase()==="f",r=n?parseInt(t,16)-1099511627776:parseInt(t,16);if(r<-512||r>511)return c.num;if(n)return"1"+u.REPT("0",9-(512+r).toString(2).length)+(512+r).toString(2);var e=r.toString(2);return a===void 0?e:isNaN(a)?c.value:a<0?c.num:(a=Math.floor(a),a>=e.length?u.REPT("0",a-e.length)+e:c.num)},l.HEX2DEC=function(t){if(!/^[0-9A-Fa-f]{1,10}$/.test(t))return c.num;var a=parseInt(t,16);return a>=549755813888?a-1099511627776:a},l.HEX2OCT=function(t,a){if(!/^[0-9A-Fa-f]{1,10}$/.test(t))return c.num;var n=parseInt(t,16);if(n>536870911&&n<0xffe0000000)return c.num;if(n>=0xffe0000000)return(n-0xffc0000000).toString(8);var r=n.toString(8);return a===void 0?r:isNaN(a)?c.value:a<0?c.num:(a=Math.floor(a),a>=r.length?u.REPT("0",a-r.length)+r:c.num)},l.IMABS=function(t){var a=l.IMREAL(t),n=l.IMAGINARY(t);return f.anyIsError(a,n)?c.value:Math.sqrt(Math.pow(a,2)+Math.pow(n,2))},l.IMAGINARY=function(t){if(t===void 0||t===!0||t===!1)return c.value;if(t===0||t==="0")return 0;if(["i","j"].indexOf(t)>=0)return 1;t=t.replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j");var a=t.indexOf("+"),n=t.indexOf("-");a===0&&(a=t.indexOf("+",1)),n===0&&(n=t.indexOf("-",1));var r=t.substring(t.length-1,t.length),e=r==="i"||r==="j";return a>=0||n>=0?e?a>=0?isNaN(t.substring(0,a))||isNaN(t.substring(a+1,t.length-1))?c.num:Number(t.substring(a+1,t.length-1)):isNaN(t.substring(0,n))||isNaN(t.substring(n+1,t.length-1))?c.num:-Number(t.substring(n+1,t.length-1)):c.num:e?isNaN(t.substring(0,t.length-1))?c.num:t.substring(0,t.length-1):isNaN(t)?c.num:0},l.IMARGUMENT=function(t){var a=l.IMREAL(t),n=l.IMAGINARY(t);return f.anyIsError(a,n)?c.value:a===0&&n===0?c.div0:a===0&&n>0?Math.PI/2:a===0&&n<0?-Math.PI/2:n===0&&a>0?0:n===0&&a<0?-Math.PI:a>0?Math.atan(n/a):a<0&&n>=0?Math.atan(n/a)+Math.PI:Math.atan(n/a)-Math.PI},l.IMCONJUGATE=function(t){var a=l.IMREAL(t),n=l.IMAGINARY(t);if(f.anyIsError(a,n))return c.value;var r=t.substring(t.length-1);return r=r==="i"||r==="j"?r:"i",n!==0?l.COMPLEX(a,-n,r):t},l.IMCOS=function(t){var a=l.IMREAL(t),n=l.IMAGINARY(t);if(f.anyIsError(a,n))return c.value;var r=t.substring(t.length-1);return r=r==="i"||r==="j"?r:"i",l.COMPLEX(Math.cos(a)*(Math.exp(n)+Math.exp(-n))/2,-Math.sin(a)*(Math.exp(n)-Math.exp(-n))/2,r)},l.IMCOSH=function(t){var a=l.IMREAL(t),n=l.IMAGINARY(t);if(f.anyIsError(a,n))return c.value;var r=t.substring(t.length-1);return r=r==="i"||r==="j"?r:"i",l.COMPLEX(Math.cos(n)*(Math.exp(a)+Math.exp(-a))/2,Math.sin(n)*(Math.exp(a)-Math.exp(-a))/2,r)},l.IMCOT=function(t){var a=l.IMREAL(t),n=l.IMAGINARY(t);return f.anyIsError(a,n)?c.value:l.IMDIV(l.IMCOS(t),l.IMSIN(t))},l.IMDIV=function(t,a){var n=l.IMREAL(t),r=l.IMAGINARY(t),e=l.IMREAL(a),i=l.IMAGINARY(a);if(f.anyIsError(n,r,e,i))return c.value;var o=t.substring(t.length-1),v=a.substring(a.length-1),E="i";if((o==="j"||v==="j")&&(E="j"),e===0&&i===0)return c.num;var h=e*e+i*i;return l.COMPLEX((n*e+r*i)/h,(r*e-n*i)/h,E)},l.IMEXP=function(t){var a=l.IMREAL(t),n=l.IMAGINARY(t);if(f.anyIsError(a,n))return c.value;var r=t.substring(t.length-1);r=r==="i"||r==="j"?r:"i";var e=Math.exp(a);return l.COMPLEX(e*Math.cos(n),e*Math.sin(n),r)},l.IMLN=function(t){var a=l.IMREAL(t),n=l.IMAGINARY(t);if(f.anyIsError(a,n))return c.value;var r=t.substring(t.length-1);return r=r==="i"||r==="j"?r:"i",l.COMPLEX(Math.log(Math.sqrt(a*a+n*n)),Math.atan(n/a),r)},l.IMLOG10=function(t){var a=l.IMREAL(t),n=l.IMAGINARY(t);if(f.anyIsError(a,n))return c.value;var r=t.substring(t.length-1);return r=r==="i"||r==="j"?r:"i",l.COMPLEX(Math.log(Math.sqrt(a*a+n*n))/Math.log(10),Math.atan(n/a)/Math.log(10),r)},l.IMLOG2=function(t){var a=l.IMREAL(t),n=l.IMAGINARY(t);if(f.anyIsError(a,n))return c.value;var r=t.substring(t.length-1);return r=r==="i"||r==="j"?r:"i",l.COMPLEX(Math.log(Math.sqrt(a*a+n*n))/Math.log(2),Math.atan(n/a)/Math.log(2),r)},l.IMPOWER=function(t,a){a=f.parseNumber(a);var n=l.IMREAL(t),r=l.IMAGINARY(t);if(f.anyIsError(a,n,r))return c.value;var e=t.substring(t.length-1);e=e==="i"||e==="j"?e:"i";var i=Math.pow(l.IMABS(t),a),o=l.IMARGUMENT(t);return l.COMPLEX(i*Math.cos(a*o),i*Math.sin(a*o),e)},l.IMPRODUCT=function(){var t=arguments[0];if(!arguments.length)return c.value;for(var a=1;a<arguments.length;a++){var n=l.IMREAL(t),r=l.IMAGINARY(t),e=l.IMREAL(arguments[a]),i=l.IMAGINARY(arguments[a]);if(f.anyIsError(n,r,e,i))return c.value;t=l.COMPLEX(n*e-r*i,n*i+r*e)}return t},l.IMREAL=function(t){if(t===void 0||t===!0||t===!1)return c.value;if(t===0||t==="0"||["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(t)>=0)return 0;var a=t.indexOf("+"),n=t.indexOf("-");a===0&&(a=t.indexOf("+",1)),n===0&&(n=t.indexOf("-",1));var r=t.substring(t.length-1,t.length),e=r==="i"||r==="j";return a>=0||n>=0?e?a>=0?isNaN(t.substring(0,a))||isNaN(t.substring(a+1,t.length-1))?c.num:Number(t.substring(0,a)):isNaN(t.substring(0,n))||isNaN(t.substring(n+1,t.length-1))?c.num:Number(t.substring(0,n)):c.num:e?isNaN(t.substring(0,t.length-1))?c.num:0:isNaN(t)?c.num:t},l.IMSEC=function(t){if(t===!0||t===!1)return c.value;var a=l.IMREAL(t),n=l.IMAGINARY(t);return f.anyIsError(a,n)?c.value:l.IMDIV("1",l.IMCOS(t))},l.IMSECH=function(t){var a=l.IMREAL(t),n=l.IMAGINARY(t);return f.anyIsError(a,n)?c.value:l.IMDIV("1",l.IMCOSH(t))},l.IMSIN=function(t){var a=l.IMREAL(t),n=l.IMAGINARY(t);if(f.anyIsError(a,n))return c.value;var r=t.substring(t.length-1);return r=r==="i"||r==="j"?r:"i",l.COMPLEX(Math.sin(a)*(Math.exp(n)+Math.exp(-n))/2,Math.cos(a)*(Math.exp(n)-Math.exp(-n))/2,r)},l.IMSINH=function(t){var a=l.IMREAL(t),n=l.IMAGINARY(t);if(f.anyIsError(a,n))return c.value;var r=t.substring(t.length-1);return r=r==="i"||r==="j"?r:"i",l.COMPLEX(Math.cos(n)*(Math.exp(a)-Math.exp(-a))/2,Math.sin(n)*(Math.exp(a)+Math.exp(-a))/2,r)},l.IMSQRT=function(t){var a=l.IMREAL(t),n=l.IMAGINARY(t);if(f.anyIsError(a,n))return c.value;var r=t.substring(t.length-1);r=r==="i"||r==="j"?r:"i";var e=Math.sqrt(l.IMABS(t)),i=l.IMARGUMENT(t);return l.COMPLEX(e*Math.cos(i/2),e*Math.sin(i/2),r)},l.IMCSC=function(t){if(t===!0||t===!1)return c.value;var a=l.IMREAL(t),n=l.IMAGINARY(t);return f.anyIsError(a,n)?c.num:l.IMDIV("1",l.IMSIN(t))},l.IMCSCH=function(t){if(t===!0||t===!1)return c.value;var a=l.IMREAL(t),n=l.IMAGINARY(t);return f.anyIsError(a,n)?c.num:l.IMDIV("1",l.IMSINH(t))},l.IMSUB=function(t,a){var n=this.IMREAL(t),r=this.IMAGINARY(t),e=this.IMREAL(a),i=this.IMAGINARY(a);if(f.anyIsError(n,r,e,i))return c.value;var o=t.substring(t.length-1),v=a.substring(a.length-1),E="i";return(o==="j"||v==="j")&&(E="j"),this.COMPLEX(n-e,r-i,E)},l.IMSUM=function(){if(!arguments.length)return c.value;for(var t=f.flatten(arguments),a=t[0],n=1;n<t.length;n++){var r=this.IMREAL(a),e=this.IMAGINARY(a),i=this.IMREAL(t[n]),o=this.IMAGINARY(t[n]);if(f.anyIsError(r,e,i,o))return c.value;a=this.COMPLEX(r+i,e+o)}return a},l.IMTAN=function(t){if(t===!0||t===!1)return c.value;var a=l.IMREAL(t),n=l.IMAGINARY(t);return f.anyIsError(a,n)?c.value:this.IMDIV(this.IMSIN(t),this.IMCOS(t))},l.OCT2BIN=function(t,a){if(!/^[0-7]{1,10}$/.test(t))return c.num;var n=t.length===10&&t.substring(0,1)==="7",r=n?parseInt(t,8)-1073741824:parseInt(t,8);if(r<-512||r>511)return c.num;if(n)return"1"+u.REPT("0",9-(512+r).toString(2).length)+(512+r).toString(2);var e=r.toString(2);return typeof a>"u"?e:isNaN(a)?c.value:a<0?c.num:(a=Math.floor(a),a>=e.length?u.REPT("0",a-e.length)+e:c.num)},l.OCT2DEC=function(t){if(!/^[0-7]{1,10}$/.test(t))return c.num;var a=parseInt(t,8);return a>=536870912?a-1073741824:a},l.OCT2HEX=function(t,a){if(!/^[0-7]{1,10}$/.test(t))return c.num;var n=parseInt(t,8);if(n>=536870912)return"ff"+(n+3221225472).toString(16);var r=n.toString(16);return a===void 0?r:isNaN(a)?c.value:a<0?c.num:(a=Math.floor(a),a>=r.length?u.REPT("0",a-r.length)+r:c.num)}})(An);var zr={};(function(l){var c=B,g=sr,u=new Date(Date.UTC(1900,0,1)),f=[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0],I=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],s=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6]];l.DATE=function(r,e,i){var o;return r=g.parseNumber(r),e=g.parseNumber(e),i=g.parseNumber(i),g.anyIsError(r,e,i)?o=c.value:r<0||e<0||i<0?o=c.num:o=new Date(r,e-1,i),o},l.DATEVALUE=function(r){var e=2,i;return typeof r!="string"||(i=Date.parse(r),isNaN(i))?c.value:(i<=-22038912e5&&(e=1),Math.ceil((i-u)/864e5)+e)},l.DAY=function(r){var e=g.parseDate(r);return e instanceof Error?e:e.getDate()},l.DAYS=function(r,e){return r=g.parseDate(r),e=g.parseDate(e),r instanceof Error?r:e instanceof Error?e:n(r)-n(e)},l.DAYS360=function(r,e,i){if(i=g.parseBool(i),r=g.parseDate(r),e=g.parseDate(e),r instanceof Error)return r;if(e instanceof Error)return e;if(i instanceof Error)return i;var o=r.getMonth(),v=e.getMonth(),E,h;if(i)E=r.getDate()===31?30:r.getDate(),h=e.getDate()===31?30:e.getDate();else{var m=new Date(r.getFullYear(),o+1,0).getDate(),A=new Date(e.getFullYear(),v+1,0).getDate();E=r.getDate()===m?30:r.getDate(),e.getDate()===A?E<30?(v++,h=1):h=30:h=e.getDate()}return 360*(e.getFullYear()-r.getFullYear())+30*(v-o)+(h-E)},l.EDATE=function(r,e){return r=g.parseDate(r),r instanceof Error?r:isNaN(e)?c.value:(e=parseInt(e,10),r.setMonth(r.getMonth()+e),n(r))},l.EOMONTH=function(r,e){return r=g.parseDate(r),r instanceof Error?r:isNaN(e)?c.value:(e=parseInt(e,10),n(new Date(r.getFullYear(),r.getMonth()+e+1,0)))},l.HOUR=function(r){return r=g.parseDate(r),r instanceof Error?r:r.getHours()},l.INTERVAL=function(r){if(typeof r!="number"&&typeof r!="string")return c.value;r=parseInt(r,10);var e=Math.floor(r/94608e4);r=r%94608e4;var i=Math.floor(r/2592e3);r=r%2592e3;var o=Math.floor(r/86400);r=r%86400;var v=Math.floor(r/3600);r=r%3600;var E=Math.floor(r/60);r=r%60;var h=r;return e=e>0?e+"Y":"",i=i>0?i+"M":"",o=o>0?o+"D":"",v=v>0?v+"H":"",E=E>0?E+"M":"",h=h>0?h+"S":"","P"+e+i+o+"T"+v+E+h},l.ISOWEEKNUM=function(r){if(r=g.parseDate(r),r instanceof Error)return r;r.setHours(0,0,0),r.setDate(r.getDate()+4-(r.getDay()||7));var e=new Date(r.getFullYear(),0,1);return Math.ceil(((r-e)/864e5+1)/7)},l.MINUTE=function(r){return r=g.parseDate(r),r instanceof Error?r:r.getMinutes()},l.MONTH=function(r){return r=g.parseDate(r),r instanceof Error?r:r.getMonth()+1},l.NETWORKDAYS=function(r,e,i){return this.NETWORKDAYS.INTL(r,e,1,i)},l.NETWORKDAYS.INTL=function(r,e,i,o){if(r=g.parseDate(r),r instanceof Error)return r;if(e=g.parseDate(e),e instanceof Error)return e;if(i===void 0?i=s[1]:i=s[i],!(i instanceof Array))return c.value;o===void 0?o=[]:o instanceof Array||(o=[o]);for(var v=0;v<o.length;v++){var E=g.parseDate(o[v]);if(E instanceof Error)return E;o[v]=E}var h=(e-r)/(1e3*60*60*24)+1,m=h,A=r;for(v=0;v<h;v++){var N=new Date().getTimezoneOffset()>0?A.getUTCDay():A.getDay(),T=!1;(N===i[0]||N===i[1])&&(T=!0);for(var R=0;R<o.length;R++){var O=o[R];if(O.getDate()===A.getDate()&&O.getMonth()===A.getMonth()&&O.getFullYear()===A.getFullYear()){T=!0;break}}T&&m--,A.setDate(A.getDate()+1)}return m},l.NOW=function(){return new Date},l.SECOND=function(r){return r=g.parseDate(r),r instanceof Error?r:r.getSeconds()},l.TIME=function(r,e,i){return r=g.parseNumber(r),e=g.parseNumber(e),i=g.parseNumber(i),g.anyIsError(r,e,i)?c.value:r<0||e<0||i<0?c.num:(3600*r+60*e+i)/86400},l.TIMEVALUE=function(r){return r=g.parseDate(r),r instanceof Error?r:(3600*r.getHours()+60*r.getMinutes()+r.getSeconds())/86400},l.TODAY=function(){return new Date},l.WEEKDAY=function(r,e){if(r=g.parseDate(r),r instanceof Error)return r;e===void 0&&(e=1);var i=r.getDay();return I[e][i]},l.WEEKNUM=function(r,e){if(r=g.parseDate(r),r instanceof Error)return r;if(e===void 0&&(e=1),e===21)return this.ISOWEEKNUM(r);var i=f[e],o=new Date(r.getFullYear(),0,1),v=o.getDay()<i?1:0;return o-=Math.abs(o.getDay()-i)*24*60*60*1e3,Math.floor((r-o)/(1e3*60*60*24)/7+1)+v},l.WORKDAY=function(r,e,i){return this.WORKDAY.INTL(r,e,1,i)},l.WORKDAY.INTL=function(r,e,i,o){if(r=g.parseDate(r),r instanceof Error)return r;if(e=g.parseNumber(e),e instanceof Error)return e;if(e<0)return c.num;if(i===void 0?i=s[1]:i=s[i],!(i instanceof Array))return c.value;o===void 0?o=[]:o instanceof Array||(o=[o]);for(var v=0;v<o.length;v++){var E=g.parseDate(o[v]);if(E instanceof Error)return E;o[v]=E}for(var h=0;h<e;){r.setDate(r.getDate()+1);var m=r.getDay();if(!(m===i[0]||m===i[1])){for(var A=0;A<o.length;A++){var N=o[A];if(N.getDate()===r.getDate()&&N.getMonth()===r.getMonth()&&N.getFullYear()===r.getFullYear()){h--;break}}h++}}return r},l.YEAR=function(r){return r=g.parseDate(r),r instanceof Error?r:r.getFullYear()};function t(r){return new Date(r,1,29).getMonth()===1}function a(r,e){return Math.ceil((e-r)/1e3/60/60/24)}l.YEARFRAC=function(r,e,i){if(r=g.parseDate(r),r instanceof Error)return r;if(e=g.parseDate(e),e instanceof Error)return e;i=i||0;var o=r.getDate(),v=r.getMonth()+1,E=r.getFullYear(),h=e.getDate(),m=e.getMonth()+1,A=e.getFullYear();switch(i){case 0:return o===31&&h===31?(o=30,h=30):o===31?o=30:o===30&&h===31&&(h=30),(h+m*30+A*360-(o+v*30+E*360))/360;case 1:var N=function(p,C){var M=p.getFullYear(),d=new Date(M,2,1);if(t(M)&&p<d&&C>=d)return!0;var P=C.getFullYear(),V=new Date(P,2,1);return t(P)&&C>=V&&p<V},T=365;if(E===A||E+1===A&&(v>m||v===m&&o>=h))return(E===A&&t(E)||N(r,e)||m===1&&h===29)&&(T=366),a(r,e)/T;var R=A-E+1,O=(new Date(A+1,0,1)-new Date(E,0,1))/1e3/60/60/24,y=O/R;return a(r,e)/y;case 2:return a(r,e)/360;case 3:return a(r,e)/365;case 4:return(h+m*30+A*360-(o+v*30+E*360))/360}};function n(r){var e=r>-22038912e5?2:1;return Math.ceil((r-u)/864e5)+e}})(zr);var Nr=Wr(),D=Kr(),Sn=An,qn=zr;function or(l,c){if(c)for(var g in c)l[g]=c[g];return l}L.BETADIST=D.BETA.DIST;L.BETAINV=D.BETA.INV;L.BINOMDIST=D.BINOM.DIST;L.CEILING=L.ISOCEILING=or(Nr.CEILING.MATH,Nr.CEILING);L.CEILINGMATH=Nr.CEILING.MATH;L.CEILINGPRECISE=Nr.CEILING.PRECISE;L.CHIDIST=D.CHISQ.DIST;L.CHIDISTRT=D.CHISQ.DIST.RT;L.CHIINV=D.CHISQ.INV;L.CHIINVRT=D.CHISQ.INV.RT;L.CHITEST=D.CHISQ.TEST;L.CONFIDENCE=or(D.CONFIDENCE.NORM,D.CONFIDENCE);L.COVAR=D.COVARIANCE.P;L.COVARIANCEP=D.COVARIANCE.P;L.COVARIANCES=D.COVARIANCE.S;L.CRITBINOM=D.BINOM.INV;L.EXPONDIST=D.EXPON.DIST;L.ERFCPRECISE=Sn.ERFC.PRECISE;L.ERFPRECISE=Sn.ERF.PRECISE;L.FDIST=D.F.DIST;L.FDISTRT=D.F.DIST.RT;L.FINVRT=D.F.INV.RT;L.FINV=D.F.INV;L.FLOOR=or(Nr.FLOOR.MATH,Nr.FLOOR);L.FLOORMATH=Nr.FLOOR.MATH;L.FLOORPRECISE=Nr.FLOOR.PRECISE;L.FTEST=D.F.TEST;L.GAMMADIST=D.GAMMA.DIST;L.GAMMAINV=D.GAMMA.INV;L.GAMMALNPRECISE=D.GAMMALN.PRECISE;L.HYPGEOMDIST=D.HYPGEOM.DIST;L.LOGINV=D.LOGNORM.INV;L.LOGNORMINV=D.LOGNORM.INV;L.LOGNORMDIST=D.LOGNORM.DIST;L.MODE=or(D.MODE.SNGL,D.MODE);L.MODEMULT=D.MODE.MULT;L.MODESNGL=D.MODE.SNGL;L.NEGBINOMDIST=D.NEGBINOM.DIST;L.NETWORKDAYSINTL=qn.NETWORKDAYS.INTL;L.NORMDIST=D.NORM.DIST;L.NORMINV=D.NORM.INV;L.NORMSDIST=D.NORM.S.DIST;L.NORMSINV=D.NORM.S.INV;L.PERCENTILE=or(D.PERCENTILE.EXC,D.PERCENTILE);L.PERCENTILEEXC=D.PERCENTILE.EXC;L.PERCENTILEINC=D.PERCENTILE.INC;L.PERCENTRANK=or(D.PERCENTRANK.INC,D.PERCENTRANK);L.PERCENTRANKEXC=D.PERCENTRANK.EXC;L.PERCENTRANKINC=D.PERCENTRANK.INC;L.POISSON=or(D.POISSON.DIST,D.POISSON);L.POISSONDIST=D.POISSON.DIST;L.QUARTILE=or(D.QUARTILE.INC,D.QUARTILE);L.QUARTILEEXC=D.QUARTILE.EXC;L.QUARTILEINC=D.QUARTILE.INC;L.RANK=or(D.RANK.EQ,D.RANK);L.RANKAVG=D.RANK.AVG;L.RANKEQ=D.RANK.EQ;L.SKEWP=D.SKEW.P;L.STDEV=or(D.STDEV.S,D.STDEV);L.STDEVP=D.STDEV.P;L.STDEVS=D.STDEV.S;L.TDIST=D.T.DIST;L.TDISTRT=D.T.DIST.RT;L.TINV=D.T.INV;L.TTEST=D.T.TEST;L.VAR=or(D.VAR.S,D.VAR);L.VARP=D.VAR.P;L.VARS=D.VAR.S;L.WEIBULL=or(D.WEIBULL.DIST,D.WEIBULL);L.WEIBULLDIST=D.WEIBULL.DIST;L.WORKDAYINTL=qn.WORKDAY.INTL;L.ZTEST=D.Z.TEST;var Hn={};(function(l){var c=B,g=Kr(),u=Wr(),f=sr,I=mr;function s(a){var n=[];return f.arrayEach(a,function(r){r&&n.push(r)}),n}l.FINDFIELD=function(a,n){var r=null;return f.arrayEach(a,function(e,i){if(e[0]===n)return r=i,!1}),r??c.value};function t(a,n){for(var r={},e=1;e<a[0].length;++e)r[e]=!0;var i=n[0].length;for(e=1;e<n.length;++e)n[e].length>i&&(i=n[e].length);for(var o=1;o<a.length;++o)for(var v=1;v<a[o].length;++v){for(var E=!1,h=!1,m=0;m<n.length;++m){var A=n[m];if(!(A.length<i)){var N=A[0];if(a[o][0]===N){h=!0;for(var T=1;T<A.length;++T)if(!E){var R=A[T]===void 0||A[T]==="*";if(R)E=!0;else{var O=I.parse(A[T]+""),y=[I.createToken(a[o][v],I.TOKEN_TYPE_LITERAL)].concat(O);E=I.compute(y)}}}}}h&&(r[v]=r[v]&&E)}for(var p=[],C=0;C<a[0].length;++C)r[C]&&p.push(C-1);return p}l.DAVERAGE=function(a,n,r){if(isNaN(n)&&typeof n!="string")return c.value;var e=t(a,r),i=[];if(typeof n=="string"){var o=l.FINDFIELD(a,n);i=f.rest(a[o])}else i=f.rest(a[n]);var v=0;return f.arrayEach(e,function(E){v+=i[E]}),e.length===0?c.div0:v/e.length},l.DCOUNT=function(a,n,r){if(isNaN(n)&&typeof n!="string")return c.value;var e=t(a,r),i=[];if(typeof n=="string"){var o=l.FINDFIELD(a,n);i=f.rest(a[o])}else i=f.rest(a[n]);var v=[];return f.arrayEach(e,function(E){v.push(i[E])}),g.COUNT(v)},l.DCOUNTA=function(a,n,r){if(isNaN(n)&&typeof n!="string")return c.value;var e=t(a,r),i=[];if(typeof n=="string"){var o=l.FINDFIELD(a,n);i=f.rest(a[o])}else i=f.rest(a[n]);var v=[];return f.arrayEach(e,function(E){v.push(i[E])}),g.COUNTA(v)},l.DGET=function(a,n,r){if(isNaN(n)&&typeof n!="string")return c.value;var e=t(a,r),i=[];if(typeof n=="string"){var o=l.FINDFIELD(a,n);i=f.rest(a[o])}else i=f.rest(a[n]);return e.length===0?c.value:e.length>1?c.num:i[e[0]]},l.DMAX=function(a,n,r){if(isNaN(n)&&typeof n!="string")return c.value;var e=t(a,r),i=[];if(typeof n=="string"){var o=l.FINDFIELD(a,n);i=f.rest(a[o])}else i=f.rest(a[n]);var v=i[e[0]];return f.arrayEach(e,function(E){v<i[E]&&(v=i[E])}),v},l.DMIN=function(a,n,r){if(isNaN(n)&&typeof n!="string")return c.value;var e=t(a,r),i=[];if(typeof n=="string"){var o=l.FINDFIELD(a,n);i=f.rest(a[o])}else i=f.rest(a[n]);var v=i[e[0]];return f.arrayEach(e,function(E){v>i[E]&&(v=i[E])}),v},l.DPRODUCT=function(a,n,r){if(isNaN(n)&&typeof n!="string")return c.value;var e=t(a,r),i=[];if(typeof n=="string"){var o=l.FINDFIELD(a,n);i=f.rest(a[o])}else i=f.rest(a[n]);var v=[];f.arrayEach(e,function(h){v.push(i[h])}),v=s(v);var E=1;return f.arrayEach(v,function(h){E*=h}),E},l.DSTDEV=function(a,n,r){if(isNaN(n)&&typeof n!="string")return c.value;var e=t(a,r),i=[];if(typeof n=="string"){var o=l.FINDFIELD(a,n);i=f.rest(a[o])}else i=f.rest(a[n]);var v=[];return f.arrayEach(e,function(E){v.push(i[E])}),v=s(v),g.STDEV.S(v)},l.DSTDEVP=function(a,n,r){if(isNaN(n)&&typeof n!="string")return c.value;var e=t(a,r),i=[];if(typeof n=="string"){var o=l.FINDFIELD(a,n);i=f.rest(a[o])}else i=f.rest(a[n]);var v=[];return f.arrayEach(e,function(E){v.push(i[E])}),v=s(v),g.STDEV.P(v)},l.DSUM=function(a,n,r){if(isNaN(n)&&typeof n!="string")return c.value;var e=t(a,r),i=[];if(typeof n=="string"){var o=l.FINDFIELD(a,n);i=f.rest(a[o])}else i=f.rest(a[n]);var v=[];return f.arrayEach(e,function(E){v.push(i[E])}),u.SUM(v)},l.DVAR=function(a,n,r){if(isNaN(n)&&typeof n!="string")return c.value;var e=t(a,r),i=[];if(typeof n=="string"){var o=l.FINDFIELD(a,n);i=f.rest(a[o])}else i=f.rest(a[n]);var v=[];return f.arrayEach(e,function(E){v.push(i[E])}),g.VAR.S(v)},l.DVARP=function(a,n,r){if(isNaN(n)&&typeof n!="string")return c.value;var e=t(a,r),i=[];if(typeof n=="string"){var o=l.FINDFIELD(a,n);i=f.rest(a[o])}else i=f.rest(a[n]);var v=[];return f.arrayEach(e,function(E){v.push(i[E])}),g.VAR.P(v)}})(Hn);var lr={},Cr=B,Tn=sr,ve=Qr;lr.AND=function(){for(var l=Tn.flatten(arguments),c=!0,g=0;g<l.length;g++)l[g]||(c=!1);return c};lr.CHOOSE=function(){if(arguments.length<2)return Cr.na;var l=arguments[0];return l<1||l>254||arguments.length<l+1?Cr.value:arguments[l]};lr.FALSE=function(){return!1};lr.IF=function(l,c,g){return l?c:g};lr.IFERROR=function(l,c){return ve.ISERROR(l)?c:l};lr.IFNA=function(l,c){return l===Cr.na?c:l};lr.NOT=function(l){return!l};lr.OR=function(){for(var l=Tn.flatten(arguments),c=!1,g=0;g<l.length;g++)l[g]&&(c=!0);return c};lr.TRUE=function(){return!0};lr.XOR=function(){for(var l=Tn.flatten(arguments),c=0,g=0;g<l.length;g++)l[g]&&c++;return!!(Math.floor(Math.abs(c))&1)};lr.SWITCH=function(){var l;if(arguments.length>0){var c=arguments[0],g=arguments.length-1,u=Math.floor(g/2),f=!1,I=g%2!==0,s=g%2===0?null:arguments[arguments.length-1];if(u){for(var t=0;t<u;t++)if(c===arguments[t*2+1]){l=arguments[t*2+2],f=!0;break}}f||(l=I?s:Cr.na)}else l=Cr.value;return l};var Xn={};(function(l){var c=B,g=zr,u=sr;function f(s){return s&&s.getTime&&!isNaN(s.getTime())}function I(s){return s instanceof Date?s:new Date(s)}l.ACCRINT=function(s,t,a,n,r,e,i){return s=I(s),t=I(t),a=I(a),!f(s)||!f(t)||!f(a)?c.value:n<=0||r<=0||[1,2,4].indexOf(e)===-1||[0,1,2,3,4].indexOf(i)===-1||a<=s?c.num:(r=r||0,i=i||0,r*n*g.YEARFRAC(s,a,i))},l.ACCRINTM=function(){throw new Error("ACCRINTM is not implemented")},l.AMORDEGRC=function(){throw new Error("AMORDEGRC is not implemented")},l.AMORLINC=function(){throw new Error("AMORLINC is not implemented")},l.COUPDAYBS=function(){throw new Error("COUPDAYBS is not implemented")},l.COUPDAYS=function(){throw new Error("COUPDAYS is not implemented")},l.COUPDAYSNC=function(){throw new Error("COUPDAYSNC is not implemented")},l.COUPNCD=function(){throw new Error("COUPNCD is not implemented")},l.COUPNUM=function(){throw new Error("COUPNUM is not implemented")},l.COUPPCD=function(){throw new Error("COUPPCD is not implemented")},l.CUMIPMT=function(s,t,a,n,r,e){if(s=u.parseNumber(s),t=u.parseNumber(t),a=u.parseNumber(a),u.anyIsError(s,t,a))return c.value;if(s<=0||t<=0||a<=0||n<1||r<1||n>r||e!==0&&e!==1)return c.num;var i=l.PMT(s,t,a,0,e),o=0;n===1&&e===0&&(o=-a,n++);for(var v=n;v<=r;v++)e===1?o+=l.FV(s,v-2,i,a,1)-i:o+=l.FV(s,v-1,i,a,0);return o*=s,o},l.CUMPRINC=function(s,t,a,n,r,e){if(s=u.parseNumber(s),t=u.parseNumber(t),a=u.parseNumber(a),u.anyIsError(s,t,a))return c.value;if(s<=0||t<=0||a<=0||n<1||r<1||n>r||e!==0&&e!==1)return c.num;var i=l.PMT(s,t,a,0,e),o=0;n===1&&(e===0?o=i+a*s:o=i,n++);for(var v=n;v<=r;v++)e>0?o+=i-(l.FV(s,v-2,i,a,1)-i)*s:o+=i-l.FV(s,v-1,i,a,0)*s;return o},l.DB=function(s,t,a,n,r){if(r=r===void 0?12:r,s=u.parseNumber(s),t=u.parseNumber(t),a=u.parseNumber(a),n=u.parseNumber(n),r=u.parseNumber(r),u.anyIsError(s,t,a,n,r))return c.value;if(s<0||t<0||a<0||n<0||[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(r)===-1||n>a)return c.num;if(t>=s)return 0;for(var e=(1-Math.pow(t/s,1/a)).toFixed(3),i=s*e*r/12,o=i,v=0,E=n===a?a-1:n,h=2;h<=E;h++)v=(s-o)*e,o+=v;return n===1?i:n===a?(s-o)*e:v},l.DDB=function(s,t,a,n,r){if(r=r===void 0?2:r,s=u.parseNumber(s),t=u.parseNumber(t),a=u.parseNumber(a),n=u.parseNumber(n),r=u.parseNumber(r),u.anyIsError(s,t,a,n,r))return c.value;if(s<0||t<0||a<0||n<0||r<=0||n>a)return c.num;if(t>=s)return 0;for(var e=0,i=0,o=1;o<=n;o++)i=Math.min((s-e)*(r/a),s-t-e),e+=i;return i},l.DISC=function(){throw new Error("DISC is not implemented")},l.DOLLARDE=function(s,t){if(s=u.parseNumber(s),t=u.parseNumber(t),u.anyIsError(s,t))return c.value;if(t<0)return c.num;if(t>=0&&t<1)return c.div0;t=parseInt(t,10);var a=parseInt(s,10);a+=s%1*Math.pow(10,Math.ceil(Math.log(t)/Math.LN10))/t;var n=Math.pow(10,Math.ceil(Math.log(t)/Math.LN2)+1);return a=Math.round(a*n)/n,a},l.DOLLARFR=function(s,t){if(s=u.parseNumber(s),t=u.parseNumber(t),u.anyIsError(s,t))return c.value;if(t<0)return c.num;if(t>=0&&t<1)return c.div0;t=parseInt(t,10);var a=parseInt(s,10);return a+=s%1*Math.pow(10,-Math.ceil(Math.log(t)/Math.LN10))*t,a},l.DURATION=function(){throw new Error("DURATION is not implemented")},l.EFFECT=function(s,t){return s=u.parseNumber(s),t=u.parseNumber(t),u.anyIsError(s,t)?c.value:s<=0||t<1?c.num:(t=parseInt(t,10),Math.pow(1+s/t,t)-1)},l.FV=function(s,t,a,n,r){if(n=n||0,r=r||0,s=u.parseNumber(s),t=u.parseNumber(t),a=u.parseNumber(a),n=u.parseNumber(n),r=u.parseNumber(r),u.anyIsError(s,t,a,n,r))return c.value;var e;if(s===0)e=n+a*t;else{var i=Math.pow(1+s,t);r===1?e=n*i+a*(1+s)*(i-1)/s:e=n*i+a*(i-1)/s}return-e},l.FVSCHEDULE=function(s,t){if(s=u.parseNumber(s),t=u.parseNumberArray(u.flatten(t)),u.anyIsError(s,t))return c.value;for(var a=t.length,n=s,r=0;r<a;r++)n*=1+t[r];return n},l.INTRATE=function(){throw new Error("INTRATE is not implemented")},l.IPMT=function(s,t,a,n,r,e){if(r=r||0,e=e||0,s=u.parseNumber(s),t=u.parseNumber(t),a=u.parseNumber(a),n=u.parseNumber(n),r=u.parseNumber(r),e=u.parseNumber(e),u.anyIsError(s,t,a,n,r,e))return c.value;var i=l.PMT(s,a,n,r,e),o;return t===1?e===1?o=0:o=-n:e===1?o=l.FV(s,t-2,i,n,1)-i:o=l.FV(s,t-1,i,n,0),o*s},l.IRR=function(s,t){if(t=t||0,s=u.parseNumberArray(u.flatten(s)),t=u.parseNumber(t),u.anyIsError(s,t))return c.value;for(var a=function(T,R,O){for(var y=O+1,p=T[0],C=1;C<T.length;C++)p+=T[C]/Math.pow(y,(R[C]-R[0])/365);return p},n=function(T,R,O){for(var y=O+1,p=0,C=1;C<T.length;C++){var M=(R[C]-R[0])/365;p-=M*T[C]/Math.pow(y,M+1)}return p},r=[],e=!1,i=!1,o=0;o<s.length;o++)r[o]=o===0?0:r[o-1]+365,s[o]>0&&(e=!0),s[o]<0&&(i=!0);if(!e||!i)return c.num;t=t===void 0?.1:t;var v=t,E=1e-10,h,m,A,N=!0;do A=a(s,r,v),h=v-A/n(s,r,v),m=Math.abs(h-v),v=h,N=m>E&&Math.abs(A)>E;while(N);return v},l.ISPMT=function(s,t,a,n){return s=u.parseNumber(s),t=u.parseNumber(t),a=u.parseNumber(a),n=u.parseNumber(n),u.anyIsError(s,t,a,n)?c.value:n*s*(t/a-1)},l.MDURATION=function(){throw new Error("MDURATION is not implemented")},l.MIRR=function(s,t,a){if(s=u.parseNumberArray(u.flatten(s)),t=u.parseNumber(t),a=u.parseNumber(a),u.anyIsError(s,t,a))return c.value;for(var n=s.length,r=[],e=[],i=0;i<n;i++)s[i]<0?r.push(s[i]):e.push(s[i]);var o=-l.NPV(a,e)*Math.pow(1+a,n-1),v=l.NPV(t,r)*(1+t);return Math.pow(o/v,1/(n-1))-1},l.NOMINAL=function(s,t){return s=u.parseNumber(s),t=u.parseNumber(t),u.anyIsError(s,t)?c.value:s<=0||t<1?c.num:(t=parseInt(t,10),(Math.pow(s+1,1/t)-1)*t)},l.NPER=function(s,t,a,n,r){if(r=r===void 0?0:r,n=n===void 0?0:n,s=u.parseNumber(s),t=u.parseNumber(t),a=u.parseNumber(a),n=u.parseNumber(n),r=u.parseNumber(r),u.anyIsError(s,t,a,n,r))return c.value;var e=t*(1+s*r)-n*s,i=a*s+t*(1+s*r);return Math.log(e/i)/Math.log(1+s)},l.NPV=function(){var s=u.parseNumberArray(u.flatten(arguments));if(s instanceof Error)return s;for(var t=s[0],a=0,n=1;n<s.length;n++)a+=s[n]/Math.pow(1+t,n);return a},l.ODDFPRICE=function(){throw new Error("ODDFPRICE is not implemented")},l.ODDFYIELD=function(){throw new Error("ODDFYIELD is not implemented")},l.ODDLPRICE=function(){throw new Error("ODDLPRICE is not implemented")},l.ODDLYIELD=function(){throw new Error("ODDLYIELD is not implemented")},l.PDURATION=function(s,t,a){return s=u.parseNumber(s),t=u.parseNumber(t),a=u.parseNumber(a),u.anyIsError(s,t,a)?c.value:s<=0?c.num:(Math.log(a)-Math.log(t))/Math.log(1+s)},l.PMT=function(s,t,a,n,r){if(n=n||0,r=r||0,s=u.parseNumber(s),t=u.parseNumber(t),a=u.parseNumber(a),n=u.parseNumber(n),r=u.parseNumber(r),u.anyIsError(s,t,a,n,r))return c.value;var e;if(s===0)e=(a+n)/t;else{var i=Math.pow(1+s,t);r===1?e=(n*s/(i-1)+a*s/(1-1/i))/(1+s):e=n*s/(i-1)+a*s/(1-1/i)}return-e},l.PPMT=function(s,t,a,n,r,e){return r=r||0,e=e||0,s=u.parseNumber(s),a=u.parseNumber(a),n=u.parseNumber(n),r=u.parseNumber(r),e=u.parseNumber(e),u.anyIsError(s,a,n,r,e)?c.value:l.PMT(s,a,n,r,e)-l.IPMT(s,t,a,n,r,e)},l.PRICE=function(){throw new Error("PRICE is not implemented")},l.PRICEDISC=function(){throw new Error("PRICEDISC is not implemented")},l.PRICEMAT=function(){throw new Error("PRICEMAT is not implemented")},l.PV=function(s,t,a,n,r){return n=n||0,r=r||0,s=u.parseNumber(s),t=u.parseNumber(t),a=u.parseNumber(a),n=u.parseNumber(n),r=u.parseNumber(r),u.anyIsError(s,t,a,n,r)?c.value:s===0?-a*t-n:((1-Math.pow(1+s,t))/s*a*(1+s*r)-n)/Math.pow(1+s,t)},l.RATE=function(s,t,a,n,r,e){if(e=e===void 0?.01:e,n=n===void 0?0:n,r=r===void 0?0:r,s=u.parseNumber(s),t=u.parseNumber(t),a=u.parseNumber(a),n=u.parseNumber(n),r=u.parseNumber(r),e=u.parseNumber(e),u.anyIsError(s,t,a,n,r,e))return c.value;var i=1e-10,o=50,v,E,h,m,A=0,N=0,T=0,R=e;for(Math.abs(R)<i?v=a*(1+s*R)+t*(1+R*r)*s+n:(N=Math.exp(s*Math.log(1+R)),v=a*N+t*(1/R+r)*(N-1)+n),E=a+t*s+n,h=a*N+t*(1/R+r)*(N-1)+n,T=m=0,A=R;Math.abs(E-h)>i&&T<o;)R=(h*m-E*A)/(h-E),m=A,A=R,Math.abs(R)<i?v=a*(1+s*R)+t*(1+R*r)*s+n:(N=Math.exp(s*Math.log(1+R)),v=a*N+t*(1/R+r)*(N-1)+n),E=h,h=v,++T;return R},l.RECEIVED=function(){throw new Error("RECEIVED is not implemented")},l.RRI=function(s,t,a){return s=u.parseNumber(s),t=u.parseNumber(t),a=u.parseNumber(a),u.anyIsError(s,t,a)?c.value:s===0||t===0?c.num:Math.pow(a/t,1/s)-1},l.SLN=function(s,t,a){return s=u.parseNumber(s),t=u.parseNumber(t),a=u.parseNumber(a),u.anyIsError(s,t,a)?c.value:a===0?c.num:(s-t)/a},l.SYD=function(s,t,a,n){return s=u.parseNumber(s),t=u.parseNumber(t),a=u.parseNumber(a),n=u.parseNumber(n),u.anyIsError(s,t,a,n)?c.value:a===0||n<1||n>a?c.num:(n=parseInt(n,10),(s-t)*(a-n+1)*2/(a*(a+1)))},l.TBILLEQ=function(s,t,a){return s=u.parseDate(s),t=u.parseDate(t),a=u.parseNumber(a),u.anyIsError(s,t,a)?c.value:a<=0||s>t||t-s>365*24*60*60*1e3?c.num:365*a/(360-a*g.DAYS360(s,t,!1))},l.TBILLPRICE=function(s,t,a){return s=u.parseDate(s),t=u.parseDate(t),a=u.parseNumber(a),u.anyIsError(s,t,a)?c.value:a<=0||s>t||t-s>365*24*60*60*1e3?c.num:100*(1-a*g.DAYS360(s,t,!1)/360)},l.TBILLYIELD=function(s,t,a){return s=u.parseDate(s),t=u.parseDate(t),a=u.parseNumber(a),u.anyIsError(s,t,a)?c.value:a<=0||s>t||t-s>365*24*60*60*1e3?c.num:(100-a)*360/(a*g.DAYS360(s,t,!1))},l.VDB=function(){throw new Error("VDB is not implemented")},l.XNPV=function(s,t,a){if(s=u.parseNumber(s),t=u.parseNumberArray(u.flatten(t)),a=u.parseDateArray(u.flatten(a)),u.anyIsError(s,t,a))return c.value;for(var n=0,r=0;r<t.length;r++)n+=t[r]/Math.pow(1+s,g.DAYS(a[r],a[0])/365);return n},l.YIELD=function(){throw new Error("YIELD is not implemented")},l.YIELDDISC=function(){throw new Error("YIELDDISC is not implemented")},l.YIELDMAT=function(){throw new Error("YIELDMAT is not implemented")}})(Xn);var $r={},Er=B,Ee=sr;$r.MATCH=function(l,c,g){if(!l&&!c||(arguments.length===2&&(g=1),!(c instanceof Array))||g!==-1&&g!==0&&g!==1)return Er.na;for(var u,f,I=0;I<c.length;I++)if(g===1){if(c[I]===l)return I+1;c[I]<l&&(f?c[I]>f&&(u=I+1,f=c[I]):(u=I+1,f=c[I]))}else if(g===0){if(typeof l=="string"){if(l=l.replace(/\?/g,"."),c[I].toLowerCase().match(l.toLowerCase()))return I+1}else if(c[I]===l)return I+1}else if(g===-1){if(c[I]===l)return I+1;c[I]>l&&(f?c[I]<f&&(u=I+1,f=c[I]):(u=I+1,f=c[I]))}return u||Er.na};$r.VLOOKUP=function(l,c,g,u){if(!l||!c||!g)return Er.na;u=u||!1;for(var f=0;f<c.length;f++){var I=c[f];if(!u&&I[0]===l||I[0]===l||u&&typeof I[0]=="string"&&I[0].toLowerCase().indexOf(l.toLowerCase())!==-1)return g<I.length+1?I[g-1]:Er.ref}return Er.na};$r.HLOOKUP=function(l,c,g,u){if(!l||!c||!g)return Er.na;u=u||!1;for(var f=Ee.transpose(c),I=0;I<f.length;I++){var s=f[I];if(!u&&s[0]===l||s[0]===l||u&&typeof s[0]=="string"&&s[0].toLowerCase().indexOf(l.toLowerCase())!==-1)return g<s.length+1?s[g-1]:Er.ref}return Er.na};(function(l){var c=[L,Hn,An,lr,Wr(),Xr,zr,Xn,Qr,$r,Kr(),Ir];for(var g in c){var u=c[g];for(var f in u)l[f]=l[f]||u[f]}})(Fn);const Ur=Vn(Fn);var ge=["ABS","ACCRINT","ACOS","ACOSH","ACOT","ACOTH","ADD","AGGREGATE","AND","ARABIC","ARGS2ARRAY","ASIN","ASINH","ATAN","ATAN2","ATANH","AVEDEV","AVERAGE","AVERAGEA","AVERAGEIF","AVERAGEIFS","BASE","BESSELI","BESSELJ","BESSELK","BESSELY","BETA.DIST","BETA.INV","BETADIST","BETAINV","BIN2DEC","BIN2HEX","BIN2OCT","BINOM.DIST","BINOM.DIST.RANGE","BINOM.INV","BINOMDIST","BITAND","BITLSHIFT","BITOR","BITRSHIFT","BITXOR","CEILING","CEILINGMATH","CEILINGPRECISE","CHAR","CHISQ.DIST","CHISQ.DIST.RT","CHISQ.INV","CHISQ.INV.RT","CHOOSE","CHOOSE","CLEAN","CODE","COLUMN","COLUMNS","COMBIN","COMBINA","COMPLEX","CONCATENATE","CONFIDENCE","CONFIDENCE.NORM","CONFIDENCE.T","CONVERT","CORREL","COS","COSH","COT","COTH","COUNT","COUNTA","COUNTBLANK","COUNTIF","COUNTIFS","COUNTIN","COUNTUNIQUE","COVARIANCE.P","COVARIANCE.S","CSC","CSCH","CUMIPMT","CUMPRINC","DATE","DATEVALUE","DAY","DAYS","DAYS360","DB","DDB","DEC2BIN","DEC2HEX","DEC2OCT","DECIMAL","DEGREES","DELTA","DEVSQ","DIVIDE","DOLLARDE","DOLLARFR","E","EDATE","EFFECT","EOMONTH","EQ","ERF","ERFC","EVEN","EXACT","EXP","EXPON.DIST","EXPONDIST","F.DIST","F.DIST.RT","F.INV","F.INV.RT","FACT","FACTDOUBLE","FALSE","FDIST","FDISTRT","FIND","FINV","FINVRT","FISHER","FISHERINV","FLATTEN","FLOOR","FORECAST","FREQUENCY","FV","FVSCHEDULE","GAMMA","GAMMA.DIST","GAMMA.INV","GAMMADIST","GAMMAINV","GAMMALN","GAMMALN.PRECISE","GAUSS","GCD","GEOMEAN","GESTEP","GROWTH","GTE","HARMEAN","HEX2BIN","HEX2DEC","HEX2OCT","HOUR","HTML2TEXT","HYPGEOM.DIST","HYPGEOMDIST","IF","IMABS","IMAGINARY","IMARGUMENT","IMCONJUGATE","IMCOS","IMCOSH","IMCOT","IMCSC","IMCSCH","IMDIV","IMEXP","IMLN","IMLOG10","IMLOG2","IMPOWER","IMPRODUCT","IMREAL","IMSEC","IMSECH","IMSIN","IMSINH","IMSQRT","IMSUB","IMSUM","IMTAN","INT","INTERCEPT","INTERVAL","IPMT","IRR","ISBINARY","ISBLANK","ISEVEN","ISLOGICAL","ISNONTEXT","ISNUMBER","ISODD","ISODD","ISOWEEKNUM","ISPMT","ISTEXT","JOIN","KURT","LARGE","LCM","LEFT","LEN","LINEST","LN","LOG","LOG10","LOGEST","LOGNORM.DIST","LOGNORM.INV","LOGNORMDIST","LOGNORMINV","LOWER","LT","LTE","MATCH","MAX","MAXA","MEDIAN","MID","MIN","MINA","MINUS","MINUTE","MIRR","MOD","MODE.MULT","MODE.SNGL","MODEMULT","MODESNGL","MONTH","MROUND","MULTINOMIAL","MULTIPLY","NE","NEGBINOM.DIST","NEGBINOMDIST","NETWORKDAYS","NOMINAL","NORM.DIST","NORM.INV","NORM.S.DIST","NORM.S.INV","NORMDIST","NORMINV","NORMSDIST","NORMSINV","NOT","NOW","NPER","NPV","NUMBERS","OCT2BIN","OCT2DEC","OCT2HEX","ODD","OR","PDURATION","PEARSON","PERCENTILEEXC","PERCENTILEINC","PERCENTRANKEXC","PERCENTRANKINC","PERMUT","PERMUTATIONA","PHI","PI","PMT","POISSON.DIST","POISSONDIST","POW","POWER","PPMT","PROB","PRODUCT","PROPER","PV","QUARTILE.EXC","QUARTILE.INC","QUARTILEEXC","QUARTILEINC","QUOTIENT","RADIANS","RAND","RANDBETWEEN","RANK.AVG","RANK.EQ","RANKAVG","RANKEQ","RATE","REFERENCE","REGEXEXTRACT","REGEXMATCH","REGEXREPLACE","REPLACE","REPT","RIGHT","ROMAN","ROUND","ROUNDDOWN","ROUNDUP","ROW","ROWS","RRI","RSQ","SEARCH","SEC","SECH","SECOND","SERIESSUM","SIGN","SIN","SINH","SKEW","SKEW.P","SKEWP","SLN","SLOPE","SMALL","SPLIT","SPLIT","SQRT","SQRTPI","STANDARDIZE","STDEV.P","STDEV.S","STDEVA","STDEVP","STDEVPA","STDEVS","STEYX","SUBSTITUTE","SUBTOTAL","SUM","SUMIF","SUMIFS","SUMPRODUCT","SUMSQ","SUMX2MY2","SUMX2PY2","SUMXMY2","SWITCH","SYD","T","T.DIST","T.DIST.2T","T.DIST.RT","T.INV","T.INV.2T","TAN","TANH","TBILLEQ","TBILLPRICE","TBILLYIELD","TDIST","TDIST2T","TDISTRT","TIME","TIMEVALUE","TINV","TINV2T","TODAY","TRANSPOSE","TREND","TRIM","TRIMMEAN","TRUE","TRUNC","UNICHAR","UNICODE","UNIQUE","UPPER","VAR.P","VAR.S","VARA","VARP","VARPA","VARS","WEEKDAY","WEEKNUM","WEIBULL.DIST","WEIBULLDIST","WORKDAY","XIRR","XNPV","XOR","YEAR","YEARFRAC"],he=ge;function Sr(l){return function(){l=l.toUpperCase();var g=l.split("."),u=!1,f;if(g.length===1)Ur[g[0]]&&(u=!0,f=Ur[g[0]].apply(Ur,arguments));else{for(var I=g.length,s=0,t=Ur;s<I;)if(t=t[g[s]],s++,!t){t=null;break}t&&(u=!0,f=t.apply(void 0,arguments))}if(!u)throw Error(Hr);return f}}Sr.isFactory=!0;Sr.SYMBOL=he;var Ne=">";function an(l,c){return l>c}an.SYMBOL=Ne;var me=">=";function fn(l,c){return l>=c}fn.SYMBOL=me;var Ie="<";function on(l,c){return l<c}on.SYMBOL=Ie;var Ae="<=";function ln(l,c){return l<=c}ln.SYMBOL=Ae;var Te="-";function sn(l){for(var c=arguments.length,g=new Array(c>1?c-1:0),u=1;u<c;u++)g[u-1]=arguments[u];var f=g.reduce(function(I,s){return I-ir(s)},ir(l));if(isNaN(f))throw Error(Mr);return f}sn.SYMBOL=Te;var Re="*";function cn(l){for(var c=arguments.length,g=new Array(c>1?c-1:0),u=1;u<c;u++)g[u-1]=arguments[u];var f=g.reduce(function(I,s){return I*ir(s)},ir(l));if(isNaN(f))throw Error(Mr);return f}cn.SYMBOL=Re;var Oe="<>";function vn(l,c){return l!==c}vn.SYMBOL=Oe;var ye="^";function En(l,c){var g=Math.pow(ir(l),ir(c));if(isNaN(g))throw Error(Mr);return g}En.SYMBOL=ye;function pe(l){return De(l)||Le(l)||Me(l)||Ce()}function Ce(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Me(l,c){if(l){if(typeof l=="string")return gn(l,c);var g=Object.prototype.toString.call(l).slice(8,-1);if(g==="Object"&&l.constructor&&(g=l.constructor.name),g==="Map"||g==="Set")return Array.from(l);if(g==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(g))return gn(l,c)}}function Le(l){if(typeof Symbol<"u"&&Symbol.iterator in Object(l))return Array.from(l)}function De(l){if(Array.isArray(l))return gn(l)}function gn(l,c){(c==null||c>l.length)&&(c=l.length);for(var g=0,u=new Array(c);g<c;g++)u[g]=l[g];return u}var Pr=Object.create(null);function Cn(l){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];if(l=l.toUpperCase(),!Pr[l])throw Error(Hr);return Pr[l].apply(Pr,pe(c))}function ur(l,c){Array.isArray(l)||(l=[l.toUpperCase()]),l.forEach(function(g){c.isFactory?Pr[g]=c(g):Pr[g]=c})}ur(nn.SYMBOL,nn);ur(en.SYMBOL,en);ur(tn.SYMBOL,tn);ur(un.SYMBOL,un);ur(En.SYMBOL,En);ur(Sr.SYMBOL,Sr);ur(an.SYMBOL,an);ur(fn.SYMBOL,fn);ur(on.SYMBOL,on);ur(ln.SYMBOL,ln);ur(cn.SYMBOL,cn);ur(vn.SYMBOL,vn);ur(sn.SYMBOL,sn);var w=function(c,g,u,f){for(u=u||{},f=c.length;f--;u[c[f]]=g);return u},Y=[1,5],S=[1,8],q=[1,6],H=[1,7],X=[1,9],k=[1,14],K=[1,15],Q=[1,16],W=[1,12],z=[1,13],b=[1,17],$=[1,19],Dr=[1,20],ar=[1,21],Tr=[1,22],Rr=[1,23],yr=[1,24],fr=[1,25],j=[1,26],x=[1,27],Z=[1,28],U=[5,9,10,11,13,14,15,16,17,18,19,20,29,30],Mn=[5,9,10,11,13,14,15,16,17,18,19,20,29,30,32],jr=[5,9,10,11,13,14,15,16,17,18,19,20,29,30,34],Fr=[5,10,11,13,14,15,16,17,29,30],wr=[5,10,13,14,15,16,29,30],Ln=[5,10,11,13,14,15,16,17,18,19,29,30],Gr=[13,29,30],Rn={trace:function(){},yy:{},symbols_:{error:2,expressions:3,expression:4,EOF:5,variableSequence:6,number:7,STRING:8,"&":9,"=":10,"+":11,"(":12,")":13,"<":14,">":15,NOT:16,"-":17,"*":18,"/":19,"^":20,FUNCTION:21,expseq:22,cell:23,ABSOLUTE_CELL:24,RELATIVE_CELL:25,MIXED_CELL:26,":":27,ARRAY:28,";":29,",":30,VARIABLE:31,DECIMAL:32,NUMBER:33,"%":34,ERROR:35,$accept:0,$end:1},terminals_:{5:"EOF",8:"STRING",9:"&",10:"=",11:"+",12:"(",13:")",14:"<",15:">",16:"NOT",17:"-",18:"*",19:"/",20:"^",21:"FUNCTION",24:"ABSOLUTE_CELL",25:"RELATIVE_CELL",26:"MIXED_CELL",27:":",28:"ARRAY",29:";",30:",",31:"VARIABLE",32:"DECIMAL",33:"NUMBER",34:"%",35:"ERROR"},productions_:[0,[3,2],[4,1],[4,1],[4,1],[4,3],[4,3],[4,3],[4,3],[4,4],[4,4],[4,4],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,2],[4,2],[4,3],[4,4],[4,1],[4,1],[4,2],[23,1],[23,1],[23,1],[23,3],[23,3],[23,3],[23,3],[23,3],[23,3],[23,3],[23,3],[23,3],[22,1],[22,1],[22,3],[22,3],[6,1],[6,3],[7,1],[7,3],[7,2],[2,1]],performAction:function(c,g,u,f,I,s,t){var a=s.length-1;switch(I){case 1:return s[a-1];case 2:this.$=f.callVariable(s[a][0]);break;case 3:this.$=f.toNumber(s[a]);break;case 4:this.$=f.trimEdges(s[a]);break;case 5:this.$=f.evaluateByOperator("&",[s[a-2],s[a]]);break;case 6:this.$=f.evaluateByOperator("=",[s[a-2],s[a]]);break;case 7:this.$=f.evaluateByOperator("+",[s[a-2],s[a]]);break;case 8:this.$=s[a-1];break;case 9:this.$=f.evaluateByOperator("<=",[s[a-3],s[a]]);break;case 10:this.$=f.evaluateByOperator(">=",[s[a-3],s[a]]);break;case 11:this.$=f.evaluateByOperator("<>",[s[a-3],s[a]]);break;case 12:this.$=f.evaluateByOperator("NOT",[s[a-2],s[a]]);break;case 13:this.$=f.evaluateByOperator(">",[s[a-2],s[a]]);break;case 14:this.$=f.evaluateByOperator("<",[s[a-2],s[a]]);break;case 15:this.$=f.evaluateByOperator("-",[s[a-2],s[a]]);break;case 16:this.$=f.evaluateByOperator("*",[s[a-2],s[a]]);break;case 17:this.$=f.evaluateByOperator("/",[s[a-2],s[a]]);break;case 18:this.$=f.evaluateByOperator("^",[s[a-2],s[a]]);break;case 19:var n=f.invertNumber(s[a]);this.$=n,isNaN(this.$)&&(this.$=0);break;case 20:var n=f.toNumber(s[a]);this.$=n,isNaN(this.$)&&(this.$=0);break;case 21:this.$=f.callFunction(s[a-2]);break;case 22:this.$=f.callFunction(s[a-3],s[a-1]);break;case 26:case 27:case 28:this.$=f.cellValue(s[a]);break;case 29:case 30:case 31:case 32:case 33:case 34:case 35:case 36:case 37:this.$=f.rangeValue(s[a-2],s[a]);break;case 38:case 42:this.$=[s[a]];break;case 39:this.$=f.trimEdges(c).split(",");break;case 40:case 41:s[a-2].push(s[a]),this.$=s[a-2];break;case 43:this.$=Array.isArray(s[a-2])?s[a-2]:[s[a-2]],this.$.push(s[a]);break;case 44:this.$=s[a];break;case 45:this.$=(s[a-2]+"."+s[a])*1;break;case 46:this.$=s[a-1]*.01;break;case 47:this.$=f.throwError(s[a]);break}},table:[{2:11,3:1,4:2,6:3,7:4,8:Y,11:S,12:q,17:H,21:X,23:10,24:k,25:K,26:Q,31:W,33:z,35:b},{1:[3]},{5:[1,18],9:$,10:Dr,11:ar,14:Tr,15:Rr,16:yr,17:fr,18:j,19:x,20:Z},w(U,[2,2],{32:[1,29]}),w(U,[2,3],{34:[1,30]}),w(U,[2,4]),{2:11,4:31,6:3,7:4,8:Y,11:S,12:q,17:H,21:X,23:10,24:k,25:K,26:Q,31:W,33:z,35:b},{2:11,4:32,6:3,7:4,8:Y,11:S,12:q,17:H,21:X,23:10,24:k,25:K,26:Q,31:W,33:z,35:b},{2:11,4:33,6:3,7:4,8:Y,11:S,12:q,17:H,21:X,23:10,24:k,25:K,26:Q,31:W,33:z,35:b},{12:[1,34]},w(U,[2,23]),w(U,[2,24],{2:35,35:b}),w(Mn,[2,42]),w(jr,[2,44],{32:[1,36]}),w(U,[2,26],{27:[1,37]}),w(U,[2,27],{27:[1,38]}),w(U,[2,28],{27:[1,39]}),w([5,9,10,11,13,14,15,16,17,18,19,20,29,30,35],[2,47]),{1:[2,1]},{2:11,4:40,6:3,7:4,8:Y,11:S,12:q,17:H,21:X,23:10,24:k,25:K,26:Q,31:W,33:z,35:b},{2:11,4:41,6:3,7:4,8:Y,11:S,12:q,17:H,21:X,23:10,24:k,25:K,26:Q,31:W,33:z,35:b},{2:11,4:42,6:3,7:4,8:Y,11:S,12:q,17:H,21:X,23:10,24:k,25:K,26:Q,31:W,33:z,35:b},{2:11,4:45,6:3,7:4,8:Y,10:[1,43],11:S,12:q,15:[1,44],17:H,21:X,23:10,24:k,25:K,26:Q,31:W,33:z,35:b},{2:11,4:47,6:3,7:4,8:Y,10:[1,46],11:S,12:q,17:H,21:X,23:10,24:k,25:K,26:Q,31:W,33:z,35:b},{2:11,4:48,6:3,7:4,8:Y,11:S,12:q,17:H,21:X,23:10,24:k,25:K,26:Q,31:W,33:z,35:b},{2:11,4:49,6:3,7:4,8:Y,11:S,12:q,17:H,21:X,23:10,24:k,25:K,26:Q,31:W,33:z,35:b},{2:11,4:50,6:3,7:4,8:Y,11:S,12:q,17:H,21:X,23:10,24:k,25:K,26:Q,31:W,33:z,35:b},{2:11,4:51,6:3,7:4,8:Y,11:S,12:q,17:H,21:X,23:10,24:k,25:K,26:Q,31:W,33:z,35:b},{2:11,4:52,6:3,7:4,8:Y,11:S,12:q,17:H,21:X,23:10,24:k,25:K,26:Q,31:W,33:z,35:b},{31:[1,53]},w(jr,[2,46]),{9:$,10:Dr,11:ar,13:[1,54],14:Tr,15:Rr,16:yr,17:fr,18:j,19:x,20:Z},w(Fr,[2,19],{9:$,18:j,19:x,20:Z}),w(Fr,[2,20],{9:$,18:j,19:x,20:Z}),{2:11,4:57,6:3,7:4,8:Y,11:S,12:q,13:[1,55],17:H,21:X,22:56,23:10,24:k,25:K,26:Q,28:[1,58],31:W,33:z,35:b},w(U,[2,25]),{33:[1,59]},{24:[1,60],25:[1,61],26:[1,62]},{24:[1,63],25:[1,64],26:[1,65]},{24:[1,66],25:[1,67],26:[1,68]},w(U,[2,5]),w([5,10,13,29,30],[2,6],{9:$,11:ar,14:Tr,15:Rr,16:yr,17:fr,18:j,19:x,20:Z}),w(Fr,[2,7],{9:$,18:j,19:x,20:Z}),{2:11,4:69,6:3,7:4,8:Y,11:S,12:q,17:H,21:X,23:10,24:k,25:K,26:Q,31:W,33:z,35:b},{2:11,4:70,6:3,7:4,8:Y,11:S,12:q,17:H,21:X,23:10,24:k,25:K,26:Q,31:W,33:z,35:b},w(wr,[2,14],{9:$,11:ar,17:fr,18:j,19:x,20:Z}),{2:11,4:71,6:3,7:4,8:Y,11:S,12:q,17:H,21:X,23:10,24:k,25:K,26:Q,31:W,33:z,35:b},w(wr,[2,13],{9:$,11:ar,17:fr,18:j,19:x,20:Z}),w([5,10,13,16,29,30],[2,12],{9:$,11:ar,14:Tr,15:Rr,17:fr,18:j,19:x,20:Z}),w(Fr,[2,15],{9:$,18:j,19:x,20:Z}),w(Ln,[2,16],{9:$,20:Z}),w(Ln,[2,17],{9:$,20:Z}),w([5,10,11,13,14,15,16,17,18,19,20,29,30],[2,18],{9:$}),w(Mn,[2,43]),w(U,[2,8]),w(U,[2,21]),{13:[1,72],29:[1,73],30:[1,74]},w(Gr,[2,38],{9:$,10:Dr,11:ar,14:Tr,15:Rr,16:yr,17:fr,18:j,19:x,20:Z}),w(Gr,[2,39]),w(jr,[2,45]),w(U,[2,29]),w(U,[2,30]),w(U,[2,31]),w(U,[2,32]),w(U,[2,33]),w(U,[2,34]),w(U,[2,35]),w(U,[2,36]),w(U,[2,37]),w(wr,[2,9],{9:$,11:ar,17:fr,18:j,19:x,20:Z}),w(wr,[2,11],{9:$,11:ar,17:fr,18:j,19:x,20:Z}),w(wr,[2,10],{9:$,11:ar,17:fr,18:j,19:x,20:Z}),w(U,[2,22]),{2:11,4:75,6:3,7:4,8:Y,11:S,12:q,17:H,21:X,23:10,24:k,25:K,26:Q,31:W,33:z,35:b},{2:11,4:76,6:3,7:4,8:Y,11:S,12:q,17:H,21:X,23:10,24:k,25:K,26:Q,31:W,33:z,35:b},w(Gr,[2,40],{9:$,10:Dr,11:ar,14:Tr,15:Rr,16:yr,17:fr,18:j,19:x,20:Z}),w(Gr,[2,41],{9:$,10:Dr,11:ar,14:Tr,15:Rr,16:yr,17:fr,18:j,19:x,20:Z})],defaultActions:{18:[2,1]},parseError:function(c,g){if(g.recoverable)this.trace(c);else{var u=new Error(c);throw u.hash=g,u}},parse:function(c){var g=this,u=[0],f=[null],I=[],s=this.table,t="",a=0,n=0,r=0,e=2,i=1,o=I.slice.call(arguments,1),v=Object.create(this.lexer),E={yy:{}};for(var h in this.yy)Object.prototype.hasOwnProperty.call(this.yy,h)&&(E.yy[h]=this.yy[h]);v.setInput(c,E.yy),E.yy.lexer=v,E.yy.parser=this,typeof v.yylloc>"u"&&(v.yylloc={});var m=v.yylloc;I.push(m);var A=v.options&&v.options.ranges;typeof E.yy.parseError=="function"?this.parseError=E.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;function N(er){u.length=u.length-2*er,f.length=f.length-er,I.length=I.length-er}for(var T=function(){var G;return G=v.lex()||i,typeof G!="number"&&(G=g.symbols_[G]||G),G},R,O,y,p,C,M={},d,P,V,J;;){if(y=u[u.length-1],this.defaultActions[y]?p=this.defaultActions[y]:((R===null||typeof R>"u")&&(R=T()),p=s[y]&&s[y][R]),typeof p>"u"||!p.length||!p[0]){var cr=function(G){for(var rr=u.length-1,tr=0;;){if(e.toString()in s[G])return tr;if(G===0||rr<2)return!1;rr-=2,G=u[rr],++tr}},_,F="";if(r)O!==i&&(_=cr(y));else{_=cr(y),J=[];for(d in s[y])this.terminals_[d]&&d>e&&J.push("'"+this.terminals_[d]+"'");v.showPosition?F="Parse error on line "+(a+1)+`:
`+v.showPosition()+`
Expecting `+J.join(", ")+", got '"+(this.terminals_[R]||R)+"'":F="Parse error on line "+(a+1)+": Unexpected "+(R==i?"end of input":"'"+(this.terminals_[R]||R)+"'"),this.parseError(F,{text:v.match,token:this.terminals_[R]||R,line:v.yylineno,loc:m,expected:J,recoverable:_!==!1})}if(r==3){if(R===i||O===i)throw new Error(F||"Parsing halted while starting to recover from another error.");n=v.yyleng,t=v.yytext,a=v.yylineno,m=v.yylloc,R=T()}if(_===!1)throw new Error(F||"Parsing halted. No suitable error recovery rule available.");N(_),O=R==e?null:R,R=e,y=u[u.length-1],p=s[y]&&s[y][e],r=3}if(p[0]instanceof Array&&p.length>1)throw new Error("Parse Error: multiple actions possible at state: "+y+", token: "+R);switch(p[0]){case 1:u.push(R),f.push(v.yytext),I.push(v.yylloc),u.push(p[1]),R=null,O?(R=O,O=null):(n=v.yyleng,t=v.yytext,a=v.yylineno,m=v.yylloc,r>0&&r--);break;case 2:if(P=this.productions_[p[1]][1],M.$=f[f.length-P],M._$={first_line:I[I.length-(P||1)].first_line,last_line:I[I.length-1].last_line,first_column:I[I.length-(P||1)].first_column,last_column:I[I.length-1].last_column},A&&(M._$.range=[I[I.length-(P||1)].range[0],I[I.length-1].range[1]]),C=this.performAction.apply(M,[t,n,a,E.yy,p[1],f,I].concat(o)),typeof C<"u")return C;P&&(u=u.slice(0,-1*P*2),f=f.slice(0,-1*P),I=I.slice(0,-1*P)),u.push(this.productions_[p[1]][0]),f.push(M.$),I.push(M._$),V=s[u[u.length-2]][u[u.length-1]],u.push(V);break;case 3:return!0}}return!0}},we=function(){var l={EOF:1,parseError:function(g,u){if(this.yy.parser)this.yy.parser.parseError(g,u);else throw new Error(g)},setInput:function(g,u){return this.yy=u||this.yy||{},this._input=g,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var g=this._input[0];this.yytext+=g,this.yyleng++,this.offset++,this.match+=g,this.matched+=g;var u=g.match(/(?:\r\n?|\n).*/g);return u?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),g},unput:function(g){var u=g.length,f=g.split(/(?:\r\n?|\n)/g);this._input=g+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-u),this.offset-=u;var I=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),f.length-1&&(this.yylineno-=f.length-1);var s=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:f?(f.length===I.length?this.yylloc.first_column:0)+I[I.length-f.length].length-f[0].length:this.yylloc.first_column-u},this.options.ranges&&(this.yylloc.range=[s[0],s[0]+this.yyleng-u]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){if(this.options.backtrack_lexer)this._backtrack=!0;else return this.parseError("Lexical error on line "+(this.yylineno+1)+`. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).
`+this.showPosition(),{text:"",token:null,line:this.yylineno});return this},less:function(g){this.unput(this.match.slice(g))},pastInput:function(){var g=this.matched.substr(0,this.matched.length-this.match.length);return(g.length>20?"...":"")+g.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var g=this.match;return g.length<20&&(g+=this._input.substr(0,20-g.length)),(g.substr(0,20)+(g.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var g=this.pastInput(),u=new Array(g.length+1).join("-");return g+this.upcomingInput()+`
`+u+"^"},test_match:function(g,u){var f,I,s;if(this.options.backtrack_lexer&&(s={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(s.yylloc.range=this.yylloc.range.slice(0))),I=g[0].match(/(?:\r\n?|\n).*/g),I&&(this.yylineno+=I.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:I?I[I.length-1].length-I[I.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+g[0].length},this.yytext+=g[0],this.match+=g[0],this.matches=g,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(g[0].length),this.matched+=g[0],f=this.performAction.call(this,this.yy,this,u,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),f)return f;if(this._backtrack){for(var t in s)this[t]=s[t];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var g,u,f,I;this._more||(this.yytext="",this.match="");for(var s=this._currentRules(),t=0;t<s.length;t++)if(f=this._input.match(this.rules[s[t]]),f&&(!u||f[0].length>u[0].length)){if(u=f,I=t,this.options.backtrack_lexer){if(g=this.test_match(f,s[t]),g!==!1)return g;if(this._backtrack){u=!1;continue}else return!1}else if(!this.options.flex)break}return u?(g=this.test_match(u,s[I]),g!==!1?g:!1):this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var g=this.next();return g||this.lex()},begin:function(g){this.conditionStack.push(g)},popState:function(){var g=this.conditionStack.length-1;return g>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(g){return g=this.conditionStack.length-1-Math.abs(g||0),g>=0?this.conditionStack[g]:"INITIAL"},pushState:function(g){this.begin(g)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(g,u,f,I){switch(f){case 0:break;case 1:return 8;case 2:return 8;case 3:return 21;case 4:return 35;case 5:return 24;case 6:return 26;case 7:return 26;case 8:return 25;case 9:return 21;case 10:return 31;case 11:return 31;case 12:return 33;case 13:return 28;case 14:return 9;case 15:return" ";case 16:return 32;case 17:return 27;case 18:return 29;case 19:return 30;case 20:return 18;case 21:return 19;case 22:return 17;case 23:return 11;case 24:return 20;case 25:return 12;case 26:return 13;case 27:return 15;case 28:return 14;case 29:return 16;case 30:return'"';case 31:return"'";case 32:return"!";case 33:return 10;case 34:return 34;case 35:return"#";case 36:return 5}},rules:[/^(?:\s+)/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:[A-Za-z]{1,}[A-Za-z_0-9\.]+(?=[(]))/,/^(?:#[A-Z0-9\/]+(!|\?)?)/,/^(?:\$[A-Za-z]+\$[0-9]+)/,/^(?:\$[A-Za-z]+[0-9]+)/,/^(?:[A-Za-z]+\$[0-9]+)/,/^(?:[A-Za-z]+[0-9]+)/,/^(?:[A-Za-z\.]+(?=[(]))/,/^(?:[A-Za-z]{1,}[A-Za-z_0-9]+)/,/^(?:[A-Za-z_]+)/,/^(?:[0-9]+)/,/^(?:\[(.*)?\])/,/^(?:&)/,/^(?: )/,/^(?:[.])/,/^(?::)/,/^(?:;)/,/^(?:,)/,/^(?:\*)/,/^(?:\/)/,/^(?:-)/,/^(?:\+)/,/^(?:\^)/,/^(?:\()/,/^(?:\))/,/^(?:>)/,/^(?:<)/,/^(?:NOT\b)/,/^(?:")/,/^(?:')/,/^(?:!)/,/^(?:=)/,/^(?:%)/,/^(?:[#])/,/^(?:$)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36],inclusive:!0}}};return l}();Rn.lexer=we;function On(){this.yy={}}On.prototype=Rn;Rn.Parser=On;function de(l){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return l=l.substring(c,l.length-c),l}function Pe(l,c){return Ge(l)||Fe(l,c)||Ue(l,c)||Ve()}function Ve(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ue(l,c){if(l){if(typeof l=="string")return Dn(l,c);var g=Object.prototype.toString.call(l).slice(8,-1);if(g==="Object"&&l.constructor&&(g=l.constructor.name),g==="Map"||g==="Set")return Array.from(l);if(g==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(g))return Dn(l,c)}}function Dn(l,c){(c==null||c>l.length)&&(c=l.length);for(var g=0,u=new Array(c);g<c;g++)u[g]=l[g];return u}function Fe(l,c){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(l)))){var g=[],u=!0,f=!1,I=void 0;try{for(var s=l[Symbol.iterator](),t;!(u=(t=s.next()).done)&&(g.push(t.value),!(c&&g.length===c));u=!0);}catch(a){f=!0,I=a}finally{try{!u&&s.return!=null&&s.return()}finally{if(f)throw I}}return g}}function Ge(l){if(Array.isArray(l))return l}function be(l){var c=parseInt(l,10);return isNaN(c)?c=-1:c=Math.max(c-1,-1),c}function Be(l){var c="";return l>=0&&(c="".concat(l+1)),c}var kn="ABCDEFGHIJKLMNOPQRSTUVWXYZ",hn=kn.length;function Ye(l){var c=0;if(typeof l=="string"){l=l.toUpperCase();for(var g=0,u=l.length-1;g<l.length;g+=1,u-=1)c+=Math.pow(hn,u)*(kn.indexOf(l[g])+1)}return--c,c}function Se(l){for(var c="";l>=0;)c=String.fromCharCode(l%hn+97)+c,l=Math.floor(l/hn)-1;return c.toUpperCase()}var wn=/^([$])?([A-Za-z]+)([$])?([0-9]+)$/;function xr(l){if(typeof l!="string"||!wn.test(l))return[];var c=l.toUpperCase().match(wn),g=Pe(c,5),u=g[1],f=g[2],I=g[3],s=g[4];return[{index:be(s),label:s,isAbsolute:I==="$"},{index:Ye(f),label:f,isAbsolute:u==="$"}]}function dn(l,c){var g=(l.isAbsolute?"$":"")+Be(l.index),u=(c.isAbsolute?"$":"")+Se(c.index);return u+g}function Yr(l){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Yr=function(g){return typeof g}:Yr=function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g},Yr(l)}function rn(l,c){return ke(l)||Xe(l,c)||He(l,c)||qe()}function qe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function He(l,c){if(l){if(typeof l=="string")return Pn(l,c);var g=Object.prototype.toString.call(l).slice(8,-1);if(g==="Object"&&l.constructor&&(g=l.constructor.name),g==="Map"||g==="Set")return Array.from(l);if(g==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(g))return Pn(l,c)}}function Pn(l,c){(c==null||c>l.length)&&(c=l.length);for(var g=0,u=new Array(c);g<c;g++)u[g]=l[g];return u}function Xe(l,c){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(l)))){var g=[],u=!0,f=!1,I=void 0;try{for(var s=l[Symbol.iterator](),t;!(u=(t=s.next()).done)&&(g.push(t.value),!(c&&g.length===c));u=!0);}catch(a){f=!0,I=a}finally{try{!u&&s.return!=null&&s.return()}finally{if(f)throw I}}return g}}function ke(l){if(Array.isArray(l))return l}function Ke(l,c){if(!(l instanceof c))throw new TypeError("Cannot call a class as a function")}function Qe(l,c){for(var g=0;g<c.length;g++){var u=c[g];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(l,u.key,u)}}function We(l,c,g){return c&&Qe(l.prototype,c),l}function ze(l,c){if(typeof c!="function"&&c!==null)throw new TypeError("Super expression must either be null or a function");l.prototype=Object.create(c&&c.prototype,{constructor:{value:l,writable:!0,configurable:!0}}),c&&Nn(l,c)}function Nn(l,c){return Nn=Object.setPrototypeOf||function(u,f){return u.__proto__=f,u},Nn(l,c)}function $e(l){var c=_e();return function(){var u=qr(l),f;if(c){var I=qr(this).constructor;f=Reflect.construct(u,arguments,I)}else f=u.apply(this,arguments);return Ze(this,f)}}function Ze(l,c){return c&&(Yr(c)==="object"||typeof c=="function")?c:Je(l)}function Je(l){if(l===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return l}function _e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function qr(l){return qr=Object.setPrototypeOf?Object.getPrototypeOf:function(g){return g.__proto__||Object.getPrototypeOf(g)},qr(l)}var je=function(l){ze(g,l);var c=$e(g);function g(){var u;return Ke(this,g),u=c.call(this),u.parser=new On,u.parser.yy={toNumber:ir,trimEdges:de,invertNumber:zn,throwError:function(I){return u._throwError(I)},callVariable:function(I){return u._callVariable(I)},evaluateByOperator:Cn,callFunction:function(I,s){return u._callFunction(I,s)},cellValue:function(I){return u._callCellValue(I)},rangeValue:function(I,s){return u._callRangeValue(I,s)}},u.variables=Object.create(null),u.functions=Object.create(null),u.setVariable("TRUE",!0).setVariable("FALSE",!1).setVariable("NULL",null),u}return We(g,[{key:"parse",value:function(f){var I=null,s=null;try{f===""?I="":I=this.parser.parse(f)}catch(a){var t=Vr(a.message);t?s=t:s=Vr(br)}return I instanceof Error&&(s=Vr(I.message)||Vr(br),I=null),{error:s,result:I}}},{key:"setVariable",value:function(f,I){return this.variables[f]=I,this}},{key:"getVariable",value:function(f){return this.variables[f]}},{key:"_callVariable",value:function(f){var I=this.getVariable(f);if(this.emit("callVariable",f,function(s){s!==void 0&&(I=s)}),I===void 0)throw Error(Hr);return I}},{key:"setFunction",value:function(f,I){return this.functions[f]=I,this}},{key:"getFunction",value:function(f){return this.functions[f]}},{key:"_callFunction",value:function(f){var I=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],s=this.getFunction(f),t;return s&&(t=s(I)),this.emit("callFunction",f,I,function(a){a!==void 0&&(t=a)}),t===void 0?Cn(f,I):t}},{key:"_callCellValue",value:function(f){f=f.toUpperCase();var I=xr(f),s=rn(I,2),t=s[0],a=s[1],n=void 0;return this.emit("callCellValue",{label:f,row:t,column:a},function(r){n=r}),n}},{key:"_callRangeValue",value:function(f,I){f=f.toUpperCase(),I=I.toUpperCase();var s=xr(f),t=rn(s,2),a=t[0],n=t[1],r=xr(I),e=rn(r,2),i=e[0],o=e[1],v={},E={};a.index<=i.index?(v.row=a,E.row=i):(v.row=i,E.row=a),n.index<=o.index?(v.column=n,E.column=o):(v.column=o,E.column=n),v.label=dn(v.row,v.column),E.label=dn(E.row,E.column);var h=[];return this.emit("callRangeValue",v,E,function(){var m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];h=m}),h}},{key:"_throwError",value:function(f){throw jn(f)?Error(f):Error(br)}}]),g}(Wn);export{je as P,Kn as c,Vn as g};
